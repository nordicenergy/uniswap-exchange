{"ast":null,"code":"import _slicedToArray from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _taggedTemplateLiteral from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject9(){var data=_taggedTemplateLiteral([\"\\n  margin: 0 0.25rem 0 0.25rem;\\n\"]);_templateObject9=function _templateObject9(){return data;};return data;}function _templateObject8(){var data=_taggedTemplateLiteral([\"\\n  margin-left: 0.25rem;\\n  margin-right: 0.5rem;\\n  width: 16px;\\n  height: 16px;\\n\"]);_templateObject8=function _templateObject8(){return data;};return data;}function _templateObject7(){var data=_taggedTemplateLiteral([\"\\n  margin-left: 0.25rem;\\n  margin-right: 0.5rem;\\n  width: 16px;\\n  height: 16px;\\n\"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=_taggedTemplateLiteral([\"\\n  height: 1rem;\\n  width: 1rem;\\n  border-radius: 1.125rem;\\n  background-color: \",\";\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\\n  flex: 1 1 auto;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n\\n  margin: 0 0.5rem 0 0.25rem;\\n  font-size: 0.83rem;\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  background-color: \",\";\\n  color: \",\";\\n  border: 1px solid \",\";\\n  font-weight: 400;\\n  :hover {\\n    background-color: \",\";\\n  }\\n  :focus {\\n    border: 1px solid\\n      \",\";\\n  }\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  background-color: \",\";\\n  color: \",\";\\n  border: 1px solid \",\";\\n  font-weight: 500;\\n  :hover,\\n  :focus {\\n    background-color: \",\";\\n  }\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  background-color: \",\";\\n  color: \",\";\\n  border: 1px solid \",\";\\n  font-weight: 500;\\n  :hover,\\n  :focus {\\n    background-color: \",\";\\n  }\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  width: 100%;\\n  font-size: 0.9rem;\\n  align-items: center;\\n  padding: 0.5rem;\\n  border-radius: 2rem;\\n  box-sizing: border-box;\\n  cursor: pointer;\\n  user-select: none;\\n  :focus {\\n    outline: none;\\n  }\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useReducer,useEffect,useRef}from'react';import styled from'styled-components';import{useTranslation}from'react-i18next';import{useWeb3Context,Connectors}from'web3-react';import{darken,transparentize}from'polished';import Jazzicon from'jazzicon';import{ethers}from'ethers';import{Activity,ArrowRight}from'react-feather';import{shortenAddress}from'../../utils';import{useENSName}from'../../hooks';import WalletModal from'../WalletModal';import{useAllTransactions}from'../../contexts/Transactions';import{Spinner}from'../../theme';import Circle from\"../../assets/images/circle.svg\";var Connector=Connectors.Connector;var Web3StatusGeneric=styled.button(_templateObject(),function(_ref){var theme=_ref.theme;return theme.flexRowNoWrap;});var Web3StatusError=styled(Web3StatusGeneric)(_templateObject2(),function(_ref2){var theme=_ref2.theme;return theme.salmonRed;},function(_ref3){var theme=_ref3.theme;return theme.white;},function(_ref4){var theme=_ref4.theme;return theme.salmonRed;},function(_ref5){var theme=_ref5.theme;return darken(0.1,theme.salmonRed);});var Web3StatusConnect=styled(Web3StatusGeneric)(_templateObject3(),function(_ref6){var theme=_ref6.theme;return theme.royalBlue;},function(_ref7){var theme=_ref7.theme;return theme.white;},function(_ref8){var theme=_ref8.theme;return theme.royalBlue;},function(_ref9){var theme=_ref9.theme;return darken(0.1,theme.royalBlue);});var Web3StatusConnected=styled(Web3StatusGeneric)(_templateObject4(),function(_ref10){var pending=_ref10.pending,theme=_ref10.theme;return pending?theme.zumthorBlue:theme.white;},function(_ref11){var pending=_ref11.pending,theme=_ref11.theme;return pending?theme.royalBlue:theme.doveGray;},function(_ref12){var pending=_ref12.pending,theme=_ref12.theme;return pending?theme.royalBlue:theme.mercuryGray;},function(_ref13){var pending=_ref13.pending,theme=_ref13.theme;return pending?transparentize(0.9,theme.royalBlue):transparentize(0.9,theme.mercuryGray);},function(_ref14){var pending=_ref14.pending,theme=_ref14.theme;return pending?darken(0.1,theme.royalBlue):darken(0.1,theme.mercuryGray);});var Text=styled.p(_templateObject5());var Identicon=styled.div(_templateObject6(),function(_ref15){var theme=_ref15.theme;return theme.silverGray;});var NetworkIcon=styled(Activity)(_templateObject7());var ArrowIcon=styled(ArrowRight)(_templateObject8());var SpinnerWrapper=styled(Spinner)(_templateObject9());var walletModalInitialState={open:false,error:undefined};var WALLET_MODAL_ERROR='WALLET_MODAL_ERROR';var WALLET_MODAL_OPEN='WALLET_MODAL_OPEN';var WALLET_MODAL_OPEN_ERROR='WALLET_MODAL_OPEN_ERROR';var WALLET_MODAL_CLOSE='WALLET_MODAL_CLOSE';function walletModalReducer(state,_ref16){var type=_ref16.type,payload=_ref16.payload;switch(type){case WALLET_MODAL_ERROR:{var error=payload.error;return _objectSpread({},state,{error:error});}case WALLET_MODAL_OPEN:{return _objectSpread({},state,{open:true});}case WALLET_MODAL_OPEN_ERROR:{var _ref17=payload||{},_error=_ref17.error;return{open:true,error:_error};}case WALLET_MODAL_CLOSE:{return _objectSpread({},state,{open:false});}default:{throw Error(\"Unexpected action type in walletModalReducer reducer: '\".concat(type,\"'.\"));}}}export default function Web3Status(){var _useTranslation=useTranslation(),t=_useTranslation.t;var _useWeb3Context=useWeb3Context(),active=_useWeb3Context.active,account=_useWeb3Context.account,connectorName=_useWeb3Context.connectorName,setConnector=_useWeb3Context.setConnector;var ENSName=useENSName(account);var allTransactions=useAllTransactions();var pending=Object.keys(allTransactions).filter(function(hash){return!allTransactions[hash].receipt;});var confirmed=Object.keys(allTransactions).filter(function(hash){return allTransactions[hash].receipt;});var hasPendingTransactions=!!pending.length;var _useReducer=useReducer(walletModalReducer,walletModalInitialState),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],walletModalIsOpen=_useReducer2$.open,walletModalError=_useReducer2$.error,dispatch=_useReducer2[1];function setError(error){dispatch({type:WALLET_MODAL_ERROR,payload:{error:error}});}function openWalletModal(error){dispatch(_objectSpread({type:WALLET_MODAL_OPEN},error?{payload:{error:error}}:{}));}function closeWalletModal(){dispatch({type:WALLET_MODAL_CLOSE});}// janky logic to detect log{ins,outs}...\nuseEffect(function(){// if the injected connector is not active...\nvar _window=window,ethereum=_window.ethereum;if(connectorName!=='Injected'){if(connectorName==='Network'&&ethereum&&ethereum.on&&ethereum.removeListener){var tryToActivateInjected=function tryToActivateInjected(){var library=new ethers.providers.Web3Provider(window.ethereum);// if calling enable won't pop an approve modal, then try to activate injected...\nlibrary.listAccounts().then(function(accounts){if(accounts.length>=1){setConnector('Injected',{suppressAndThrowErrors:true}).then(function(){setError();}).catch(function(error){// ...and if the error is that they're on the wrong network, display it, otherwise eat it\nif(error.code===Connector.errorCodes.UNSUPPORTED_NETWORK){setError(error);}});}});};ethereum.on('networkChanged',tryToActivateInjected);ethereum.on('accountsChanged',tryToActivateInjected);return function(){if(ethereum.removeListener){ethereum.removeListener('networkChanged',tryToActivateInjected);ethereum.removeListener('accountsChanged',tryToActivateInjected);}};}}else{// ...poll to check the accounts array, and if it's ever 0 i.e. the user logged out, update the connector\nif(ethereum){var accountPoll=setInterval(function(){var library=new ethers.providers.Web3Provider(ethereum);library.listAccounts().then(function(accounts){if(accounts.length===0){setConnector('Network');}});},750);return function(){clearInterval(accountPoll);};}}},[connectorName,setConnector]);function onClick(){if(walletModalError){openWalletModal();}else if(connectorName==='Network'&&(window.ethereum||window.web3)){setConnector('Injected',{suppressAndThrowErrors:true}).catch(function(error){if(error.code===Connector.errorCodes.UNSUPPORTED_NETWORK){setError(error);}});}else{openWalletModal();}}var ref=useRef();useEffect(function(){if(ref.current){ref.current.innerHTML='';if(account){ref.current.appendChild(Jazzicon(16,parseInt(account.slice(2,10),16)));}}},[account,walletModalError]);function getWeb3Status(){if(walletModalError){// this is ok because we're guaranteed that the error is a wrong network error\nreturn React.createElement(Web3StatusError,{onClick:onClick},React.createElement(NetworkIcon,null),React.createElement(Text,null,\"Wrong Network\"));}else if(!account){return React.createElement(Web3StatusConnect,{onClick:onClick},React.createElement(Text,null,t('Connect')),React.createElement(ArrowIcon,null));}else{return React.createElement(Web3StatusConnected,{onClick:onClick,pending:hasPendingTransactions},hasPendingTransactions&&React.createElement(SpinnerWrapper,{src:Circle,alt:\"loader\"}),React.createElement(Text,null,ENSName||shortenAddress(account)),React.createElement(Identicon,{ref:ref}));}}return active&&React.createElement(React.Fragment,null,getWeb3Status(),React.createElement(WalletModal,{isOpen:walletModalIsOpen,error:walletModalError,onDismiss:closeWalletModal,ENSName:ENSName,pendingTransactions:pending,confirmedTransactions:confirmed}));}","map":{"version":3,"sources":["/workspace/uniswap-exchange/src/components/Web3Status/index.js"],"names":["React","useReducer","useEffect","useRef","styled","useTranslation","useWeb3Context","Connectors","darken","transparentize","Jazzicon","ethers","Activity","ArrowRight","shortenAddress","useENSName","WalletModal","useAllTransactions","Spinner","Connector","Web3StatusGeneric","button","theme","flexRowNoWrap","Web3StatusError","salmonRed","white","Web3StatusConnect","royalBlue","Web3StatusConnected","pending","zumthorBlue","doveGray","mercuryGray","Text","p","Identicon","div","silverGray","NetworkIcon","ArrowIcon","SpinnerWrapper","walletModalInitialState","open","error","undefined","WALLET_MODAL_ERROR","WALLET_MODAL_OPEN","WALLET_MODAL_OPEN_ERROR","WALLET_MODAL_CLOSE","walletModalReducer","state","type","payload","Error","Web3Status","t","active","account","connectorName","setConnector","ENSName","allTransactions","Object","keys","filter","hash","receipt","confirmed","hasPendingTransactions","length","walletModalIsOpen","walletModalError","dispatch","setError","openWalletModal","closeWalletModal","window","ethereum","on","removeListener","tryToActivateInjected","library","providers","Web3Provider","listAccounts","then","accounts","suppressAndThrowErrors","catch","code","errorCodes","UNSUPPORTED_NETWORK","accountPoll","setInterval","clearInterval","onClick","web3","ref","current","innerHTML","appendChild","parseInt","slice","getWeb3Status","Circle"],"mappings":"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","sourcesContent":["import React, { useReducer, useEffect, useRef } from 'react'\nimport styled from 'styled-components'\nimport { useTranslation } from 'react-i18next'\nimport { useWeb3Context, Connectors } from 'web3-react'\nimport { darken, transparentize } from 'polished'\nimport Jazzicon from 'jazzicon'\nimport { ethers } from 'ethers'\nimport { Activity, ArrowRight } from 'react-feather'\n\nimport { shortenAddress } from '../../utils'\nimport { useENSName } from '../../hooks'\nimport WalletModal from '../WalletModal'\nimport { useAllTransactions } from '../../contexts/Transactions'\nimport { Spinner } from '../../theme'\nimport Circle from '../../assets/images/circle.svg'\n\nconst { Connector } = Connectors\n\nconst Web3StatusGeneric = styled.button`\n  ${({ theme }) => theme.flexRowNoWrap}\n  width: 100%;\n  font-size: 0.9rem;\n  align-items: center;\n  padding: 0.5rem;\n  border-radius: 2rem;\n  box-sizing: border-box;\n  cursor: pointer;\n  user-select: none;\n  :focus {\n    outline: none;\n  }\n`\nconst Web3StatusError = styled(Web3StatusGeneric)`\n  background-color: ${({ theme }) => theme.salmonRed};\n  color: ${({ theme }) => theme.white};\n  border: 1px solid ${({ theme }) => theme.salmonRed};\n  font-weight: 500;\n  :hover,\n  :focus {\n    background-color: ${({ theme }) => darken(0.1, theme.salmonRed)};\n  }\n`\n\nconst Web3StatusConnect = styled(Web3StatusGeneric)`\n  background-color: ${({ theme }) => theme.royalBlue};\n  color: ${({ theme }) => theme.white};\n  border: 1px solid ${({ theme }) => theme.royalBlue};\n  font-weight: 500;\n  :hover,\n  :focus {\n    background-color: ${({ theme }) => darken(0.1, theme.royalBlue)};\n  }\n`\n\nconst Web3StatusConnected = styled(Web3StatusGeneric)`\n  background-color: ${({ pending, theme }) => (pending ? theme.zumthorBlue : theme.white)};\n  color: ${({ pending, theme }) => (pending ? theme.royalBlue : theme.doveGray)};\n  border: 1px solid ${({ pending, theme }) => (pending ? theme.royalBlue : theme.mercuryGray)};\n  font-weight: 400;\n  :hover {\n    background-color: ${({ pending, theme }) =>\n      pending ? transparentize(0.9, theme.royalBlue) : transparentize(0.9, theme.mercuryGray)};\n  }\n  :focus {\n    border: 1px solid\n      ${({ pending, theme }) => (pending ? darken(0.1, theme.royalBlue) : darken(0.1, theme.mercuryGray))};\n  }\n`\n\nconst Text = styled.p`\n  flex: 1 1 auto;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n\n  margin: 0 0.5rem 0 0.25rem;\n  font-size: 0.83rem;\n`\n\nconst Identicon = styled.div`\n  height: 1rem;\n  width: 1rem;\n  border-radius: 1.125rem;\n  background-color: ${({ theme }) => theme.silverGray};\n`\n\nconst NetworkIcon = styled(Activity)`\n  margin-left: 0.25rem;\n  margin-right: 0.5rem;\n  width: 16px;\n  height: 16px;\n`\n\nconst ArrowIcon = styled(ArrowRight)`\n  margin-left: 0.25rem;\n  margin-right: 0.5rem;\n  width: 16px;\n  height: 16px;\n`\n\nconst SpinnerWrapper = styled(Spinner)`\n  margin: 0 0.25rem 0 0.25rem;\n`\n\nconst walletModalInitialState = {\n  open: false,\n  error: undefined\n}\n\nconst WALLET_MODAL_ERROR = 'WALLET_MODAL_ERROR'\nconst WALLET_MODAL_OPEN = 'WALLET_MODAL_OPEN'\nconst WALLET_MODAL_OPEN_ERROR = 'WALLET_MODAL_OPEN_ERROR'\nconst WALLET_MODAL_CLOSE = 'WALLET_MODAL_CLOSE'\n\nfunction walletModalReducer(state, { type, payload }) {\n  switch (type) {\n    case WALLET_MODAL_ERROR: {\n      const { error } = payload\n      return { ...state, error }\n    }\n    case WALLET_MODAL_OPEN: {\n      return { ...state, open: true }\n    }\n    case WALLET_MODAL_OPEN_ERROR: {\n      const { error } = payload || {}\n      return { open: true, error }\n    }\n    case WALLET_MODAL_CLOSE: {\n      return { ...state, open: false }\n    }\n    default: {\n      throw Error(`Unexpected action type in walletModalReducer reducer: '${type}'.`)\n    }\n  }\n}\n\nexport default function Web3Status() {\n  const { t } = useTranslation()\n  const { active, account, connectorName, setConnector } = useWeb3Context()\n\n  const ENSName = useENSName(account)\n\n  const allTransactions = useAllTransactions()\n  const pending = Object.keys(allTransactions).filter(hash => !allTransactions[hash].receipt)\n  const confirmed = Object.keys(allTransactions).filter(hash => allTransactions[hash].receipt)\n\n  const hasPendingTransactions = !!pending.length\n\n  const [{ open: walletModalIsOpen, error: walletModalError }, dispatch] = useReducer(\n    walletModalReducer,\n    walletModalInitialState\n  )\n  function setError(error) {\n    dispatch({ type: WALLET_MODAL_ERROR, payload: { error } })\n  }\n  function openWalletModal(error) {\n    dispatch({ type: WALLET_MODAL_OPEN, ...(error ? { payload: { error } } : {}) })\n  }\n  function closeWalletModal() {\n    dispatch({ type: WALLET_MODAL_CLOSE })\n  }\n\n  // janky logic to detect log{ins,outs}...\n  useEffect(() => {\n    // if the injected connector is not active...\n    const { ethereum } = window\n    if (connectorName !== 'Injected') {\n      if (connectorName === 'Network' && ethereum && ethereum.on && ethereum.removeListener) {\n        function tryToActivateInjected() {\n          const library = new ethers.providers.Web3Provider(window.ethereum)\n          // if calling enable won't pop an approve modal, then try to activate injected...\n          library.listAccounts().then(accounts => {\n            if (accounts.length >= 1) {\n              setConnector('Injected', { suppressAndThrowErrors: true })\n                .then(() => {\n                  setError()\n                })\n                .catch(error => {\n                  // ...and if the error is that they're on the wrong network, display it, otherwise eat it\n                  if (error.code === Connector.errorCodes.UNSUPPORTED_NETWORK) {\n                    setError(error)\n                  }\n                })\n            }\n          })\n        }\n\n        ethereum.on('networkChanged', tryToActivateInjected)\n        ethereum.on('accountsChanged', tryToActivateInjected)\n\n        return () => {\n          if (ethereum.removeListener) {\n            ethereum.removeListener('networkChanged', tryToActivateInjected)\n            ethereum.removeListener('accountsChanged', tryToActivateInjected)\n          }\n        }\n      }\n    } else {\n      // ...poll to check the accounts array, and if it's ever 0 i.e. the user logged out, update the connector\n      if (ethereum) {\n        const accountPoll = setInterval(() => {\n          const library = new ethers.providers.Web3Provider(ethereum)\n          library.listAccounts().then(accounts => {\n            if (accounts.length === 0) {\n              setConnector('Network')\n            }\n          })\n        }, 750)\n\n        return () => {\n          clearInterval(accountPoll)\n        }\n      }\n    }\n  }, [connectorName, setConnector])\n\n  function onClick() {\n    if (walletModalError) {\n      openWalletModal()\n    } else if (connectorName === 'Network' && (window.ethereum || window.web3)) {\n      setConnector('Injected', { suppressAndThrowErrors: true }).catch(error => {\n        if (error.code === Connector.errorCodes.UNSUPPORTED_NETWORK) {\n          setError(error)\n        }\n      })\n    } else {\n      openWalletModal()\n    }\n  }\n\n  const ref = useRef()\n  useEffect(() => {\n    if (ref.current) {\n      ref.current.innerHTML = ''\n      if (account) {\n        ref.current.appendChild(Jazzicon(16, parseInt(account.slice(2, 10), 16)))\n      }\n    }\n  }, [account, walletModalError])\n\n  function getWeb3Status() {\n    if (walletModalError) {\n      // this is ok because we're guaranteed that the error is a wrong network error\n      return (\n        <Web3StatusError onClick={onClick}>\n          <NetworkIcon />\n          <Text>Wrong Network</Text>\n        </Web3StatusError>\n      )\n    } else if (!account) {\n      return (\n        <Web3StatusConnect onClick={onClick}>\n          <Text>{t('Connect')}</Text>\n          <ArrowIcon />\n        </Web3StatusConnect>\n      )\n    } else {\n      return (\n        <Web3StatusConnected onClick={onClick} pending={hasPendingTransactions}>\n          {hasPendingTransactions && <SpinnerWrapper src={Circle} alt=\"loader\" />}\n          <Text>{ENSName || shortenAddress(account)}</Text>\n          <Identicon ref={ref} />\n        </Web3StatusConnected>\n      )\n    }\n  }\n\n  return (\n    active && (\n      <>\n        {getWeb3Status()}\n        <WalletModal\n          isOpen={walletModalIsOpen}\n          error={walletModalError}\n          onDismiss={closeWalletModal}\n          ENSName={ENSName}\n          pendingTransactions={pending}\n          confirmedTransactions={confirmed}\n        />\n      </>\n    )\n  )\n}\n"]},"metadata":{},"sourceType":"module"}