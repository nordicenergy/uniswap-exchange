{"ast":null,"code":"import _slicedToArray from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  font-size: 4rem;\\n\\n  svg {\\n    path {\\n      color: \",\";\\n    }\\n  }\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  color: \",\";\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  height: 20rem;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useEffect}from'react';import{useWeb3Context,Connectors}from'web3-react';import styled from'styled-components';import{ethers}from'ethers';import{useTranslation}from'react-i18next';import{isMobile}from'react-device-detect';import{Spinner}from'../../theme';import Circle from\"../../assets/images/circle.svg\";var Connector=Connectors.Connector;var MessageWrapper=styled.div(_templateObject());var Message=styled.h2(_templateObject2(),function(_ref){var theme=_ref.theme;return theme.uniswapPink;});var SpinnerWrapper=styled(Spinner)(_templateObject3(),function(_ref2){var theme=_ref2.theme;return theme.uniswapPink;});function tryToSetConnector(setConnector,setError){setConnector('Injected',{suppressAndThrowErrors:true}).catch(function(error){setConnector('Network');});}export default function Web3ReactManager(_ref3){var children=_ref3.children;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useWeb3Context=useWeb3Context(),active=_useWeb3Context.active,error=_useWeb3Context.error,setConnector=_useWeb3Context.setConnector,setError=_useWeb3Context.setError;// control whether or not we render the error, after parsing\nvar blockRender=error&&error.code&&error.code===Connector.errorCodes.UNSUPPORTED_NETWORK;useEffect(function(){if(!active&&!error){if(window.ethereum||window.web3){if(isMobile){tryToSetConnector(setConnector,setError);}else{var library=new ethers.providers.Web3Provider(window.ethereum||window.web3);library.listAccounts().then(function(accounts){if(accounts.length>=1){tryToSetConnector(setConnector,setError);}else{setConnector('Network');}});}}else{setConnector('Network');}}},[active,error,setConnector,setError]);// parse the error\nuseEffect(function(){if(error){// if the user changes to the wrong network, unset the connector\nif(error.code===Connector.errorCodes.UNSUPPORTED_NETWORK){setConnector('Network');}}},[error,setConnector]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showLoader=_useState2[0],setShowLoader=_useState2[1];useEffect(function(){var timeout=setTimeout(function(){setShowLoader(true);},600);return function(){clearTimeout(timeout);};},[]);if(blockRender){return null;}else if(error){return React.createElement(MessageWrapper,null,React.createElement(Message,null,t('unknownError')));}else if(!active){return showLoader?React.createElement(MessageWrapper,null,React.createElement(SpinnerWrapper,{src:Circle})):null;}else{return children;}}","map":{"version":3,"sources":["/workspace/uniswap-exchange/src/components/Web3ReactManager/index.js"],"names":["React","useState","useEffect","useWeb3Context","Connectors","styled","ethers","useTranslation","isMobile","Spinner","Connector","MessageWrapper","div","Message","h2","theme","uniswapPink","SpinnerWrapper","tryToSetConnector","setConnector","setError","suppressAndThrowErrors","catch","error","Web3ReactManager","children","t","active","blockRender","code","errorCodes","UNSUPPORTED_NETWORK","window","ethereum","web3","library","providers","Web3Provider","listAccounts","then","accounts","length","showLoader","setShowLoader","timeout","setTimeout","clearTimeout","Circle"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { useWeb3Context, Connectors } from 'web3-react'\nimport styled from 'styled-components'\nimport { ethers } from 'ethers'\nimport { useTranslation } from 'react-i18next'\nimport { isMobile } from 'react-device-detect'\n\nimport { Spinner } from '../../theme'\nimport Circle from '../../assets/images/circle.svg'\n\nconst { Connector } = Connectors\n\nconst MessageWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 20rem;\n`\n\nconst Message = styled.h2`\n  color: ${({ theme }) => theme.uniswapPink};\n`\n\nconst SpinnerWrapper = styled(Spinner)`\n  font-size: 4rem;\n\n  svg {\n    path {\n      color: ${({ theme }) => theme.uniswapPink};\n    }\n  }\n`\n\nfunction tryToSetConnector(setConnector, setError) {\n  setConnector('Injected', { suppressAndThrowErrors: true }).catch(error => {\n    setConnector('Network')\n  })\n}\n\nexport default function Web3ReactManager({ children }) {\n  const { t } = useTranslation()\n  const { active, error, setConnector, setError } = useWeb3Context()\n  // control whether or not we render the error, after parsing\n  const blockRender = error && error.code && error.code === Connector.errorCodes.UNSUPPORTED_NETWORK\n\n  useEffect(() => {\n    if (!active && !error) {\n      if (window.ethereum || window.web3) {\n        if (isMobile) {\n          tryToSetConnector(setConnector, setError)\n        } else {\n          const library = new ethers.providers.Web3Provider(window.ethereum || window.web3)\n          library.listAccounts().then(accounts => {\n            if (accounts.length >= 1) {\n              tryToSetConnector(setConnector, setError)\n            } else {\n              setConnector('Network')\n            }\n          })\n        }\n      } else {\n        setConnector('Network')\n      }\n    }\n  }, [active, error, setConnector, setError])\n\n  // parse the error\n  useEffect(() => {\n    if (error) {\n      // if the user changes to the wrong network, unset the connector\n      if (error.code === Connector.errorCodes.UNSUPPORTED_NETWORK) {\n        setConnector('Network')\n      }\n    }\n  }, [error, setConnector])\n\n  const [showLoader, setShowLoader] = useState(false)\n  useEffect(() => {\n    const timeout = setTimeout(() => {\n      setShowLoader(true)\n    }, 600)\n    return () => {\n      clearTimeout(timeout)\n    }\n  }, [])\n\n  if (blockRender) {\n    return null\n  } else if (error) {\n    return (\n      <MessageWrapper>\n        <Message>{t('unknownError')}</Message>\n      </MessageWrapper>\n    )\n  } else if (!active) {\n    return showLoader ? (\n      <MessageWrapper>\n        <SpinnerWrapper src={Circle} />\n      </MessageWrapper>\n    ) : null\n  } else {\n    return children\n  }\n}\n"]},"metadata":{},"sourceType":"module"}