{"ast":null,"code":"import { ethers } from \"ethers\";\nimport FACTORY_ABI from \"../constants/abis/factory\";\nimport EXCHANGE_ABI from \"../constants/abis/exchange\";\nimport ERC20_ABI from \"../constants/abis/erc20\";\nimport ERC20_BYTES32_ABI from \"../constants/abis/erc20_bytes32\";\nimport { FACTORY_ADDRESSES, SUPPORTED_THEMES } from \"../constants\";\nimport { formatFixed } from \"@uniswap/sdk\";\nimport UncheckedJsonRpcSigner from \"./signer\";\nexport const ERROR_CODES = [\"TOKEN_NAME\", \"TOKEN_SYMBOL\", \"TOKEN_DECIMALS\"].reduce((accumulator, currentValue, currentIndex) => {\n  accumulator[currentValue] = currentIndex;\n  return accumulator;\n}, {});\nexport function safeAccess(object, path) {\n  return object ? path.reduce((accumulator, currentValue) => accumulator && accumulator[currentValue] ? accumulator[currentValue] : null, object) : null;\n}\nconst ETHERSCAN_PREFIXES = {\n  1: \"\",\n  3: \"ropsten.\",\n  4: \"rinkeby.\",\n  5: \"goerli.\",\n  42: \"kovan.\"\n};\nexport function getEtherscanLink(networkId, data, type) {\n  const prefix = `https://${ETHERSCAN_PREFIXES[networkId] || ETHERSCAN_PREFIXES[1]}etherscan.io`;\n\n  switch (type) {\n    case \"transaction\":\n      {\n        return `${prefix}/tx/${data}`;\n      }\n\n    case \"address\":\n    default:\n      {\n        return `${prefix}/address/${data}`;\n      }\n  }\n}\nexport function getQueryParam(windowLocation, name) {\n  var q = windowLocation.search.match(new RegExp(\"[?&]\" + name + \"=([^&#?]*)\"));\n  return q && q[1];\n}\nexport function getAllQueryParams() {\n  let params = {};\n  params.theme = checkSupportedTheme(getQueryParam(window.location, \"theme\"));\n  params.inputCurrency = isAddress(getQueryParam(window.location, \"inputCurrency\")) ? isAddress(getQueryParam(window.location, \"inputCurrency\")) : \"\";\n  params.outputCurrency = isAddress(getQueryParam(window.location, \"outputCurrency\")) ? isAddress(getQueryParam(window.location, \"outputCurrency\")) : getQueryParam(window.location, \"outputCurrency\") === \"ETH\" ? \"ETH\" : \"\";\n  params.slippage = !isNaN(getQueryParam(window.location, \"slippage\")) ? getQueryParam(window.location, \"slippage\") : \"\";\n  params.exactField = getQueryParam(window.location, \"exactField\");\n  params.exactAmount = !isNaN(getQueryParam(window.location, \"exactAmount\")) ? getQueryParam(window.location, \"exactAmount\") : \"\";\n  params.theme = checkSupportedTheme(getQueryParam(window.location, \"theme\"));\n  params.recipient = isAddress(getQueryParam(window.location, \"recipient\")) ? getQueryParam(window.location, \"recipient\") : \"\"; // Add Liquidity params\n\n  params.ethAmount = !isNaN(getQueryParam(window.location, \"ethAmount\")) ? getQueryParam(window.location, \"ethAmount\") : \"\";\n  params.tokenAmount = !isNaN(getQueryParam(window.location, \"tokenAmount\")) ? getQueryParam(window.location, \"tokenAmount\") : \"\";\n  params.token = isAddress(getQueryParam(window.location, \"token\")) ? isAddress(getQueryParam(window.location, \"token\")) : \"\"; // Remove liquidity params\n\n  params.poolTokenAmount = !isNaN(getQueryParam(window.location, \"poolTokenAmount\")) ? getQueryParam(window.location, \"poolTokenAmount\") : \"\";\n  params.poolTokenAddress = isAddress(getQueryParam(window.location, \"poolTokenAddress\")) ? isAddress(getQueryParam(window.location, \"poolTokenAddress\")) ? isAddress(getQueryParam(window.location, \"poolTokenAddress\")) : \"\" : \"\"; // Create Exchange params\n\n  params.tokenAddress = isAddress(getQueryParam(window.location, \"tokenAddress\")) ? isAddress(getQueryParam(window.location, \"tokenAddress\")) : \"\";\n  return params;\n}\nexport function checkSupportedTheme(themeName) {\n  if (themeName && themeName.toUpperCase() in SUPPORTED_THEMES) {\n    return themeName.toUpperCase();\n  }\n\n  return null;\n}\nexport function getNetworkName(networkId) {\n  switch (networkId) {\n    case 1:\n      {\n        return \"the Main Ethereum Network\";\n      }\n\n    case 3:\n      {\n        return \"the Ropsten Test Network\";\n      }\n\n    case 4:\n      {\n        return \"the Rinkeby Test Network\";\n      }\n\n    case 5:\n      {\n        return \"the Görli Test Network\";\n      }\n\n    case 42:\n      {\n        return \"the Kovan Test Network\";\n      }\n\n    default:\n      {\n        return \"the correct network\";\n      }\n  }\n}\nexport function shortenAddress(address, digits = 4) {\n  if (!isAddress(address)) {\n    throw Error(`Invalid 'address' parameter '${address}'.`);\n  }\n\n  return `${address.substring(0, digits + 2)}...${address.substring(42 - digits)}`;\n}\nexport function shortenTransactionHash(hash, digits = 4) {\n  return `${hash.substring(0, digits + 2)}...${hash.substring(66 - digits)}`;\n}\nexport function isAddress(value) {\n  try {\n    return ethers.utils.getAddress(value.toLowerCase());\n  } catch {\n    return false;\n  }\n}\nexport function calculateGasMargin(value, margin) {\n  const offset = value.mul(margin).div(ethers.utils.bigNumberify(10000));\n  return value.add(offset);\n} // account is optional\n\nexport function getProviderOrSigner(library, account) {\n  return account ? new UncheckedJsonRpcSigner(library.getSigner(account)) : library;\n} // account is optional\n\nexport function getContract(address, ABI, library, account) {\n  if (!isAddress(address) || address === ethers.constants.AddressZero) {\n    throw Error(`Invalid 'address' parameter '${address}'.`);\n  }\n\n  return new ethers.Contract(address, ABI, getProviderOrSigner(library, account));\n} // account is optional\n\nexport function getFactoryContract(networkId, library, account) {\n  return getContract(FACTORY_ADDRESSES[networkId], FACTORY_ABI, library, account);\n} // account is optional\n\nexport function getExchangeContract(exchangeAddress, library, account) {\n  return getContract(exchangeAddress, EXCHANGE_ABI, library, account);\n} // get token name\n\nexport async function getTokenName(tokenAddress, library) {\n  if (!isAddress(tokenAddress)) {\n    throw Error(`Invalid 'tokenAddress' parameter '${tokenAddress}'.`);\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library).name().catch(() => getContract(tokenAddress, ERC20_BYTES32_ABI, library).name().then(bytes32 => ethers.utils.parseBytes32String(bytes32))).catch(error => {\n    error.code = ERROR_CODES.TOKEN_SYMBOL;\n    throw error;\n  });\n} // get token symbol\n\nexport async function getTokenSymbol(tokenAddress, library) {\n  if (!isAddress(tokenAddress)) {\n    throw Error(`Invalid 'tokenAddress' parameter '${tokenAddress}'.`);\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library).symbol().catch(() => {\n    const contractBytes32 = getContract(tokenAddress, ERC20_BYTES32_ABI, library);\n    return contractBytes32.symbol().then(bytes32 => ethers.utils.parseBytes32String(bytes32));\n  }).catch(error => {\n    error.code = ERROR_CODES.TOKEN_SYMBOL;\n    throw error;\n  });\n} // get token decimals\n\nexport async function getTokenDecimals(tokenAddress, library) {\n  if (!isAddress(tokenAddress)) {\n    throw Error(`Invalid 'tokenAddress' parameter '${tokenAddress}'.`);\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library).decimals().catch(error => {\n    error.code = ERROR_CODES.TOKEN_DECIMALS;\n    throw error;\n  });\n} // get the exchange address for a token from the factory\n\nexport async function getTokenExchangeAddressFromFactory(tokenAddress, networkId, library) {\n  return getFactoryContract(networkId, library).getExchange(tokenAddress);\n} // get the ether balance of an address\n\nexport async function getEtherBalance(address, library) {\n  if (!isAddress(address)) {\n    throw Error(`Invalid 'address' parameter '${address}'`);\n  }\n\n  return library.getBalance(address);\n}\nexport function formatEthBalance(balance) {\n  return amountFormatter(balance, 18, 6);\n}\nexport function formatTokenBalance(balance, decimal) {\n  return !!(balance && Number.isInteger(decimal)) ? amountFormatter(balance, decimal, Math.min(4, decimal)) : 0;\n}\nexport function formatToUsd(price) {\n  const format = {\n    decimalSeparator: \".\",\n    groupSeparator: \",\",\n    groupSize: 3\n  };\n  const usdPrice = formatFixed(price, {\n    decimalPlaces: 2,\n    dropTrailingZeros: false,\n    format\n  });\n  return usdPrice;\n} // get the token balance of an address\n\nexport async function getTokenBalance(tokenAddress, address, library) {\n  if (!isAddress(tokenAddress) || !isAddress(address)) {\n    throw Error(`Invalid 'tokenAddress' or 'address' parameter '${tokenAddress}' or '${address}'.`);\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library).balanceOf(address);\n} // get the token allowance\n\nexport async function getTokenAllowance(address, tokenAddress, spenderAddress, library) {\n  if (!isAddress(address) || !isAddress(tokenAddress) || !isAddress(spenderAddress)) {\n    throw Error(\"Invalid 'address' or 'tokenAddress' or 'spenderAddress' parameter\" + `'${address}' or '${tokenAddress}' or '${spenderAddress}'.`);\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library).allowance(address, spenderAddress);\n} // amount must be a BigNumber, {base,display}Decimals must be Numbers\n\nexport function amountFormatter(amount, baseDecimals = 18, displayDecimals = 3, useLessThan = true) {\n  if (baseDecimals > 18 || displayDecimals > 18 || displayDecimals > baseDecimals) {\n    throw Error(`Invalid combination of baseDecimals '${baseDecimals}' and displayDecimals '${displayDecimals}.`);\n  } // if balance is falsy, return undefined\n\n\n  if (!amount) {\n    return undefined;\n  } // if amount is 0, return\n  else if (amount.isZero()) {\n      return \"0\";\n    } // amount > 0\n    else {\n        // amount of 'wei' in 1 'ether'\n        const baseAmount = ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(baseDecimals));\n        const minimumDisplayAmount = baseAmount.div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(displayDecimals))); // if balance is less than the minimum display amount\n\n        if (amount.lt(minimumDisplayAmount)) {\n          return useLessThan ? `<${ethers.utils.formatUnits(minimumDisplayAmount, baseDecimals)}` : `${ethers.utils.formatUnits(amount, baseDecimals)}`;\n        } // if the balance is greater than the minimum display amount\n        else {\n            const stringAmount = ethers.utils.formatUnits(amount, baseDecimals); // if there isn't a decimal portion\n\n            if (!stringAmount.match(/\\./)) {\n              return stringAmount;\n            } // if there is a decimal portion\n            else {\n                const [wholeComponent, decimalComponent] = stringAmount.split(\".\");\n                const roundedDecimalComponent = ethers.utils.bigNumberify(decimalComponent.padEnd(baseDecimals, \"0\")).toString().padStart(baseDecimals, \"0\").substring(0, displayDecimals); // decimals are too small to show\n\n                if (roundedDecimalComponent === \"0\".repeat(displayDecimals)) {\n                  return wholeComponent;\n                } // decimals are not too small to show\n                else {\n                    return `${wholeComponent}.${roundedDecimalComponent.toString().replace(/0*$/, \"\")}`;\n                  }\n              }\n          }\n      }\n}","map":{"version":3,"sources":["/workspace/uniswap-exchange/src/utils/index.js"],"names":["ethers","FACTORY_ABI","EXCHANGE_ABI","ERC20_ABI","ERC20_BYTES32_ABI","FACTORY_ADDRESSES","SUPPORTED_THEMES","formatFixed","UncheckedJsonRpcSigner","ERROR_CODES","reduce","accumulator","currentValue","currentIndex","safeAccess","object","path","ETHERSCAN_PREFIXES","getEtherscanLink","networkId","data","type","prefix","getQueryParam","windowLocation","name","q","search","match","RegExp","getAllQueryParams","params","theme","checkSupportedTheme","window","location","inputCurrency","isAddress","outputCurrency","slippage","isNaN","exactField","exactAmount","recipient","ethAmount","tokenAmount","token","poolTokenAmount","poolTokenAddress","tokenAddress","themeName","toUpperCase","getNetworkName","shortenAddress","address","digits","Error","substring","shortenTransactionHash","hash","value","utils","getAddress","toLowerCase","calculateGasMargin","margin","offset","mul","div","bigNumberify","add","getProviderOrSigner","library","account","getSigner","getContract","ABI","constants","AddressZero","Contract","getFactoryContract","getExchangeContract","exchangeAddress","getTokenName","catch","then","bytes32","parseBytes32String","error","code","TOKEN_SYMBOL","getTokenSymbol","symbol","contractBytes32","getTokenDecimals","decimals","TOKEN_DECIMALS","getTokenExchangeAddressFromFactory","getExchange","getEtherBalance","getBalance","formatEthBalance","balance","amountFormatter","formatTokenBalance","decimal","Number","isInteger","Math","min","formatToUsd","price","format","decimalSeparator","groupSeparator","groupSize","usdPrice","decimalPlaces","dropTrailingZeros","getTokenBalance","balanceOf","getTokenAllowance","spenderAddress","allowance","amount","baseDecimals","displayDecimals","useLessThan","undefined","isZero","baseAmount","pow","minimumDisplayAmount","lt","formatUnits","stringAmount","wholeComponent","decimalComponent","split","roundedDecimalComponent","padEnd","toString","padStart","repeat","replace"],"mappings":"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","sourcesContent":["import { ethers } from \"ethers\";\n\nimport FACTORY_ABI from \"../constants/abis/factory\";\nimport EXCHANGE_ABI from \"../constants/abis/exchange\";\nimport ERC20_ABI from \"../constants/abis/erc20\";\nimport ERC20_BYTES32_ABI from \"../constants/abis/erc20_bytes32\";\nimport { FACTORY_ADDRESSES, SUPPORTED_THEMES } from \"../constants\";\nimport { formatFixed } from \"@uniswap/sdk\";\n\nimport UncheckedJsonRpcSigner from \"./signer\";\n\nexport const ERROR_CODES = [\n  \"TOKEN_NAME\",\n  \"TOKEN_SYMBOL\",\n  \"TOKEN_DECIMALS\"\n].reduce((accumulator, currentValue, currentIndex) => {\n  accumulator[currentValue] = currentIndex;\n  return accumulator;\n}, {});\n\nexport function safeAccess(object, path) {\n  return object\n    ? path.reduce(\n        (accumulator, currentValue) =>\n          accumulator && accumulator[currentValue]\n            ? accumulator[currentValue]\n            : null,\n        object\n      )\n    : null;\n}\n\nconst ETHERSCAN_PREFIXES = {\n  1: \"\",\n  3: \"ropsten.\",\n  4: \"rinkeby.\",\n  5: \"goerli.\",\n  42: \"kovan.\"\n};\n\nexport function getEtherscanLink(networkId, data, type) {\n  const prefix = `https://${ETHERSCAN_PREFIXES[networkId] ||\n    ETHERSCAN_PREFIXES[1]}etherscan.io`;\n\n  switch (type) {\n    case \"transaction\": {\n      return `${prefix}/tx/${data}`;\n    }\n    case \"address\":\n    default: {\n      return `${prefix}/address/${data}`;\n    }\n  }\n}\n\nexport function getQueryParam(windowLocation, name) {\n  var q = windowLocation.search.match(new RegExp(\"[?&]\" + name + \"=([^&#?]*)\"));\n  return q && q[1];\n}\n\nexport function getAllQueryParams() {\n  let params = {};\n  params.theme = checkSupportedTheme(getQueryParam(window.location, \"theme\"));\n\n  params.inputCurrency = isAddress(\n    getQueryParam(window.location, \"inputCurrency\")\n  )\n    ? isAddress(getQueryParam(window.location, \"inputCurrency\"))\n    : \"\";\n  params.outputCurrency = isAddress(\n    getQueryParam(window.location, \"outputCurrency\")\n  )\n    ? isAddress(getQueryParam(window.location, \"outputCurrency\"))\n    : getQueryParam(window.location, \"outputCurrency\") === \"ETH\"\n    ? \"ETH\"\n    : \"\";\n  params.slippage = !isNaN(getQueryParam(window.location, \"slippage\"))\n    ? getQueryParam(window.location, \"slippage\")\n    : \"\";\n  params.exactField = getQueryParam(window.location, \"exactField\");\n  params.exactAmount = !isNaN(getQueryParam(window.location, \"exactAmount\"))\n    ? getQueryParam(window.location, \"exactAmount\")\n    : \"\";\n  params.theme = checkSupportedTheme(getQueryParam(window.location, \"theme\"));\n  params.recipient = isAddress(getQueryParam(window.location, \"recipient\"))\n    ? getQueryParam(window.location, \"recipient\")\n    : \"\";\n\n  // Add Liquidity params\n  params.ethAmount = !isNaN(getQueryParam(window.location, \"ethAmount\"))\n    ? getQueryParam(window.location, \"ethAmount\")\n    : \"\";\n  params.tokenAmount = !isNaN(getQueryParam(window.location, \"tokenAmount\"))\n    ? getQueryParam(window.location, \"tokenAmount\")\n    : \"\";\n  params.token = isAddress(getQueryParam(window.location, \"token\"))\n    ? isAddress(getQueryParam(window.location, \"token\"))\n    : \"\";\n\n  // Remove liquidity params\n  params.poolTokenAmount = !isNaN(\n    getQueryParam(window.location, \"poolTokenAmount\")\n  )\n    ? getQueryParam(window.location, \"poolTokenAmount\")\n    : \"\";\n  params.poolTokenAddress = isAddress(\n    getQueryParam(window.location, \"poolTokenAddress\")\n  )\n    ? isAddress(getQueryParam(window.location, \"poolTokenAddress\"))\n      ? isAddress(getQueryParam(window.location, \"poolTokenAddress\"))\n      : \"\"\n    : \"\";\n\n  // Create Exchange params\n  params.tokenAddress = isAddress(\n    getQueryParam(window.location, \"tokenAddress\")\n  )\n    ? isAddress(getQueryParam(window.location, \"tokenAddress\"))\n    : \"\";\n\n  return params;\n}\n\nexport function checkSupportedTheme(themeName) {\n  if (themeName && themeName.toUpperCase() in SUPPORTED_THEMES) {\n    return themeName.toUpperCase();\n  }\n  return null;\n}\n\nexport function getNetworkName(networkId) {\n  switch (networkId) {\n    case 1: {\n      return \"the Main Ethereum Network\";\n    }\n    case 3: {\n      return \"the Ropsten Test Network\";\n    }\n    case 4: {\n      return \"the Rinkeby Test Network\";\n    }\n    case 5: {\n      return \"the Görli Test Network\";\n    }\n    case 42: {\n      return \"the Kovan Test Network\";\n    }\n    default: {\n      return \"the correct network\";\n    }\n  }\n}\n\nexport function shortenAddress(address, digits = 4) {\n  if (!isAddress(address)) {\n    throw Error(`Invalid 'address' parameter '${address}'.`);\n  }\n  return `${address.substring(0, digits + 2)}...${address.substring(\n    42 - digits\n  )}`;\n}\n\nexport function shortenTransactionHash(hash, digits = 4) {\n  return `${hash.substring(0, digits + 2)}...${hash.substring(66 - digits)}`;\n}\n\nexport function isAddress(value) {\n  try {\n    return ethers.utils.getAddress(value.toLowerCase());\n  } catch {\n    return false;\n  }\n}\n\nexport function calculateGasMargin(value, margin) {\n  const offset = value.mul(margin).div(ethers.utils.bigNumberify(10000));\n  return value.add(offset);\n}\n\n// account is optional\nexport function getProviderOrSigner(library, account) {\n  return account\n    ? new UncheckedJsonRpcSigner(library.getSigner(account))\n    : library;\n}\n\n// account is optional\nexport function getContract(address, ABI, library, account) {\n  if (!isAddress(address) || address === ethers.constants.AddressZero) {\n    throw Error(`Invalid 'address' parameter '${address}'.`);\n  }\n\n  return new ethers.Contract(\n    address,\n    ABI,\n    getProviderOrSigner(library, account)\n  );\n}\n\n// account is optional\nexport function getFactoryContract(networkId, library, account) {\n  return getContract(\n    FACTORY_ADDRESSES[networkId],\n    FACTORY_ABI,\n    library,\n    account\n  );\n}\n\n// account is optional\nexport function getExchangeContract(exchangeAddress, library, account) {\n  return getContract(exchangeAddress, EXCHANGE_ABI, library, account);\n}\n\n// get token name\nexport async function getTokenName(tokenAddress, library) {\n  if (!isAddress(tokenAddress)) {\n    throw Error(`Invalid 'tokenAddress' parameter '${tokenAddress}'.`);\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library)\n    .name()\n    .catch(() =>\n      getContract(tokenAddress, ERC20_BYTES32_ABI, library)\n        .name()\n        .then(bytes32 => ethers.utils.parseBytes32String(bytes32))\n    )\n    .catch(error => {\n      error.code = ERROR_CODES.TOKEN_SYMBOL;\n      throw error;\n    });\n}\n\n// get token symbol\nexport async function getTokenSymbol(tokenAddress, library) {\n  if (!isAddress(tokenAddress)) {\n    throw Error(`Invalid 'tokenAddress' parameter '${tokenAddress}'.`);\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library)\n    .symbol()\n    .catch(() => {\n      const contractBytes32 = getContract(\n        tokenAddress,\n        ERC20_BYTES32_ABI,\n        library\n      );\n      return contractBytes32\n        .symbol()\n        .then(bytes32 => ethers.utils.parseBytes32String(bytes32));\n    })\n    .catch(error => {\n      error.code = ERROR_CODES.TOKEN_SYMBOL;\n      throw error;\n    });\n}\n\n// get token decimals\nexport async function getTokenDecimals(tokenAddress, library) {\n  if (!isAddress(tokenAddress)) {\n    throw Error(`Invalid 'tokenAddress' parameter '${tokenAddress}'.`);\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library)\n    .decimals()\n    .catch(error => {\n      error.code = ERROR_CODES.TOKEN_DECIMALS;\n      throw error;\n    });\n}\n\n// get the exchange address for a token from the factory\nexport async function getTokenExchangeAddressFromFactory(\n  tokenAddress,\n  networkId,\n  library\n) {\n  return getFactoryContract(networkId, library).getExchange(tokenAddress);\n}\n\n// get the ether balance of an address\nexport async function getEtherBalance(address, library) {\n  if (!isAddress(address)) {\n    throw Error(`Invalid 'address' parameter '${address}'`);\n  }\n  return library.getBalance(address);\n}\n\nexport function formatEthBalance(balance) {\n  return amountFormatter(balance, 18, 6);\n}\n\nexport function formatTokenBalance(balance, decimal) {\n  return !!(balance && Number.isInteger(decimal))\n    ? amountFormatter(balance, decimal, Math.min(4, decimal))\n    : 0;\n}\n\nexport function formatToUsd(price) {\n  const format = { decimalSeparator: \".\", groupSeparator: \",\", groupSize: 3 };\n  const usdPrice = formatFixed(price, {\n    decimalPlaces: 2,\n    dropTrailingZeros: false,\n    format\n  });\n  return usdPrice;\n}\n\n// get the token balance of an address\nexport async function getTokenBalance(tokenAddress, address, library) {\n  if (!isAddress(tokenAddress) || !isAddress(address)) {\n    throw Error(\n      `Invalid 'tokenAddress' or 'address' parameter '${tokenAddress}' or '${address}'.`\n    );\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library).balanceOf(address);\n}\n\n// get the token allowance\nexport async function getTokenAllowance(\n  address,\n  tokenAddress,\n  spenderAddress,\n  library\n) {\n  if (\n    !isAddress(address) ||\n    !isAddress(tokenAddress) ||\n    !isAddress(spenderAddress)\n  ) {\n    throw Error(\n      \"Invalid 'address' or 'tokenAddress' or 'spenderAddress' parameter\" +\n        `'${address}' or '${tokenAddress}' or '${spenderAddress}'.`\n    );\n  }\n\n  return getContract(tokenAddress, ERC20_ABI, library).allowance(\n    address,\n    spenderAddress\n  );\n}\n\n// amount must be a BigNumber, {base,display}Decimals must be Numbers\nexport function amountFormatter(\n  amount,\n  baseDecimals = 18,\n  displayDecimals = 3,\n  useLessThan = true\n) {\n  if (\n    baseDecimals > 18 ||\n    displayDecimals > 18 ||\n    displayDecimals > baseDecimals\n  ) {\n    throw Error(\n      `Invalid combination of baseDecimals '${baseDecimals}' and displayDecimals '${displayDecimals}.`\n    );\n  }\n\n  // if balance is falsy, return undefined\n  if (!amount) {\n    return undefined;\n  }\n  // if amount is 0, return\n  else if (amount.isZero()) {\n    return \"0\";\n  }\n  // amount > 0\n  else {\n    // amount of 'wei' in 1 'ether'\n    const baseAmount = ethers.utils\n      .bigNumberify(10)\n      .pow(ethers.utils.bigNumberify(baseDecimals));\n\n    const minimumDisplayAmount = baseAmount.div(\n      ethers.utils\n        .bigNumberify(10)\n        .pow(ethers.utils.bigNumberify(displayDecimals))\n    );\n\n    // if balance is less than the minimum display amount\n    if (amount.lt(minimumDisplayAmount)) {\n      return useLessThan\n        ? `<${ethers.utils.formatUnits(minimumDisplayAmount, baseDecimals)}`\n        : `${ethers.utils.formatUnits(amount, baseDecimals)}`;\n    }\n    // if the balance is greater than the minimum display amount\n    else {\n      const stringAmount = ethers.utils.formatUnits(amount, baseDecimals);\n\n      // if there isn't a decimal portion\n      if (!stringAmount.match(/\\./)) {\n        return stringAmount;\n      }\n      // if there is a decimal portion\n      else {\n        const [wholeComponent, decimalComponent] = stringAmount.split(\".\");\n        const roundedDecimalComponent = ethers.utils\n          .bigNumberify(decimalComponent.padEnd(baseDecimals, \"0\"))\n          .toString()\n          .padStart(baseDecimals, \"0\")\n          .substring(0, displayDecimals);\n\n        // decimals are too small to show\n        if (roundedDecimalComponent === \"0\".repeat(displayDecimals)) {\n          return wholeComponent;\n        }\n        // decimals are not too small to show\n        else {\n          return `${wholeComponent}.${roundedDecimalComponent\n            .toString()\n            .replace(/0*$/, \"\")}`;\n        }\n      }\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}