{"ast":null,"code":"import _slicedToArray from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{createContext,useContext,useReducer,useMemo,useCallback,useEffect}from'react';import{useWeb3Context}from'web3-react';import{safeAccess}from'../utils';var SHOW_BETA_MESSAGE='SHOW_BETA_MESSAGE';var BLOCK_NUMBERS='BLOCK_NUMBERS';var DISMISS_BETA_MESSAGE='DISMISS_BETA_MESSAGE';var UPDATE_BLOCK_NUMBER='UPDATE_BLOCK_NUMBER';var ApplicationContext=createContext();function useApplicationContext(){return useContext(ApplicationContext);}function reducer(state,_ref){var type=_ref.type,payload=_ref.payload;switch(type){case DISMISS_BETA_MESSAGE:{return _objectSpread({},state,_defineProperty({},SHOW_BETA_MESSAGE,false));}case UPDATE_BLOCK_NUMBER:{var networkId=payload.networkId,blockNumber=payload.blockNumber;return _objectSpread({},state,_defineProperty({},BLOCK_NUMBERS,_objectSpread({},safeAccess(state,[BLOCK_NUMBERS])||{},_defineProperty({},networkId,blockNumber))));}default:{throw Error(\"Unexpected action type in ApplicationContext reducer: '\".concat(type,\"'.\"));}}}export default function Provider(_ref2){var _useReducer3;var children=_ref2.children;var _useReducer=useReducer(reducer,(_useReducer3={},_defineProperty(_useReducer3,SHOW_BETA_MESSAGE,true),_defineProperty(_useReducer3,BLOCK_NUMBERS,{}),_useReducer3)),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var dismissBetaMessage=useCallback(function(){dispatch({type:DISMISS_BETA_MESSAGE});},[]);var updateBlockNumber=useCallback(function(networkId,blockNumber){dispatch({type:UPDATE_BLOCK_NUMBER,payload:{networkId:networkId,blockNumber:blockNumber}});},[]);return React.createElement(ApplicationContext.Provider,{value:useMemo(function(){return[state,{dismissBetaMessage:dismissBetaMessage,updateBlockNumber:updateBlockNumber}];},[state,dismissBetaMessage,updateBlockNumber])},children);}export function Updater(){var _useWeb3Context=useWeb3Context(),networkId=_useWeb3Context.networkId,library=_useWeb3Context.library;var _useApplicationContex=useApplicationContext(),_useApplicationContex2=_slicedToArray(_useApplicationContex,2),updateBlockNumber=_useApplicationContex2[1].updateBlockNumber;useEffect(function(){if((networkId||networkId===0)&&library){var update=function update(){library.getBlockNumber().then(function(blockNumber){if(!stale){updateBlockNumber(networkId,blockNumber);}}).catch(function(){if(!stale){updateBlockNumber(networkId,null);}});};var stale=false;update();library.on('block',update);return function(){stale=true;library.removeListener('block',update);};}},[networkId,library,updateBlockNumber]);return null;}export function useBetaMessageManager(){var _useApplicationContex3=useApplicationContext(),_useApplicationContex4=_slicedToArray(_useApplicationContex3,2),state=_useApplicationContex4[0],dismissBetaMessage=_useApplicationContex4[1].dismissBetaMessage;return[safeAccess(state,[SHOW_BETA_MESSAGE]),dismissBetaMessage];}export function useBlockNumber(){var _useWeb3Context2=useWeb3Context(),networkId=_useWeb3Context2.networkId;var _useApplicationContex5=useApplicationContext(),_useApplicationContex6=_slicedToArray(_useApplicationContex5,1),state=_useApplicationContex6[0];return safeAccess(state,[BLOCK_NUMBERS,networkId]);}","map":{"version":3,"sources":["/workspace/uniswap-exchange/src/contexts/Application.js"],"names":["React","createContext","useContext","useReducer","useMemo","useCallback","useEffect","useWeb3Context","safeAccess","SHOW_BETA_MESSAGE","BLOCK_NUMBERS","DISMISS_BETA_MESSAGE","UPDATE_BLOCK_NUMBER","ApplicationContext","useApplicationContext","reducer","state","type","payload","networkId","blockNumber","Error","Provider","children","dispatch","dismissBetaMessage","updateBlockNumber","Updater","library","update","getBlockNumber","then","stale","catch","on","removeListener","useBetaMessageManager","useBlockNumber"],"mappings":"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","sourcesContent":["import React, { createContext, useContext, useReducer, useMemo, useCallback, useEffect } from 'react'\nimport { useWeb3Context } from 'web3-react'\nimport { safeAccess } from '../utils'\n\nconst SHOW_BETA_MESSAGE = 'SHOW_BETA_MESSAGE'\nconst BLOCK_NUMBERS = 'BLOCK_NUMBERS'\n\nconst DISMISS_BETA_MESSAGE = 'DISMISS_BETA_MESSAGE'\nconst UPDATE_BLOCK_NUMBER = 'UPDATE_BLOCK_NUMBER'\n\nconst ApplicationContext = createContext()\n\nfunction useApplicationContext() {\n  return useContext(ApplicationContext)\n}\n\nfunction reducer(state, { type, payload }) {\n  switch (type) {\n    case DISMISS_BETA_MESSAGE: {\n      return {\n        ...state,\n        [SHOW_BETA_MESSAGE]: false\n      }\n    }\n    case UPDATE_BLOCK_NUMBER: {\n      const { networkId, blockNumber } = payload\n      return {\n        ...state,\n        [BLOCK_NUMBERS]: {\n          ...(safeAccess(state, [BLOCK_NUMBERS]) || {}),\n          [networkId]: blockNumber\n        }\n      }\n    }\n    default: {\n      throw Error(`Unexpected action type in ApplicationContext reducer: '${type}'.`)\n    }\n  }\n}\n\nexport default function Provider({ children }) {\n  const [state, dispatch] = useReducer(reducer, {\n    [SHOW_BETA_MESSAGE]: true,\n    [BLOCK_NUMBERS]: {}\n  })\n\n  const dismissBetaMessage = useCallback(() => {\n    dispatch({ type: DISMISS_BETA_MESSAGE })\n  }, [])\n  const updateBlockNumber = useCallback((networkId, blockNumber) => {\n    dispatch({ type: UPDATE_BLOCK_NUMBER, payload: { networkId, blockNumber } })\n  }, [])\n\n  return (\n    <ApplicationContext.Provider\n      value={useMemo(() => [state, { dismissBetaMessage, updateBlockNumber }], [\n        state,\n        dismissBetaMessage,\n        updateBlockNumber\n      ])}\n    >\n      {children}\n    </ApplicationContext.Provider>\n  )\n}\n\nexport function Updater() {\n  const { networkId, library } = useWeb3Context()\n\n  const [, { updateBlockNumber }] = useApplicationContext()\n\n  useEffect(() => {\n    if ((networkId || networkId === 0) && library) {\n      let stale = false\n\n      function update() {\n        library\n          .getBlockNumber()\n          .then(blockNumber => {\n            if (!stale) {\n              updateBlockNumber(networkId, blockNumber)\n            }\n          })\n          .catch(() => {\n            if (!stale) {\n              updateBlockNumber(networkId, null)\n            }\n          })\n      }\n\n      update()\n      library.on('block', update)\n\n      return () => {\n        stale = true\n        library.removeListener('block', update)\n      }\n    }\n  }, [networkId, library, updateBlockNumber])\n\n  return null\n}\n\nexport function useBetaMessageManager() {\n  const [state, { dismissBetaMessage }] = useApplicationContext()\n\n  return [safeAccess(state, [SHOW_BETA_MESSAGE]), dismissBetaMessage]\n}\n\nexport function useBlockNumber() {\n  const { networkId } = useWeb3Context()\n\n  const [state] = useApplicationContext()\n\n  return safeAccess(state, [BLOCK_NUMBERS, networkId])\n}\n"]},"metadata":{},"sourceType":"module"}