{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject6(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  padding: 2rem;\\n\\n  button {\\n    max-width: 20rem;\\n  }\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\\n  font-size: 0.75rem;\\n  color: \",\";\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  color: \",\";\\n  text-align: center;\\n  margin-top: 1rem;\\n  padding-top: 1rem;\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  flex: 1 1 auto;\\n  width: 0;\\n  color: \",\";\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  \",\";\\n  align-items: center;\\n  color: \",\";\\n  font-size: 0.75rem;\\n  padding: 0.25rem 1rem 0;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  \",\";\\n  padding: 1rem 0;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useEffect}from'react';import{withRouter}from'react-router';import{createBrowserHistory}from'history';import{ethers}from'ethers';import styled from'styled-components';import{useTranslation}from'react-i18next';import ReactGA from'react-ga';import{useWeb3React,useFactoryContract}from'../../hooks';import{Button}from'../../theme';import AddressInputPanel from'../../components/AddressInputPanel';import OversizedPanel from'../../components/OversizedPanel';import{useTokenDetails}from'../../contexts/Tokens';import{useTransactionAdder}from'../../contexts/Transactions';var SummaryPanel=styled.div(_templateObject(),function(_ref){var theme=_ref.theme;return theme.flexColumnNoWrap;});var ExchangeRateWrapper=styled.div(_templateObject2(),function(_ref2){var theme=_ref2.theme;return theme.flexRowNoWrap;},function(_ref3){var theme=_ref3.theme;return theme.doveGray;});var ExchangeRate=styled.span(_templateObject3(),function(_ref4){var theme=_ref4.theme;return theme.doveGray;});var CreateExchangeWrapper=styled.div(_templateObject4(),function(_ref5){var theme=_ref5.theme;return theme.doveGray;});var SummaryText=styled.div(_templateObject5(),function(_ref6){var error=_ref6.error,theme=_ref6.theme;return error&&theme.salmonRed;});var Flex=styled.div(_templateObject6());function CreateExchange(_ref7){var location=_ref7.location,params=_ref7.params;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var factory=useFactoryContract();var _useState=useState({address:params.tokenAddress?params.tokenAddress:'',name:''}),_useState2=_slicedToArray(_useState,2),tokenAddress=_useState2[0],setTokenAddress=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),tokenAddressError=_useState4[0],setTokenAddressError=_useState4[1];var _useTokenDetails=useTokenDetails(tokenAddress.address),name=_useTokenDetails.name,symbol=_useTokenDetails.symbol,decimals=_useTokenDetails.decimals,exchangeAddress=_useTokenDetails.exchangeAddress;var addTransaction=useTransactionAdder();// clear url of query\nuseEffect(function(){var history=createBrowserHistory();history.push(window.location.pathname+'');},[]);// validate everything\nvar _useState5=useState(!account&&t('noWallet')),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];useEffect(function(){if(tokenAddressError){setErrorMessage(t('invalidTokenAddress'));}else if(symbol===undefined||decimals===undefined||exchangeAddress===undefined){setErrorMessage();}else if(symbol===null){setErrorMessage(t('invalidSymbol'));}else if(decimals===null){setErrorMessage(t('invalidDecimals'));}else if(exchangeAddress!==ethers.constants.AddressZero){setErrorMessage(t('exchangeExists'));}else if(!account){setErrorMessage(t('noWallet'));}else{setErrorMessage(null);}return function(){setErrorMessage();};},[tokenAddress.address,symbol,decimals,exchangeAddress,account,t,tokenAddressError]);function createExchange(){return _createExchange.apply(this,arguments);}function _createExchange(){_createExchange=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var estimatedGasLimit;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return factory.estimate.createExchange(tokenAddress.address);case 2:estimatedGasLimit=_context.sent;factory.createExchange(tokenAddress.address,{gasLimit:estimatedGasLimit}).then(function(response){ReactGA.event({category:'Transaction',action:'Create Exchange'});addTransaction(response);});case 4:case\"end\":return _context.stop();}}},_callee);}));return _createExchange.apply(this,arguments);}var isValid=errorMessage===null;return React.createElement(React.Fragment,null,React.createElement(AddressInputPanel,{title:t('tokenAddress'),initialInput:params.tokenAddress?{address:params.tokenAddress}:{address:location.state&&location.state.tokenAddress||''},onChange:setTokenAddress,onError:setTokenAddressError}),React.createElement(OversizedPanel,{hideBottom:true},React.createElement(SummaryPanel,null,React.createElement(ExchangeRateWrapper,null,React.createElement(ExchangeRate,null,t('name')),React.createElement(\"span\",null,name?name:' - ')),React.createElement(ExchangeRateWrapper,null,React.createElement(ExchangeRate,null,t('symbol')),React.createElement(\"span\",null,symbol?symbol:' - ')),React.createElement(ExchangeRateWrapper,null,React.createElement(ExchangeRate,null,t('decimals')),React.createElement(\"span\",null,decimals||decimals===0?decimals:' - ')))),React.createElement(CreateExchangeWrapper,null,React.createElement(SummaryText,null,errorMessage?errorMessage:t('enterTokenCont'))),React.createElement(Flex,null,React.createElement(Button,{disabled:!isValid,onClick:createExchange},t('createExchange'))));}export default withRouter(CreateExchange);","map":{"version":3,"sources":["/workspace/uniswap-exchange/src/pages/Pool/CreateExchange.js"],"names":["React","useState","useEffect","withRouter","createBrowserHistory","ethers","styled","useTranslation","ReactGA","useWeb3React","useFactoryContract","Button","AddressInputPanel","OversizedPanel","useTokenDetails","useTransactionAdder","SummaryPanel","div","theme","flexColumnNoWrap","ExchangeRateWrapper","flexRowNoWrap","doveGray","ExchangeRate","span","CreateExchangeWrapper","SummaryText","error","salmonRed","Flex","CreateExchange","location","params","t","account","factory","address","tokenAddress","name","setTokenAddress","tokenAddressError","setTokenAddressError","symbol","decimals","exchangeAddress","addTransaction","history","push","window","pathname","errorMessage","setErrorMessage","undefined","constants","AddressZero","createExchange","estimate","estimatedGasLimit","gasLimit","then","response","event","category","action","isValid","state"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { withRouter } from 'react-router'\nimport { createBrowserHistory } from 'history'\nimport { ethers } from 'ethers'\nimport styled from 'styled-components'\nimport { useTranslation } from 'react-i18next'\nimport ReactGA from 'react-ga'\n\nimport { useWeb3React, useFactoryContract } from '../../hooks'\nimport { Button } from '../../theme'\nimport AddressInputPanel from '../../components/AddressInputPanel'\nimport OversizedPanel from '../../components/OversizedPanel'\nimport { useTokenDetails } from '../../contexts/Tokens'\nimport { useTransactionAdder } from '../../contexts/Transactions'\n\nconst SummaryPanel = styled.div`\n  ${({ theme }) => theme.flexColumnNoWrap};\n  padding: 1rem 0;\n`\n\nconst ExchangeRateWrapper = styled.div`\n  ${({ theme }) => theme.flexRowNoWrap};\n  align-items: center;\n  color: ${({ theme }) => theme.doveGray};\n  font-size: 0.75rem;\n  padding: 0.25rem 1rem 0;\n`\n\nconst ExchangeRate = styled.span`\n  flex: 1 1 auto;\n  width: 0;\n  color: ${({ theme }) => theme.doveGray};\n`\n\nconst CreateExchangeWrapper = styled.div`\n  color: ${({ theme }) => theme.doveGray};\n  text-align: center;\n  margin-top: 1rem;\n  padding-top: 1rem;\n`\n\nconst SummaryText = styled.div`\n  font-size: 0.75rem;\n  color: ${({ error, theme }) => error && theme.salmonRed};\n`\n\nconst Flex = styled.div`\n  display: flex;\n  justify-content: center;\n  padding: 2rem;\n\n  button {\n    max-width: 20rem;\n  }\n`\n\nfunction CreateExchange({ location, params }) {\n  const { t } = useTranslation()\n  const { account } = useWeb3React()\n\n  const factory = useFactoryContract()\n\n  const [tokenAddress, setTokenAddress] = useState({\n    address: params.tokenAddress ? params.tokenAddress : '',\n    name: ''\n  })\n  const [tokenAddressError, setTokenAddressError] = useState()\n\n  const { name, symbol, decimals, exchangeAddress } = useTokenDetails(tokenAddress.address)\n  const addTransaction = useTransactionAdder()\n\n  // clear url of query\n  useEffect(() => {\n    const history = createBrowserHistory()\n    history.push(window.location.pathname + '')\n  }, [])\n\n  // validate everything\n  const [errorMessage, setErrorMessage] = useState(!account && t('noWallet'))\n  useEffect(() => {\n    if (tokenAddressError) {\n      setErrorMessage(t('invalidTokenAddress'))\n    } else if (symbol === undefined || decimals === undefined || exchangeAddress === undefined) {\n      setErrorMessage()\n    } else if (symbol === null) {\n      setErrorMessage(t('invalidSymbol'))\n    } else if (decimals === null) {\n      setErrorMessage(t('invalidDecimals'))\n    } else if (exchangeAddress !== ethers.constants.AddressZero) {\n      setErrorMessage(t('exchangeExists'))\n    } else if (!account) {\n      setErrorMessage(t('noWallet'))\n    } else {\n      setErrorMessage(null)\n    }\n\n    return () => {\n      setErrorMessage()\n    }\n  }, [tokenAddress.address, symbol, decimals, exchangeAddress, account, t, tokenAddressError])\n\n  async function createExchange() {\n    const estimatedGasLimit = await factory.estimate.createExchange(tokenAddress.address)\n\n    factory.createExchange(tokenAddress.address, { gasLimit: estimatedGasLimit }).then(response => {\n      ReactGA.event({\n        category: 'Transaction',\n        action: 'Create Exchange'\n      })\n\n      addTransaction(response)\n    })\n  }\n\n  const isValid = errorMessage === null\n\n  return (\n    <>\n      <AddressInputPanel\n        title={t('tokenAddress')}\n        initialInput={\n          params.tokenAddress\n            ? { address: params.tokenAddress }\n            : { address: (location.state && location.state.tokenAddress) || '' }\n        }\n        onChange={setTokenAddress}\n        onError={setTokenAddressError}\n      />\n      <OversizedPanel hideBottom>\n        <SummaryPanel>\n          <ExchangeRateWrapper>\n            <ExchangeRate>{t('name')}</ExchangeRate>\n            <span>{name ? name : ' - '}</span>\n          </ExchangeRateWrapper>\n          <ExchangeRateWrapper>\n            <ExchangeRate>{t('symbol')}</ExchangeRate>\n            <span>{symbol ? symbol : ' - '}</span>\n          </ExchangeRateWrapper>\n          <ExchangeRateWrapper>\n            <ExchangeRate>{t('decimals')}</ExchangeRate>\n            <span>{decimals || decimals === 0 ? decimals : ' - '}</span>\n          </ExchangeRateWrapper>\n        </SummaryPanel>\n      </OversizedPanel>\n      <CreateExchangeWrapper>\n        <SummaryText>{errorMessage ? errorMessage : t('enterTokenCont')}</SummaryText>\n      </CreateExchangeWrapper>\n      <Flex>\n        <Button disabled={!isValid} onClick={createExchange}>\n          {t('createExchange')}\n        </Button>\n      </Flex>\n    </>\n  )\n}\n\nexport default withRouter(CreateExchange)\n"]},"metadata":{},"sourceType":"module"}