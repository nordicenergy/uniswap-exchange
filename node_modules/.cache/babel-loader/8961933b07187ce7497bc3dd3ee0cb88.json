{"ast":null,"code":"var urilib = require('url');\n\nvar helpers = require('./helpers');\n\nmodule.exports.SchemaScanResult = SchemaScanResult;\n\nfunction SchemaScanResult(found, ref) {\n  this.id = found;\n  this.ref = ref;\n}\n/**\n * Adds a schema with a certain urn to the Validator instance.\n * @param string uri\n * @param object schema\n * @return {Object}\n */\n\n\nmodule.exports.scan = function scan(base, schema) {\n  function scanSchema(baseuri, schema) {\n    if (!schema || typeof schema != 'object') return; // Mark all referenced schemas so we can tell later which schemas are referred to, but never defined\n\n    if (schema.$ref) {\n      var resolvedUri = urilib.resolve(baseuri, schema.$ref);\n      ref[resolvedUri] = ref[resolvedUri] ? ref[resolvedUri] + 1 : 0;\n      return;\n    }\n\n    var ourBase = schema.id ? urilib.resolve(baseuri, schema.id) : baseuri;\n\n    if (ourBase) {\n      // If there's no fragment, append an empty one\n      if (ourBase.indexOf('#') < 0) ourBase += '#';\n\n      if (found[ourBase]) {\n        if (!helpers.deepCompareStrict(found[ourBase], schema)) {\n          throw new Error('Schema <' + schema + '> already exists with different definition');\n        }\n\n        return found[ourBase];\n      }\n\n      found[ourBase] = schema; // strip trailing fragment\n\n      if (ourBase[ourBase.length - 1] == '#') {\n        found[ourBase.substring(0, ourBase.length - 1)] = schema;\n      }\n    }\n\n    scanArray(ourBase + '/items', schema.items instanceof Array ? schema.items : [schema.items]);\n    scanArray(ourBase + '/extends', schema.extends instanceof Array ? schema.extends : [schema.extends]);\n    scanSchema(ourBase + '/additionalItems', schema.additionalItems);\n    scanObject(ourBase + '/properties', schema.properties);\n    scanSchema(ourBase + '/additionalProperties', schema.additionalProperties);\n    scanObject(ourBase + '/definitions', schema.definitions);\n    scanObject(ourBase + '/patternProperties', schema.patternProperties);\n    scanObject(ourBase + '/dependencies', schema.dependencies);\n    scanArray(ourBase + '/disallow', schema.disallow);\n    scanArray(ourBase + '/allOf', schema.allOf);\n    scanArray(ourBase + '/anyOf', schema.anyOf);\n    scanArray(ourBase + '/oneOf', schema.oneOf);\n    scanSchema(ourBase + '/not', schema.not);\n  }\n\n  function scanArray(baseuri, schemas) {\n    if (!(schemas instanceof Array)) return;\n\n    for (var i = 0; i < schemas.length; i++) {\n      scanSchema(baseuri + '/' + i, schemas[i]);\n    }\n  }\n\n  function scanObject(baseuri, schemas) {\n    if (!schemas || typeof schemas != 'object') return;\n\n    for (var p in schemas) {\n      scanSchema(baseuri + '/' + p, schemas[p]);\n    }\n  }\n\n  var found = {};\n  var ref = {};\n  var schemaUri = base;\n  scanSchema(base, schema);\n  return new SchemaScanResult(found, ref);\n};","map":{"version":3,"sources":["/workspace/uniswap-exchange/node_modules/jsonschema/lib/scan.js"],"names":["urilib","require","helpers","module","exports","SchemaScanResult","found","ref","id","scan","base","schema","scanSchema","baseuri","$ref","resolvedUri","resolve","ourBase","indexOf","deepCompareStrict","Error","length","substring","scanArray","items","Array","extends","additionalItems","scanObject","properties","additionalProperties","definitions","patternProperties","dependencies","disallow","allOf","anyOf","oneOf","not","schemas","i","p","schemaUri"],"mappings":"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","sourcesContent":["\nvar urilib = require('url');\nvar helpers = require('./helpers');\n\nmodule.exports.SchemaScanResult = SchemaScanResult;\nfunction SchemaScanResult(found, ref){\n  this.id = found;\n  this.ref = ref;\n}\n\n/**\n * Adds a schema with a certain urn to the Validator instance.\n * @param string uri\n * @param object schema\n * @return {Object}\n */\nmodule.exports.scan = function scan(base, schema){\n  function scanSchema(baseuri, schema){\n    if(!schema || typeof schema!='object') return;\n    // Mark all referenced schemas so we can tell later which schemas are referred to, but never defined\n    if(schema.$ref){\n      var resolvedUri = urilib.resolve(baseuri, schema.$ref);\n      ref[resolvedUri] = ref[resolvedUri] ? ref[resolvedUri]+1 : 0;\n      return;\n    }\n    var ourBase = schema.id ? urilib.resolve(baseuri, schema.id) : baseuri;\n    if (ourBase) {\n      // If there's no fragment, append an empty one\n      if(ourBase.indexOf('#')<0) ourBase += '#';\n      if(found[ourBase]){\n        if(!helpers.deepCompareStrict(found[ourBase], schema)){\n          throw new Error('Schema <'+schema+'> already exists with different definition');\n        }\n        return found[ourBase];\n      }\n      found[ourBase] = schema;\n      // strip trailing fragment\n      if(ourBase[ourBase.length-1]=='#'){\n        found[ourBase.substring(0, ourBase.length-1)] = schema;\n      }\n    }\n    scanArray(ourBase+'/items', ((schema.items instanceof Array)?schema.items:[schema.items]));\n    scanArray(ourBase+'/extends', ((schema.extends instanceof Array)?schema.extends:[schema.extends]));\n    scanSchema(ourBase+'/additionalItems', schema.additionalItems);\n    scanObject(ourBase+'/properties', schema.properties);\n    scanSchema(ourBase+'/additionalProperties', schema.additionalProperties);\n    scanObject(ourBase+'/definitions', schema.definitions);\n    scanObject(ourBase+'/patternProperties', schema.patternProperties);\n    scanObject(ourBase+'/dependencies', schema.dependencies);\n    scanArray(ourBase+'/disallow', schema.disallow);\n    scanArray(ourBase+'/allOf', schema.allOf);\n    scanArray(ourBase+'/anyOf', schema.anyOf);\n    scanArray(ourBase+'/oneOf', schema.oneOf);\n    scanSchema(ourBase+'/not', schema.not);\n  }\n  function scanArray(baseuri, schemas){\n    if(!(schemas instanceof Array)) return;\n    for(var i=0; i<schemas.length; i++){\n      scanSchema(baseuri+'/'+i, schemas[i]);\n    }\n  }\n  function scanObject(baseuri, schemas){\n    if(!schemas || typeof schemas!='object') return;\n    for(var p in schemas){\n      scanSchema(baseuri+'/'+p, schemas[p]);\n    }\n  }\n\n  var found = {};\n  var ref = {};\n  var schemaUri = base;\n  scanSchema(base, schema);\n  return new SchemaScanResult(found, ref);\n}\n"]},"metadata":{},"sourceType":"script"}