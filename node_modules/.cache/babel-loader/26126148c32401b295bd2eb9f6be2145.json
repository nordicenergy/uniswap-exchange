{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _taggedTemplateLiteral from\"/workspace/uniswap-exchange/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject10(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  padding: 2rem;\\n\\n  button {\\n    max-width: 20rem;\\n  }\\n\"]);_templateObject10=function _templateObject10(){return data;};return data;}function _templateObject9(){var data=_taggedTemplateLiteral([\"\\n  flex: 1 1 auto;\\n  width: 0;\\n  color: \",\";\\n\"]);_templateObject9=function _templateObject9(){return data;};return data;}function _templateObject8(){var data=_taggedTemplateLiteral([\"\\n  \",\";\\n  align-items: center;\\n  color: \",\";\\n  font-size: 0.75rem;\\n  padding: 0.25rem 1rem 0;\\n\"]);_templateObject8=function _templateObject8(){return data;};return data;}function _templateObject7(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  padding: 1rem 0;\\n\"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=_taggedTemplateLiteral([\"\\n  width: 0.625rem;\\n  height: 0.625rem;\\n  position: relative;\\n  padding: 0.875rem;\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  justify-content: center;\\n  align-items: center;\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  margin-top: 1rem;\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  font-size: 0.75rem;\\n  line-height: 1rem;\\n  text-align: center;\\n\\n  :first-child {\\n    padding-bottom: 0.3rem;\\n    font-weight: 500;\\n  }\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  margin-top: 1rem;\\n  padding: 1rem;\\n  margin-bottom: 2rem;\\n  border: 1px solid rgba($pizazz-orange, 0.4);\\n  background-color: rgba($pizazz-orange, 0.1);\\n  border-radius: 1rem;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  color: \",\";\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useReducer,useState,useCallback,useEffect,useMemo}from'react';import{useTranslation}from'react-i18next';import{useWeb3Context}from'web3-react';import{ethers}from'ethers';import ReactGA from'react-ga';import styled from'styled-components';import{Button}from'../../theme';import CurrencyInputPanel from'../../components/CurrencyInputPanel';import OversizedPanel from'../../components/OversizedPanel';import ContextualInfo from'../../components/ContextualInfo';import PlusBlue from\"../../assets/images/plus-blue.svg\";import PlusGrey from\"../../assets/images/plus-grey.svg\";import{useExchangeContract}from'../../hooks';import{amountFormatter,calculateGasMargin}from'../../utils';import{useTransactionAdder}from'../../contexts/Transactions';import{useTokenDetails}from'../../contexts/Tokens';import{useAddressBalance,useExchangeReserves}from'../../contexts/Balances';import{useAddressAllowance}from'../../contexts/Allowances';var INPUT=0;var OUTPUT=1;// denominated in bips\nvar ALLOWED_SLIPPAGE=ethers.utils.bigNumberify(200);// denominated in seconds\nvar DEADLINE_FROM_NOW=60*15;// denominated in bips\nvar GAS_MARGIN=ethers.utils.bigNumberify(1000);var BlueSpan=styled.span(_templateObject(),function(_ref){var theme=_ref.theme;return theme.royalBlue;});var NewExchangeWarning=styled.div(_templateObject2());var NewExchangeWarningText=styled.div(_templateObject3());var LastSummaryText=styled.div(_templateObject4());var DownArrowBackground=styled.div(_templateObject5(),function(_ref2){var theme=_ref2.theme;return theme.flexRowNoWrap;});var DownArrow=styled.img(_templateObject6());var SummaryPanel=styled.div(_templateObject7(),function(_ref3){var theme=_ref3.theme;return theme.flexColumnNoWrap;});var ExchangeRateWrapper=styled.div(_templateObject8(),function(_ref4){var theme=_ref4.theme;return theme.flexRowNoWrap;},function(_ref5){var theme=_ref5.theme;return theme.doveGray;});var ExchangeRate=styled.span(_templateObject9(),function(_ref6){var theme=_ref6.theme;return theme.chaliceGray;});var Flex=styled.div(_templateObject10());function calculateSlippageBounds(value){if(value){var offset=value.mul(ALLOWED_SLIPPAGE).div(ethers.utils.bigNumberify(10000));var minimum=value.sub(offset);var maximum=value.add(offset);return{minimum:minimum.lt(ethers.constants.Zero)?ethers.constants.Zero:minimum,maximum:maximum.gt(ethers.constants.MaxUint256)?ethers.constants.MaxUint256:maximum};}else{return{};}}var initialAddLiquidityState={inputValue:'',outputValue:'',lastEditedField:INPUT,outputCurrency:''};function addLiquidityStateReducer(state,action){switch(action.type){case'SELECT_CURRENCY':{return _objectSpread({},state,{outputCurrency:action.payload});}case'UPDATE_VALUE':{var inputValue=state.inputValue,outputValue=state.outputValue;var _action$payload=action.payload,field=_action$payload.field,value=_action$payload.value;return _objectSpread({},state,{inputValue:field===INPUT?value:inputValue,outputValue:field===OUTPUT?value:outputValue,lastEditedField:field});}case'UPDATE_DEPENDENT_VALUE':{var _inputValue=state.inputValue,_outputValue=state.outputValue;var _action$payload2=action.payload,_field=_action$payload2.field,_value=_action$payload2.value;return _objectSpread({},state,{inputValue:_field===INPUT?_value:_inputValue,outputValue:_field===OUTPUT?_value:_outputValue});}default:{return initialAddLiquidityState;}}}function getExchangeRate(inputValue,inputDecimals,outputValue,outputDecimals){var invert=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;try{if(inputValue&&(inputDecimals||inputDecimals===0)&&outputValue&&(outputDecimals||outputDecimals===0)){var factor=ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18));if(invert){return inputValue.mul(factor).div(outputValue).mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(outputDecimals))).div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(inputDecimals)));}else{return outputValue.mul(factor).div(inputValue).mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(inputDecimals))).div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(outputDecimals)));}}}catch(_unused){}}function getMarketRate(reserveETH,reserveToken,decimals){var invert=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;return getExchangeRate(reserveETH,18,reserveToken,decimals,invert);}export default function AddLiquidity(){var _useTranslation=useTranslation(),t=_useTranslation.t;var _useWeb3Context=useWeb3Context(),library=_useWeb3Context.library,active=_useWeb3Context.active,account=_useWeb3Context.account;var _useReducer=useReducer(addLiquidityStateReducer,initialAddLiquidityState),_useReducer2=_slicedToArray(_useReducer,2),addLiquidityState=_useReducer2[0],dispatchAddLiquidityState=_useReducer2[1];var inputValue=addLiquidityState.inputValue,outputValue=addLiquidityState.outputValue,lastEditedField=addLiquidityState.lastEditedField,outputCurrency=addLiquidityState.outputCurrency;var inputCurrency='ETH';var _useState=useState(),_useState2=_slicedToArray(_useState,2),inputValueParsed=_useState2[0],setInputValueParsed=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),outputValueParsed=_useState4[0],setOutputValueParsed=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),inputError=_useState6[0],setInputError=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),outputError=_useState8[0],setOutputError=_useState8[1];var _useTokenDetails=useTokenDetails(outputCurrency),symbol=_useTokenDetails.symbol,decimals=_useTokenDetails.decimals,exchangeAddress=_useTokenDetails.exchangeAddress;var exchangeContract=useExchangeContract(exchangeAddress);var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),totalPoolTokens=_useState10[0],setTotalPoolTokens=_useState10[1];var fetchPoolTokens=useCallback(function(){if(exchangeContract){exchangeContract.totalSupply().then(function(totalSupply){setTotalPoolTokens(totalSupply);});}},[exchangeContract]);useEffect(function(){fetchPoolTokens();library.on('block',fetchPoolTokens);return function(){library.removeListener('block',fetchPoolTokens);};},[fetchPoolTokens,library]);var poolTokenBalance=useAddressBalance(account,exchangeAddress);var exchangeETHBalance=useAddressBalance(exchangeAddress,'ETH');var exchangeTokenBalance=useAddressBalance(exchangeAddress,outputCurrency);var _useExchangeReserves=useExchangeReserves(outputCurrency),reserveETH=_useExchangeReserves.reserveETH,reserveToken=_useExchangeReserves.reserveToken;var isNewExchange=!!(reserveETH&&reserveToken&&reserveETH.isZero()&&reserveToken.isZero());// 18 decimals\nvar poolTokenPercentage=poolTokenBalance&&totalPoolTokens&&isNewExchange===false&&!totalPoolTokens.isZero()?poolTokenBalance.mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(totalPoolTokens):undefined;var ethShare=exchangeETHBalance&&poolTokenPercentage?exchangeETHBalance.mul(poolTokenPercentage).div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))):undefined;var tokenShare=exchangeTokenBalance&&poolTokenPercentage?exchangeTokenBalance.mul(poolTokenPercentage).div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))):undefined;var liquidityMinted=isNewExchange?inputValueParsed:totalPoolTokens&&inputValueParsed&&exchangeETHBalance&&!exchangeETHBalance.isZero()?totalPoolTokens.mul(inputValueParsed).div(exchangeETHBalance):undefined;// user balances\nvar inputBalance=useAddressBalance(account,inputCurrency);var outputBalance=useAddressBalance(account,outputCurrency);var ethPerLiquidityToken=exchangeETHBalance&&totalPoolTokens&&isNewExchange===false&&!totalPoolTokens.isZero()?exchangeETHBalance.mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(totalPoolTokens):undefined;var tokenPerLiquidityToken=exchangeTokenBalance&&totalPoolTokens&&isNewExchange===false&&!totalPoolTokens.isZero()?exchangeTokenBalance.mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(totalPoolTokens):undefined;var outputValueMax=outputValueParsed&&calculateSlippageBounds(outputValueParsed).maximum;var liquidityTokensMin=liquidityMinted&&calculateSlippageBounds(liquidityMinted).minimum;var marketRate=useMemo(function(){return getMarketRate(reserveETH,reserveToken,decimals);},[reserveETH,reserveToken,decimals]);var marketRateInverted=useMemo(function(){return getMarketRate(reserveETH,reserveToken,decimals,true);},[reserveETH,reserveToken,decimals]);function renderTransactionDetails(){ReactGA.event({category:'TransactionDetail',action:'Open'});var b=function b(text){return React.createElement(BlueSpan,null,text);};if(isNewExchange){return React.createElement(\"div\",null,React.createElement(\"div\",null,t('youAreAdding'),\" \",b(\"\".concat(inputValue,\" ETH\")),\" \",t('and'),\" \",b(\"\".concat(outputValue,\" \").concat(symbol)),\" \",t('intoPool')),React.createElement(LastSummaryText,null,t('youAreSettingExRate'),' ',b(\"1 ETH = \".concat(amountFormatter(getMarketRate(inputValueParsed,outputValueParsed,decimals),18,4,false),\" \").concat(symbol)),\".\"),React.createElement(LastSummaryText,null,t('youWillMint'),\" \",b(\"\".concat(inputValue)),\" \",t('liquidityTokens')),React.createElement(LastSummaryText,null,t('totalSupplyIs0')));}else{return React.createElement(React.Fragment,null,React.createElement(\"div\",null,t('youAreAdding'),\" \",b(\"\".concat(amountFormatter(inputValueParsed,18,4),\" ETH\")),\" \",t('and'),\" \",'at most',' ',b(\"\".concat(amountFormatter(outputValueMax,decimals,4),\" \").concat(symbol)),\" \",t('intoPool')),React.createElement(LastSummaryText,null,t('youWillMint'),\" \",b(amountFormatter(liquidityMinted,18,4)),\" \",t('liquidityTokens')),React.createElement(LastSummaryText,null,t('totalSupplyIs'),\" \",b(amountFormatter(totalPoolTokens,18,4))),React.createElement(LastSummaryText,null,t('tokenWorth'),\" \",b(amountFormatter(ethPerLiquidityToken,18,4)),\" ETH \",t('and'),' ',b(amountFormatter(tokenPerLiquidityToken,decimals,Math.min(decimals,4))),\" \",symbol));}}function renderSummary(){var contextualInfo='';var isError=false;if(inputError||outputError){contextualInfo=inputError||outputError;isError=true;}else if(!inputCurrency||!outputCurrency){contextualInfo=t('selectTokenCont');}else if(!inputValue){contextualInfo=t('enterValueCont');}else if(!account){contextualInfo=t('noWallet');isError=true;}return React.createElement(ContextualInfo,{openDetailsText:t('transactionDetails'),closeDetailsText:t('hideDetails'),contextualInfo:contextualInfo,isError:isError,renderTransactionDetails:renderTransactionDetails});}var addTransaction=useTransactionAdder();var isActive=active&&account;var isValid=inputError===null||outputError===null;function onAddLiquidity(){return _onAddLiquidity.apply(this,arguments);}function _onAddLiquidity(){_onAddLiquidity=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var deadline,estimatedGasLimit;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:ReactGA.event({category:'Pool',action:'AddLiquidity'});deadline=Math.ceil(Date.now()/1000)+DEADLINE_FROM_NOW;_context.next=4;return exchangeContract.estimate.addLiquidity(isNewExchange?ethers.constants.Zero:liquidityTokensMin,isNewExchange?outputValueParsed:outputValueMax,deadline,{value:inputValueParsed});case 4:estimatedGasLimit=_context.sent;exchangeContract.addLiquidity(isNewExchange?ethers.constants.Zero:liquidityTokensMin,isNewExchange?outputValueParsed:outputValueMax,deadline,{value:inputValueParsed,gasLimit:calculateGasMargin(estimatedGasLimit,GAS_MARGIN)}).then(function(response){addTransaction(response);});case 6:case\"end\":return _context.stop();}}},_callee);}));return _onAddLiquidity.apply(this,arguments);}function formatBalance(value){return\"Balance: \".concat(value);}useEffect(function(){if(isNewExchange){if(inputValue){var parsedInputValue=ethers.utils.parseUnits(inputValue,18);setInputValueParsed(parsedInputValue);}if(outputValue){var parsedOutputValue=ethers.utils.parseUnits(outputValue,decimals);setOutputValueParsed(parsedOutputValue);}}},[decimals,inputValue,isNewExchange,outputValue]);// parse input value\nuseEffect(function(){if(isNewExchange===false&&inputValue&&marketRate&&lastEditedField===INPUT&&decimals){try{var parsedValue=ethers.utils.parseUnits(inputValue,18);if(parsedValue.lte(ethers.constants.Zero)||parsedValue.gte(ethers.constants.MaxUint256)){throw Error();}setInputValueParsed(parsedValue);var currencyAmount=marketRate.mul(parsedValue).div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18-decimals)));setOutputValueParsed(currencyAmount);dispatchAddLiquidityState({type:'UPDATE_DEPENDENT_VALUE',payload:{field:OUTPUT,value:amountFormatter(currencyAmount,decimals,4,false)}});return function(){setOutputError();setInputValueParsed();setOutputValueParsed();dispatchAddLiquidityState({type:'UPDATE_DEPENDENT_VALUE',payload:{field:OUTPUT,value:''}});};}catch(_unused2){setOutputError(t('inputNotValid'));}}},[inputValue,isNewExchange,lastEditedField,marketRate,decimals,t]);// parse output value\nuseEffect(function(){if(isNewExchange===false&&outputValue&&marketRateInverted&&lastEditedField===OUTPUT&&decimals){try{var parsedValue=ethers.utils.parseUnits(outputValue,decimals);if(parsedValue.lte(ethers.constants.Zero)||parsedValue.gte(ethers.constants.MaxUint256)){throw Error();}setOutputValueParsed(parsedValue);var currencyAmount=marketRateInverted.mul(parsedValue).div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(decimals)));setInputValueParsed(currencyAmount);dispatchAddLiquidityState({type:'UPDATE_DEPENDENT_VALUE',payload:{field:INPUT,value:amountFormatter(currencyAmount,18,4,false)}});return function(){setInputError();setOutputValueParsed();setInputValueParsed();dispatchAddLiquidityState({type:'UPDATE_DEPENDENT_VALUE',payload:{field:INPUT,value:''}});};}catch(_unused3){setInputError(t('inputNotValid'));}}},[outputValue,isNewExchange,lastEditedField,marketRateInverted,decimals,t]);// input validation\nuseEffect(function(){if(inputValueParsed&&inputBalance){if(inputValueParsed.gt(inputBalance)){setInputError(t('insufficientBalance'));}else{setInputError(null);}}if(outputValueMax&&outputBalance){if(outputValueMax.gt(outputBalance)){setOutputError(t('insufficientBalance'));}else{setOutputError(null);}}},[inputValueParsed,inputBalance,outputValueMax,outputBalance,t]);var allowance=useAddressAllowance(account,outputCurrency,exchangeAddress);var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showUnlock=_useState12[0],setShowUnlock=_useState12[1];useEffect(function(){if(outputValueParsed&&allowance){if(allowance.lt(outputValueParsed)){setOutputError(t('unlockTokenCont'));setShowUnlock(true);}return function(){setOutputError();setShowUnlock(false);};}},[outputValueParsed,allowance,t]);return React.createElement(React.Fragment,null,isNewExchange?React.createElement(NewExchangeWarning,null,React.createElement(NewExchangeWarningText,null,React.createElement(\"span\",{role:\"img\",\"aria-label\":\"first-liquidity\"},\"\\uD83D\\uDEB0\"),' ',t('firstLiquidity')),React.createElement(NewExchangeWarningText,null,t('initialExchangeRate',{symbol:symbol}))):null,React.createElement(CurrencyInputPanel,{title:t('deposit'),extraText:inputBalance&&formatBalance(amountFormatter(inputBalance,18,4)),onValueChange:function onValueChange(inputValue){dispatchAddLiquidityState({type:'UPDATE_VALUE',payload:{value:inputValue,field:INPUT}});},selectedTokenAddress:\"ETH\",value:inputValue,errorMessage:inputError,disableTokenSelect:true}),React.createElement(OversizedPanel,null,React.createElement(DownArrowBackground,null,React.createElement(DownArrow,{src:isActive?PlusBlue:PlusGrey,alt:\"plus\"}))),React.createElement(CurrencyInputPanel,{title:t('deposit'),description:isNewExchange?'':outputValue?\"(\".concat(t('estimated'),\")\"):'',extraText:outputBalance&&formatBalance(amountFormatter(outputBalance,decimals,Math.min(decimals,4))),selectedTokenAddress:outputCurrency,onCurrencySelected:function onCurrencySelected(outputCurrency){dispatchAddLiquidityState({type:'SELECT_CURRENCY',payload:outputCurrency});},onValueChange:function onValueChange(outputValue){dispatchAddLiquidityState({type:'UPDATE_VALUE',payload:{value:outputValue,field:OUTPUT}});},value:outputValue,showUnlock:showUnlock,errorMessage:outputError}),React.createElement(OversizedPanel,{hideBottom:true},React.createElement(SummaryPanel,null,React.createElement(ExchangeRateWrapper,null,React.createElement(ExchangeRate,null,t('exchangeRate')),React.createElement(\"span\",null,marketRate?\"1 ETH = \".concat(amountFormatter(marketRate,18,4),\" \").concat(symbol):' - ')),React.createElement(ExchangeRateWrapper,null,React.createElement(ExchangeRate,null,t('currentPoolSize')),React.createElement(\"span\",null,exchangeETHBalance&&exchangeTokenBalance?\"\".concat(amountFormatter(exchangeETHBalance,18,4),\" ETH + \").concat(amountFormatter(exchangeTokenBalance,decimals,Math.min(4,decimals)),\" \").concat(symbol):' - ')),React.createElement(ExchangeRateWrapper,null,React.createElement(ExchangeRate,null,t('yourPoolShare'),\" (\",exchangeETHBalance&&amountFormatter(poolTokenPercentage,16,2),\"%)\"),React.createElement(\"span\",null,ethShare&&tokenShare?\"\".concat(amountFormatter(ethShare,18,4),\" ETH + \").concat(amountFormatter(tokenShare,decimals,Math.min(4,decimals)),\" \").concat(symbol):' - ')))),renderSummary(),React.createElement(Flex,null,React.createElement(Button,{disabled:!isValid,onClick:onAddLiquidity},t('addLiquidity'))));}","map":{"version":3,"sources":["/workspace/uniswap-exchange/src/pages/Pool/AddLiquidity.js"],"names":["React","useReducer","useState","useCallback","useEffect","useMemo","useTranslation","useWeb3Context","ethers","ReactGA","styled","Button","CurrencyInputPanel","OversizedPanel","ContextualInfo","useExchangeContract","amountFormatter","calculateGasMargin","useTransactionAdder","useTokenDetails","useAddressBalance","useExchangeReserves","useAddressAllowance","INPUT","OUTPUT","ALLOWED_SLIPPAGE","utils","bigNumberify","DEADLINE_FROM_NOW","GAS_MARGIN","BlueSpan","span","theme","royalBlue","NewExchangeWarning","div","NewExchangeWarningText","LastSummaryText","DownArrowBackground","flexRowNoWrap","DownArrow","img","SummaryPanel","flexColumnNoWrap","ExchangeRateWrapper","doveGray","ExchangeRate","chaliceGray","Flex","calculateSlippageBounds","value","offset","mul","minimum","sub","maximum","add","lt","constants","Zero","gt","MaxUint256","initialAddLiquidityState","inputValue","outputValue","lastEditedField","outputCurrency","addLiquidityStateReducer","state","action","type","payload","field","getExchangeRate","inputDecimals","outputDecimals","invert","factor","pow","getMarketRate","reserveETH","reserveToken","decimals","AddLiquidity","t","library","active","account","addLiquidityState","dispatchAddLiquidityState","inputCurrency","inputValueParsed","setInputValueParsed","outputValueParsed","setOutputValueParsed","inputError","setInputError","outputError","setOutputError","symbol","exchangeAddress","exchangeContract","totalPoolTokens","setTotalPoolTokens","fetchPoolTokens","totalSupply","then","on","removeListener","poolTokenBalance","exchangeETHBalance","exchangeTokenBalance","isNewExchange","isZero","poolTokenPercentage","undefined","ethShare","tokenShare","liquidityMinted","inputBalance","outputBalance","ethPerLiquidityToken","tokenPerLiquidityToken","outputValueMax","liquidityTokensMin","marketRate","marketRateInverted","renderTransactionDetails","event","category","b","text","Math","min","renderSummary","contextualInfo","isError","addTransaction","isActive","isValid","onAddLiquidity","deadline","ceil","Date","now","estimate","addLiquidity","estimatedGasLimit","gasLimit","response","formatBalance","parsedInputValue","parseUnits","parsedOutputValue","parsedValue","lte","gte","Error","currencyAmount","allowance","showUnlock","setShowUnlock","PlusBlue","PlusGrey"],"mappings":"6rFAAA,MAAOA,CAAAA,KAAP,EAAgBC,UAAhB,CAA4BC,QAA5B,CAAsCC,WAAtC,CAAmDC,SAAnD,CAA8DC,OAA9D,KAA6E,OAA7E,CACA,OAASC,cAAT,KAA+B,eAA/B,CACA,OAASC,cAAT,KAA+B,YAA/B,CACA,OAASC,MAAT,KAAuB,QAAvB,CACA,MAAOC,CAAAA,OAAP,KAAoB,UAApB,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CAEA,OAASC,MAAT,KAAuB,aAAvB,CACA,MAAOC,CAAAA,kBAAP,KAA+B,qCAA/B,CACA,MAAOC,CAAAA,cAAP,KAA2B,iCAA3B,CACA,MAAOC,CAAAA,cAAP,KAA2B,iCAA3B,C,gHAGA,OAASC,mBAAT,KAAoC,aAApC,CACA,OAASC,eAAT,CAA0BC,kBAA1B,KAAoD,aAApD,CACA,OAASC,mBAAT,KAAoC,6BAApC,CACA,OAASC,eAAT,KAAgC,uBAAhC,CACA,OAASC,iBAAT,CAA4BC,mBAA5B,KAAuD,yBAAvD,CACA,OAASC,mBAAT,KAAoC,2BAApC,CAEA,GAAMC,CAAAA,KAAK,CAAG,CAAd,CACA,GAAMC,CAAAA,MAAM,CAAG,CAAf,CAEA;AACA,GAAMC,CAAAA,gBAAgB,CAAGjB,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,GAA1B,CAAzB,CAEA;AACA,GAAMC,CAAAA,iBAAiB,CAAG,GAAK,EAA/B,CAEA;AACA,GAAMC,CAAAA,UAAU,CAAGrB,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,IAA1B,CAAnB,CAEA,GAAMG,CAAAA,QAAQ,CAAGpB,MAAM,CAACqB,IAAV,mBACH,kBAAGC,CAAAA,KAAH,MAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACC,SAArB,EADG,CAAd,CAIA,GAAMC,CAAAA,kBAAkB,CAAGxB,MAAM,CAACyB,GAAV,oBAAxB,CASA,GAAMC,CAAAA,sBAAsB,CAAG1B,MAAM,CAACyB,GAAV,oBAA5B,CAWA,GAAME,CAAAA,eAAe,CAAG3B,MAAM,CAACyB,GAAV,oBAArB,CAIA,GAAMG,CAAAA,mBAAmB,CAAG5B,MAAM,CAACyB,GAAV,oBACrB,mBAAGH,CAAAA,KAAH,OAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACO,aAArB,EADqB,CAAzB,CAMA,GAAMC,CAAAA,SAAS,CAAG9B,MAAM,CAAC+B,GAAV,oBAAf,CAOA,GAAMC,CAAAA,YAAY,CAAGhC,MAAM,CAACyB,GAAV,oBACd,mBAAGH,CAAAA,KAAH,OAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACW,gBAArB,EADc,CAAlB,CAKA,GAAMC,CAAAA,mBAAmB,CAAGlC,MAAM,CAACyB,GAAV,oBACrB,mBAAGH,CAAAA,KAAH,OAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACO,aAArB,EADqB,CAGd,mBAAGP,CAAAA,KAAH,OAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACa,QAArB,EAHc,CAAzB,CAQA,GAAMC,CAAAA,YAAY,CAAGpC,MAAM,CAACqB,IAAV,oBAGP,mBAAGC,CAAAA,KAAH,OAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACe,WAArB,EAHO,CAAlB,CAMA,GAAMC,CAAAA,IAAI,CAAGtC,MAAM,CAACyB,GAAV,qBAAV,CAUA,QAASc,CAAAA,uBAAT,CAAiCC,KAAjC,CAAwC,CACtC,GAAIA,KAAJ,CAAW,CACT,GAAMC,CAAAA,MAAM,CAAGD,KAAK,CAACE,GAAN,CAAU3B,gBAAV,EAA4BU,GAA5B,CAAgC3B,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,KAA1B,CAAhC,CAAf,CACA,GAAM0B,CAAAA,OAAO,CAAGH,KAAK,CAACI,GAAN,CAAUH,MAAV,CAAhB,CACA,GAAMI,CAAAA,OAAO,CAAGL,KAAK,CAACM,GAAN,CAAUL,MAAV,CAAhB,CACA,MAAO,CACLE,OAAO,CAAEA,OAAO,CAACI,EAAR,CAAWjD,MAAM,CAACkD,SAAP,CAAiBC,IAA5B,EAAoCnD,MAAM,CAACkD,SAAP,CAAiBC,IAArD,CAA4DN,OADhE,CAELE,OAAO,CAAEA,OAAO,CAACK,EAAR,CAAWpD,MAAM,CAACkD,SAAP,CAAiBG,UAA5B,EAA0CrD,MAAM,CAACkD,SAAP,CAAiBG,UAA3D,CAAwEN,OAF5E,CAAP,CAID,CARD,IAQO,CACL,MAAO,EAAP,CACD,CACF,CAED,GAAMO,CAAAA,wBAAwB,CAAG,CAC/BC,UAAU,CAAE,EADmB,CAE/BC,WAAW,CAAE,EAFkB,CAG/BC,eAAe,CAAE1C,KAHc,CAI/B2C,cAAc,CAAE,EAJe,CAAjC,CAOA,QAASC,CAAAA,wBAAT,CAAkCC,KAAlC,CAAyCC,MAAzC,CAAiD,CAC/C,OAAQA,MAAM,CAACC,IAAf,EACE,IAAK,iBAAL,CAAwB,CACtB,wBACKF,KADL,EAEEF,cAAc,CAAEG,MAAM,CAACE,OAFzB,GAID,CACD,IAAK,cAAL,CAAqB,IACXR,CAAAA,UADW,CACiBK,KADjB,CACXL,UADW,CACCC,WADD,CACiBI,KADjB,CACCJ,WADD,qBAEMK,MAAM,CAACE,OAFb,CAEXC,KAFW,iBAEXA,KAFW,CAEJtB,KAFI,iBAEJA,KAFI,CAGnB,wBACKkB,KADL,EAEEL,UAAU,CAAES,KAAK,GAAKjD,KAAV,CAAkB2B,KAAlB,CAA0Ba,UAFxC,CAGEC,WAAW,CAAEQ,KAAK,GAAKhD,MAAV,CAAmB0B,KAAnB,CAA2Bc,WAH1C,CAIEC,eAAe,CAAEO,KAJnB,GAMD,CACD,IAAK,wBAAL,CAA+B,IACrBT,CAAAA,WADqB,CACOK,KADP,CACrBL,UADqB,CACTC,YADS,CACOI,KADP,CACTJ,WADS,sBAEJK,MAAM,CAACE,OAFH,CAErBC,MAFqB,kBAErBA,KAFqB,CAEdtB,MAFc,kBAEdA,KAFc,CAG7B,wBACKkB,KADL,EAEEL,UAAU,CAAES,MAAK,GAAKjD,KAAV,CAAkB2B,MAAlB,CAA0Ba,WAFxC,CAGEC,WAAW,CAAEQ,MAAK,GAAKhD,MAAV,CAAmB0B,MAAnB,CAA2Bc,YAH1C,GAKD,CACD,QAAS,CACP,MAAOF,CAAAA,wBAAP,CACD,CA5BH,CA8BD,CAED,QAASW,CAAAA,eAAT,CAAyBV,UAAzB,CAAqCW,aAArC,CAAoDV,WAApD,CAAiEW,cAAjE,CAAiG,IAAhBC,CAAAA,MAAgB,2DAAP,KAAO,CAC/F,GAAI,CACF,GACEb,UAAU,GACTW,aAAa,EAAIA,aAAa,GAAK,CAD1B,CAAV,EAEAV,WAFA,GAGCW,cAAc,EAAIA,cAAc,GAAK,CAHtC,CADF,CAKE,CACA,GAAME,CAAAA,MAAM,CAAGrE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,CAAlC,CAAf,CAEA,GAAIiD,MAAJ,CAAY,CACV,MAAOb,CAAAA,UAAU,CACdX,GADI,CACAyB,MADA,EAEJ1C,GAFI,CAEA6B,WAFA,EAGJZ,GAHI,CAGA5C,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0BgD,cAA1B,CAAlC,CAHA,EAIJxC,GAJI,CAIA3B,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B+C,aAA1B,CAAlC,CAJA,CAAP,CAKD,CAND,IAMO,CACL,MAAOV,CAAAA,WAAW,CACfZ,GADI,CACAyB,MADA,EAEJ1C,GAFI,CAEA4B,UAFA,EAGJX,GAHI,CAGA5C,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B+C,aAA1B,CAAlC,CAHA,EAIJvC,GAJI,CAIA3B,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0BgD,cAA1B,CAAlC,CAJA,CAAP,CAKD,CACF,CACF,CAAC,cAAM,CAAE,CACX,CAED,QAASI,CAAAA,aAAT,CAAuBC,UAAvB,CAAmCC,YAAnC,CAAiDC,QAAjD,CAA2E,IAAhBN,CAAAA,MAAgB,2DAAP,KAAO,CACzE,MAAOH,CAAAA,eAAe,CAACO,UAAD,CAAa,EAAb,CAAiBC,YAAjB,CAA+BC,QAA/B,CAAyCN,MAAzC,CAAtB,CACD,CAED,cAAe,SAASO,CAAAA,YAAT,EAAwB,qBACvB7E,cAAc,EADS,CAC7B8E,CAD6B,iBAC7BA,CAD6B,qBAEA7E,cAAc,EAFd,CAE7B8E,OAF6B,iBAE7BA,OAF6B,CAEpBC,MAFoB,iBAEpBA,MAFoB,CAEZC,OAFY,iBAEZA,OAFY,iBAIkBtF,UAAU,CAACkE,wBAAD,CAA2BL,wBAA3B,CAJ5B,4CAI9B0B,iBAJ8B,iBAIXC,yBAJW,oBAK7B1B,CAAAA,UAL6B,CAKgCyB,iBALhC,CAK7BzB,UAL6B,CAKjBC,WALiB,CAKgCwB,iBALhC,CAKjBxB,WALiB,CAKJC,eALI,CAKgCuB,iBALhC,CAKJvB,eALI,CAKaC,cALb,CAKgCsB,iBALhC,CAKatB,cALb,CAMrC,GAAMwB,CAAAA,aAAa,CAAG,KAAtB,CANqC,cAQWxF,QAAQ,EARnB,wCAQ9ByF,gBAR8B,eAQZC,mBARY,8BASa1F,QAAQ,EATrB,yCAS9B2F,iBAT8B,eASXC,oBATW,8BAUD5F,QAAQ,EAVP,yCAU9B6F,UAV8B,eAUlBC,aAVkB,8BAWC9F,QAAQ,EAXT,yCAW9B+F,WAX8B,eAWjBC,cAXiB,oCAaS/E,eAAe,CAAC+C,cAAD,CAbxB,CAa7BiC,MAb6B,kBAa7BA,MAb6B,CAarBjB,QAbqB,kBAarBA,QAbqB,CAaXkB,eAbW,kBAaXA,eAbW,CAcrC,GAAMC,CAAAA,gBAAgB,CAAGtF,mBAAmB,CAACqF,eAAD,CAA5C,CAdqC,eAgBSlG,QAAQ,EAhBjB,0CAgB9BoG,eAhB8B,gBAgBbC,kBAhBa,gBAiBrC,GAAMC,CAAAA,eAAe,CAAGrG,WAAW,CAAC,UAAM,CACxC,GAAIkG,gBAAJ,CAAsB,CACpBA,gBAAgB,CAACI,WAAjB,GAA+BC,IAA/B,CAAoC,SAAAD,WAAW,CAAI,CACjDF,kBAAkB,CAACE,WAAD,CAAlB,CACD,CAFD,EAGD,CACF,CANkC,CAMhC,CAACJ,gBAAD,CANgC,CAAnC,CAOAjG,SAAS,CAAC,UAAM,CACdoG,eAAe,GACfnB,OAAO,CAACsB,EAAR,CAAW,OAAX,CAAoBH,eAApB,EAEA,MAAO,WAAM,CACXnB,OAAO,CAACuB,cAAR,CAAuB,OAAvB,CAAgCJ,eAAhC,EACD,CAFD,CAGD,CAPQ,CAON,CAACA,eAAD,CAAkBnB,OAAlB,CAPM,CAAT,CASA,GAAMwB,CAAAA,gBAAgB,CAAGzF,iBAAiB,CAACmE,OAAD,CAAUa,eAAV,CAA1C,CACA,GAAMU,CAAAA,kBAAkB,CAAG1F,iBAAiB,CAACgF,eAAD,CAAkB,KAAlB,CAA5C,CACA,GAAMW,CAAAA,oBAAoB,CAAG3F,iBAAiB,CAACgF,eAAD,CAAkBlC,cAAlB,CAA9C,CAnCqC,yBAqCA7C,mBAAmB,CAAC6C,cAAD,CArCnB,CAqC7Bc,UArC6B,sBAqC7BA,UArC6B,CAqCjBC,YArCiB,sBAqCjBA,YArCiB,CAsCrC,GAAM+B,CAAAA,aAAa,CAAG,CAAC,EAAEhC,UAAU,EAAIC,YAAd,EAA8BD,UAAU,CAACiC,MAAX,EAA9B,EAAqDhC,YAAY,CAACgC,MAAb,EAAvD,CAAvB,CAEA;AACA,GAAMC,CAAAA,mBAAmB,CACvBL,gBAAgB,EAAIP,eAApB,EAAuCU,aAAa,GAAK,KAAzD,EAAkE,CAACV,eAAe,CAACW,MAAhB,EAAnE,CACIJ,gBAAgB,CAACzD,GAAjB,CAAqB5C,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,CAAlC,CAArB,EAAuFQ,GAAvF,CAA2FmE,eAA3F,CADJ,CAEIa,SAHN,CAIA,GAAMC,CAAAA,QAAQ,CACZN,kBAAkB,EAAII,mBAAtB,CACIJ,kBAAkB,CACf1D,GADH,CACO8D,mBADP,EAEG/E,GAFH,CAEO3B,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,CAAlC,CAFP,CADJ,CAIIwF,SALN,CAMA,GAAME,CAAAA,UAAU,CACdN,oBAAoB,EAAIG,mBAAxB,CACIH,oBAAoB,CACjB3D,GADH,CACO8D,mBADP,EAEG/E,GAFH,CAEO3B,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,CAAlC,CAFP,CADJ,CAIIwF,SALN,CAOA,GAAMG,CAAAA,eAAe,CAAGN,aAAa,CACjCrB,gBADiC,CAEjCW,eAAe,EAAIX,gBAAnB,EAAuCmB,kBAAvC,EAA6D,CAACA,kBAAkB,CAACG,MAAnB,EAA9D,CACAX,eAAe,CAAClD,GAAhB,CAAoBuC,gBAApB,EAAsCxD,GAAtC,CAA0C2E,kBAA1C,CADA,CAEAK,SAJJ,CAMA;AACA,GAAMI,CAAAA,YAAY,CAAGnG,iBAAiB,CAACmE,OAAD,CAAUG,aAAV,CAAtC,CACA,GAAM8B,CAAAA,aAAa,CAAGpG,iBAAiB,CAACmE,OAAD,CAAUrB,cAAV,CAAvC,CAEA,GAAMuD,CAAAA,oBAAoB,CACxBX,kBAAkB,EAAIR,eAAtB,EAAyCU,aAAa,GAAK,KAA3D,EAAoE,CAACV,eAAe,CAACW,MAAhB,EAArE,CACIH,kBAAkB,CAAC1D,GAAnB,CAAuB5C,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,CAAlC,CAAvB,EAAyFQ,GAAzF,CAA6FmE,eAA7F,CADJ,CAEIa,SAHN,CAIA,GAAMO,CAAAA,sBAAsB,CAC1BX,oBAAoB,EAAIT,eAAxB,EAA2CU,aAAa,GAAK,KAA7D,EAAsE,CAACV,eAAe,CAACW,MAAhB,EAAvE,CACIF,oBAAoB,CAAC3D,GAArB,CAAyB5C,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,CAAlC,CAAzB,EAA2FQ,GAA3F,CAA+FmE,eAA/F,CADJ,CAEIa,SAHN,CAKA,GAAMQ,CAAAA,cAAc,CAAG9B,iBAAiB,EAAI5C,uBAAuB,CAAC4C,iBAAD,CAAvB,CAA2CtC,OAAvF,CACA,GAAMqE,CAAAA,kBAAkB,CAAGN,eAAe,EAAIrE,uBAAuB,CAACqE,eAAD,CAAvB,CAAyCjE,OAAvF,CAEA,GAAMwE,CAAAA,UAAU,CAAGxH,OAAO,CAAC,UAAM,CAC/B,MAAO0E,CAAAA,aAAa,CAACC,UAAD,CAAaC,YAAb,CAA2BC,QAA3B,CAApB,CACD,CAFyB,CAEvB,CAACF,UAAD,CAAaC,YAAb,CAA2BC,QAA3B,CAFuB,CAA1B,CAGA,GAAM4C,CAAAA,kBAAkB,CAAGzH,OAAO,CAAC,UAAM,CACvC,MAAO0E,CAAAA,aAAa,CAACC,UAAD,CAAaC,YAAb,CAA2BC,QAA3B,CAAqC,IAArC,CAApB,CACD,CAFiC,CAE/B,CAACF,UAAD,CAAaC,YAAb,CAA2BC,QAA3B,CAF+B,CAAlC,CAIA,QAAS6C,CAAAA,wBAAT,EAAoC,CAClCtH,OAAO,CAACuH,KAAR,CAAc,CACZC,QAAQ,CAAE,mBADE,CAEZ5D,MAAM,CAAE,MAFI,CAAd,EAKA,GAAM6D,CAAAA,CAAC,CAAG,QAAJA,CAAAA,CAAI,CAAAC,IAAI,QAAI,qBAAC,QAAD,MAAWA,IAAX,CAAJ,EAAd,CAEA,GAAInB,aAAJ,CAAmB,CACjB,MACE,gCACE,+BACG5B,CAAC,CAAC,cAAD,CADJ,KACuB8C,CAAC,WAAInE,UAAJ,SADxB,KACgDqB,CAAC,CAAC,KAAD,CADjD,KAC2D8C,CAAC,WAAIlE,WAAJ,aAAmBmC,MAAnB,EAD5D,KAC2Ff,CAAC,CAAC,UAAD,CAD5F,CADF,CAIE,oBAAC,eAAD,MACGA,CAAC,CAAC,qBAAD,CADJ,CAC6B,GAD7B,CAEG8C,CAAC,mBACWlH,eAAe,CACxB+D,aAAa,CAACY,gBAAD,CAAmBE,iBAAnB,CAAsCX,QAAtC,CADW,CAExB,EAFwB,CAGxB,CAHwB,CAIxB,KAJwB,CAD1B,aAMKiB,MANL,EAFJ,KAJF,CAgBE,oBAAC,eAAD,MACGf,CAAC,CAAC,aAAD,CADJ,KACsB8C,CAAC,WAAInE,UAAJ,EADvB,KAC2CqB,CAAC,CAAC,iBAAD,CAD5C,CAhBF,CAmBE,oBAAC,eAAD,MAAkBA,CAAC,CAAC,gBAAD,CAAnB,CAnBF,CADF,CAuBD,CAxBD,IAwBO,CACL,MACE,yCACE,+BACGA,CAAC,CAAC,cAAD,CADJ,KACuB8C,CAAC,WAAIlH,eAAe,CAAC2E,gBAAD,CAAmB,EAAnB,CAAuB,CAAvB,CAAnB,SADxB,KAC8EP,CAAC,CAAC,KAAD,CAD/E,KACyF,SADzF,CACoG,GADpG,CAEG8C,CAAC,WAAIlH,eAAe,CAAC2G,cAAD,CAAiBzC,QAAjB,CAA2B,CAA3B,CAAnB,aAAoDiB,MAApD,EAFJ,KAEoEf,CAAC,CAAC,UAAD,CAFrE,CADF,CAKE,oBAAC,eAAD,MACGA,CAAC,CAAC,aAAD,CADJ,KACsB8C,CAAC,CAAClH,eAAe,CAACsG,eAAD,CAAkB,EAAlB,CAAsB,CAAtB,CAAhB,CADvB,KACmElC,CAAC,CAAC,iBAAD,CADpE,CALF,CAQE,oBAAC,eAAD,MACGA,CAAC,CAAC,eAAD,CADJ,KACwB8C,CAAC,CAAClH,eAAe,CAACsF,eAAD,CAAkB,EAAlB,CAAsB,CAAtB,CAAhB,CADzB,CARF,CAWE,oBAAC,eAAD,MACGlB,CAAC,CAAC,YAAD,CADJ,KACqB8C,CAAC,CAAClH,eAAe,CAACyG,oBAAD,CAAuB,EAAvB,CAA2B,CAA3B,CAAhB,CADtB,SAC2ErC,CAAC,CAAC,KAAD,CAD5E,CACqF,GADrF,CAEG8C,CAAC,CAAClH,eAAe,CAAC0G,sBAAD,CAAyBxC,QAAzB,CAAmCkD,IAAI,CAACC,GAAL,CAASnD,QAAT,CAAmB,CAAnB,CAAnC,CAAhB,CAFJ,KAEiFiB,MAFjF,CAXF,CADF,CAkBD,CACF,CAED,QAASmC,CAAAA,aAAT,EAAyB,CACvB,GAAIC,CAAAA,cAAc,CAAG,EAArB,CACA,GAAIC,CAAAA,OAAO,CAAG,KAAd,CAEA,GAAIzC,UAAU,EAAIE,WAAlB,CAA+B,CAC7BsC,cAAc,CAAGxC,UAAU,EAAIE,WAA/B,CACAuC,OAAO,CAAG,IAAV,CACD,CAHD,IAGO,IAAI,CAAC9C,aAAD,EAAkB,CAACxB,cAAvB,CAAuC,CAC5CqE,cAAc,CAAGnD,CAAC,CAAC,iBAAD,CAAlB,CACD,CAFM,IAEA,IAAI,CAACrB,UAAL,CAAiB,CACtBwE,cAAc,CAAGnD,CAAC,CAAC,gBAAD,CAAlB,CACD,CAFM,IAEA,IAAI,CAACG,OAAL,CAAc,CACnBgD,cAAc,CAAGnD,CAAC,CAAC,UAAD,CAAlB,CACAoD,OAAO,CAAG,IAAV,CACD,CAED,MACE,qBAAC,cAAD,EACE,eAAe,CAAEpD,CAAC,CAAC,oBAAD,CADpB,CAEE,gBAAgB,CAAEA,CAAC,CAAC,aAAD,CAFrB,CAGE,cAAc,CAAEmD,cAHlB,CAIE,OAAO,CAAEC,OAJX,CAKE,wBAAwB,CAAET,wBAL5B,EADF,CASD,CAED,GAAMU,CAAAA,cAAc,CAAGvH,mBAAmB,EAA1C,CAEA,GAAMwH,CAAAA,QAAQ,CAAGpD,MAAM,EAAIC,OAA3B,CACA,GAAMoD,CAAAA,OAAO,CAAG5C,UAAU,GAAK,IAAf,EAAuBE,WAAW,GAAK,IAAvD,CA3KqC,QA6KtB2C,CAAAA,cA7KsB,oJA6KrC,kKACEnI,OAAO,CAACuH,KAAR,CAAc,CACZC,QAAQ,CAAE,MADE,CAEZ5D,MAAM,CAAE,cAFI,CAAd,EAKMwE,QANR,CAMmBT,IAAI,CAACU,IAAL,CAAUC,IAAI,CAACC,GAAL,GAAa,IAAvB,EAA+BpH,iBANlD,uBAOkCyE,CAAAA,gBAAgB,CAAC4C,QAAjB,CAA0BC,YAA1B,CAC9BlC,aAAa,CAAGxG,MAAM,CAACkD,SAAP,CAAiBC,IAApB,CAA2BiE,kBADV,CAE9BZ,aAAa,CAAGnB,iBAAH,CAAuB8B,cAFN,CAG9BkB,QAH8B,CAI9B,CACE3F,KAAK,CAAEyC,gBADT,CAJ8B,CAPlC,QAOQwD,iBAPR,eAgBE9C,gBAAgB,CACb6C,YADH,CAEIlC,aAAa,CAAGxG,MAAM,CAACkD,SAAP,CAAiBC,IAApB,CAA2BiE,kBAF5C,CAGIZ,aAAa,CAAGnB,iBAAH,CAAuB8B,cAHxC,CAIIkB,QAJJ,CAKI,CACE3F,KAAK,CAAEyC,gBADT,CAEEyD,QAAQ,CAAEnI,kBAAkB,CAACkI,iBAAD,CAAoBtH,UAApB,CAF9B,CALJ,EAUG6E,IAVH,CAUQ,SAAA2C,QAAQ,CAAI,CAChBZ,cAAc,CAACY,QAAD,CAAd,CACD,CAZH,EAhBF,sDA7KqC,iDA4MrC,QAASC,CAAAA,aAAT,CAAuBpG,KAAvB,CAA8B,CAC5B,yBAAmBA,KAAnB,EACD,CAED9C,SAAS,CAAC,UAAM,CACd,GAAI4G,aAAJ,CAAmB,CACjB,GAAIjD,UAAJ,CAAgB,CACd,GAAMwF,CAAAA,gBAAgB,CAAG/I,MAAM,CAACkB,KAAP,CAAa8H,UAAb,CAAwBzF,UAAxB,CAAoC,EAApC,CAAzB,CACA6B,mBAAmB,CAAC2D,gBAAD,CAAnB,CACD,CAED,GAAIvF,WAAJ,CAAiB,CACf,GAAMyF,CAAAA,iBAAiB,CAAGjJ,MAAM,CAACkB,KAAP,CAAa8H,UAAb,CAAwBxF,WAAxB,CAAqCkB,QAArC,CAA1B,CACAY,oBAAoB,CAAC2D,iBAAD,CAApB,CACD,CACF,CACF,CAZQ,CAYN,CAACvE,QAAD,CAAWnB,UAAX,CAAuBiD,aAAvB,CAAsChD,WAAtC,CAZM,CAAT,CAcA;AACA5D,SAAS,CAAC,UAAM,CACd,GAAI4G,aAAa,GAAK,KAAlB,EAA2BjD,UAA3B,EAAyC8D,UAAzC,EAAuD5D,eAAe,GAAK1C,KAA3E,EAAoF2D,QAAxF,CAAkG,CAChG,GAAI,CACF,GAAMwE,CAAAA,WAAW,CAAGlJ,MAAM,CAACkB,KAAP,CAAa8H,UAAb,CAAwBzF,UAAxB,CAAoC,EAApC,CAApB,CAEA,GAAI2F,WAAW,CAACC,GAAZ,CAAgBnJ,MAAM,CAACkD,SAAP,CAAiBC,IAAjC,GAA0C+F,WAAW,CAACE,GAAZ,CAAgBpJ,MAAM,CAACkD,SAAP,CAAiBG,UAAjC,CAA9C,CAA4F,CAC1F,KAAMgG,CAAAA,KAAK,EAAX,CACD,CAEDjE,mBAAmB,CAAC8D,WAAD,CAAnB,CAEA,GAAMI,CAAAA,cAAc,CAAGjC,UAAU,CAC9BzE,GADoB,CAChBsG,WADgB,EAEpBvH,GAFoB,CAEhB3B,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,CAAlC,CAFgB,EAGpBQ,GAHoB,CAGhB3B,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,GAAKuD,QAA/B,CAAlC,CAHgB,CAAvB,CAKAY,oBAAoB,CAACgE,cAAD,CAApB,CACArE,yBAAyB,CAAC,CACxBnB,IAAI,CAAE,wBADkB,CAExBC,OAAO,CAAE,CAAEC,KAAK,CAAEhD,MAAT,CAAiB0B,KAAK,CAAElC,eAAe,CAAC8I,cAAD,CAAiB5E,QAAjB,CAA2B,CAA3B,CAA8B,KAA9B,CAAvC,CAFe,CAAD,CAAzB,CAKA,MAAO,WAAM,CACXgB,cAAc,GACdN,mBAAmB,GACnBE,oBAAoB,GACpBL,yBAAyB,CAAC,CACxBnB,IAAI,CAAE,wBADkB,CAExBC,OAAO,CAAE,CAAEC,KAAK,CAAEhD,MAAT,CAAiB0B,KAAK,CAAE,EAAxB,CAFe,CAAD,CAAzB,CAID,CARD,CASD,CAAC,eAAM,CACNgD,cAAc,CAACd,CAAC,CAAC,eAAD,CAAF,CAAd,CACD,CACF,CACF,CAnCQ,CAmCN,CAACrB,UAAD,CAAaiD,aAAb,CAA4B/C,eAA5B,CAA6C4D,UAA7C,CAAyD3C,QAAzD,CAAmEE,CAAnE,CAnCM,CAAT,CAqCA;AACAhF,SAAS,CAAC,UAAM,CACd,GAAI4G,aAAa,GAAK,KAAlB,EAA2BhD,WAA3B,EAA0C8D,kBAA1C,EAAgE7D,eAAe,GAAKzC,MAApF,EAA8F0D,QAAlG,CAA4G,CAC1G,GAAI,CACF,GAAMwE,CAAAA,WAAW,CAAGlJ,MAAM,CAACkB,KAAP,CAAa8H,UAAb,CAAwBxF,WAAxB,CAAqCkB,QAArC,CAApB,CAEA,GAAIwE,WAAW,CAACC,GAAZ,CAAgBnJ,MAAM,CAACkD,SAAP,CAAiBC,IAAjC,GAA0C+F,WAAW,CAACE,GAAZ,CAAgBpJ,MAAM,CAACkD,SAAP,CAAiBG,UAAjC,CAA9C,CAA4F,CAC1F,KAAMgG,CAAAA,KAAK,EAAX,CACD,CAED/D,oBAAoB,CAAC4D,WAAD,CAApB,CAEA,GAAMI,CAAAA,cAAc,CAAGhC,kBAAkB,CACtC1E,GADoB,CAChBsG,WADgB,EAEpBvH,GAFoB,CAEhB3B,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0B,EAA1B,EAA8BmD,GAA9B,CAAkCtE,MAAM,CAACkB,KAAP,CAAaC,YAAb,CAA0BuD,QAA1B,CAAlC,CAFgB,CAAvB,CAIAU,mBAAmB,CAACkE,cAAD,CAAnB,CACArE,yBAAyB,CAAC,CACxBnB,IAAI,CAAE,wBADkB,CAExBC,OAAO,CAAE,CAAEC,KAAK,CAAEjD,KAAT,CAAgB2B,KAAK,CAAElC,eAAe,CAAC8I,cAAD,CAAiB,EAAjB,CAAqB,CAArB,CAAwB,KAAxB,CAAtC,CAFe,CAAD,CAAzB,CAKA,MAAO,WAAM,CACX9D,aAAa,GACbF,oBAAoB,GACpBF,mBAAmB,GACnBH,yBAAyB,CAAC,CACxBnB,IAAI,CAAE,wBADkB,CAExBC,OAAO,CAAE,CAAEC,KAAK,CAAEjD,KAAT,CAAgB2B,KAAK,CAAE,EAAvB,CAFe,CAAD,CAAzB,CAID,CARD,CASD,CAAC,eAAM,CACN8C,aAAa,CAACZ,CAAC,CAAC,eAAD,CAAF,CAAb,CACD,CACF,CACF,CAlCQ,CAkCN,CAACpB,WAAD,CAAcgD,aAAd,CAA6B/C,eAA7B,CAA8C6D,kBAA9C,CAAkE5C,QAAlE,CAA4EE,CAA5E,CAlCM,CAAT,CAoCA;AACAhF,SAAS,CAAC,UAAM,CACd,GAAIuF,gBAAgB,EAAI4B,YAAxB,CAAsC,CACpC,GAAI5B,gBAAgB,CAAC/B,EAAjB,CAAoB2D,YAApB,CAAJ,CAAuC,CACrCvB,aAAa,CAACZ,CAAC,CAAC,qBAAD,CAAF,CAAb,CACD,CAFD,IAEO,CACLY,aAAa,CAAC,IAAD,CAAb,CACD,CACF,CAED,GAAI2B,cAAc,EAAIH,aAAtB,CAAqC,CACnC,GAAIG,cAAc,CAAC/D,EAAf,CAAkB4D,aAAlB,CAAJ,CAAsC,CACpCtB,cAAc,CAACd,CAAC,CAAC,qBAAD,CAAF,CAAd,CACD,CAFD,IAEO,CACLc,cAAc,CAAC,IAAD,CAAd,CACD,CACF,CACF,CAhBQ,CAgBN,CAACP,gBAAD,CAAmB4B,YAAnB,CAAiCI,cAAjC,CAAiDH,aAAjD,CAAgEpC,CAAhE,CAhBM,CAAT,CAkBA,GAAM2E,CAAAA,SAAS,CAAGzI,mBAAmB,CAACiE,OAAD,CAAUrB,cAAV,CAA0BkC,eAA1B,CAArC,CA5TqC,gBA6TDlG,QAAQ,CAAC,KAAD,CA7TP,2CA6T9B8J,UA7T8B,gBA6TlBC,aA7TkB,gBA8TrC7J,SAAS,CAAC,UAAM,CACd,GAAIyF,iBAAiB,EAAIkE,SAAzB,CAAoC,CAClC,GAAIA,SAAS,CAACtG,EAAV,CAAaoC,iBAAb,CAAJ,CAAqC,CACnCK,cAAc,CAACd,CAAC,CAAC,iBAAD,CAAF,CAAd,CACA6E,aAAa,CAAC,IAAD,CAAb,CACD,CACD,MAAO,WAAM,CACX/D,cAAc,GACd+D,aAAa,CAAC,KAAD,CAAb,CACD,CAHD,CAID,CACF,CAXQ,CAWN,CAACpE,iBAAD,CAAoBkE,SAApB,CAA+B3E,CAA/B,CAXM,CAAT,CAaA,MACE,yCACG4B,aAAa,CACZ,oBAAC,kBAAD,MACE,oBAAC,sBAAD,MACE,4BAAM,IAAI,CAAC,KAAX,CAAiB,aAAW,iBAA5B,iBADF,CAGU,GAHV,CAIG5B,CAAC,CAAC,gBAAD,CAJJ,CADF,CAOE,oBAAC,sBAAD,MAAyBA,CAAC,CAAC,qBAAD,CAAwB,CAAEe,MAAM,CAANA,MAAF,CAAxB,CAA1B,CAPF,CADY,CAUV,IAXN,CAaE,oBAAC,kBAAD,EACE,KAAK,CAAEf,CAAC,CAAC,SAAD,CADV,CAEE,SAAS,CAAEmC,YAAY,EAAI+B,aAAa,CAACtI,eAAe,CAACuG,YAAD,CAAe,EAAf,CAAmB,CAAnB,CAAhB,CAF1C,CAGE,aAAa,CAAE,uBAAAxD,UAAU,CAAI,CAC3B0B,yBAAyB,CAAC,CAAEnB,IAAI,CAAE,cAAR,CAAwBC,OAAO,CAAE,CAAErB,KAAK,CAAEa,UAAT,CAAqBS,KAAK,CAAEjD,KAA5B,CAAjC,CAAD,CAAzB,CACD,CALH,CAME,oBAAoB,CAAC,KANvB,CAOE,KAAK,CAAEwC,UAPT,CAQE,YAAY,CAAEgC,UARhB,CASE,kBAAkB,KATpB,EAbF,CAwBE,oBAAC,cAAD,MACE,oBAAC,mBAAD,MACE,oBAAC,SAAD,EAAW,GAAG,CAAE2C,QAAQ,CAAGwB,QAAH,CAAcC,QAAtC,CAAgD,GAAG,CAAC,MAApD,EADF,CADF,CAxBF,CA6BE,oBAAC,kBAAD,EACE,KAAK,CAAE/E,CAAC,CAAC,SAAD,CADV,CAEE,WAAW,CAAE4B,aAAa,CAAG,EAAH,CAAQhD,WAAW,YAAOoB,CAAC,CAAC,WAAD,CAAR,MAA2B,EAF1E,CAGE,SAAS,CAAEoC,aAAa,EAAI8B,aAAa,CAACtI,eAAe,CAACwG,aAAD,CAAgBtC,QAAhB,CAA0BkD,IAAI,CAACC,GAAL,CAASnD,QAAT,CAAmB,CAAnB,CAA1B,CAAhB,CAH3C,CAIE,oBAAoB,CAAEhB,cAJxB,CAKE,kBAAkB,CAAE,4BAAAA,cAAc,CAAI,CACpCuB,yBAAyB,CAAC,CAAEnB,IAAI,CAAE,iBAAR,CAA2BC,OAAO,CAAEL,cAApC,CAAD,CAAzB,CACD,CAPH,CAQE,aAAa,CAAE,uBAAAF,WAAW,CAAI,CAC5ByB,yBAAyB,CAAC,CAAEnB,IAAI,CAAE,cAAR,CAAwBC,OAAO,CAAE,CAAErB,KAAK,CAAEc,WAAT,CAAsBQ,KAAK,CAAEhD,MAA7B,CAAjC,CAAD,CAAzB,CACD,CAVH,CAWE,KAAK,CAAEwC,WAXT,CAYE,UAAU,CAAEgG,UAZd,CAaE,YAAY,CAAE/D,WAbhB,EA7BF,CA4CE,oBAAC,cAAD,EAAgB,UAAU,KAA1B,EACE,oBAAC,YAAD,MACE,oBAAC,mBAAD,MACE,oBAAC,YAAD,MAAeb,CAAC,CAAC,cAAD,CAAhB,CADF,CAEE,gCAAOyC,UAAU,mBAAc7G,eAAe,CAAC6G,UAAD,CAAa,EAAb,CAAiB,CAAjB,CAA7B,aAAoD1B,MAApD,EAA+D,KAAhF,CAFF,CADF,CAKE,oBAAC,mBAAD,MACE,oBAAC,YAAD,MAAef,CAAC,CAAC,iBAAD,CAAhB,CADF,CAEE,gCACG0B,kBAAkB,EAAIC,oBAAtB,WACM/F,eAAe,CAAC8F,kBAAD,CAAqB,EAArB,CAAyB,CAAzB,CADrB,mBAC0D9F,eAAe,CACpE+F,oBADoE,CAEpE7B,QAFoE,CAGpEkD,IAAI,CAACC,GAAL,CAAS,CAAT,CAAYnD,QAAZ,CAHoE,CADzE,aAKQiB,MALR,EAMG,KAPN,CAFF,CALF,CAiBE,oBAAC,mBAAD,MACE,oBAAC,YAAD,MACGf,CAAC,CAAC,eAAD,CADJ,MACyB0B,kBAAkB,EAAI9F,eAAe,CAACkG,mBAAD,CAAsB,EAAtB,CAA0B,CAA1B,CAD9D,MADF,CAIE,gCACGE,QAAQ,EAAIC,UAAZ,WACMrG,eAAe,CAACoG,QAAD,CAAW,EAAX,CAAe,CAAf,CADrB,mBACgDpG,eAAe,CAC1DqG,UAD0D,CAE1DnC,QAF0D,CAG1DkD,IAAI,CAACC,GAAL,CAAS,CAAT,CAAYnD,QAAZ,CAH0D,CAD/D,aAKQiB,MALR,EAMG,KAPN,CAJF,CAjBF,CADF,CA5CF,CA8EGmC,aAAa,EA9EhB,CA+EE,oBAAC,IAAD,MACE,oBAAC,MAAD,EAAQ,QAAQ,CAAE,CAACK,OAAnB,CAA4B,OAAO,CAAEC,cAArC,EACGxD,CAAC,CAAC,cAAD,CADJ,CADF,CA/EF,CADF,CAuFD","sourcesContent":["import React, { useReducer, useState, useCallback, useEffect, useMemo } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useWeb3Context } from 'web3-react'\nimport { ethers } from 'ethers'\nimport ReactGA from 'react-ga'\nimport styled from 'styled-components'\n\nimport { Button } from '../../theme'\nimport CurrencyInputPanel from '../../components/CurrencyInputPanel'\nimport OversizedPanel from '../../components/OversizedPanel'\nimport ContextualInfo from '../../components/ContextualInfo'\nimport PlusBlue from '../../assets/images/plus-blue.svg'\nimport PlusGrey from '../../assets/images/plus-grey.svg'\nimport { useExchangeContract } from '../../hooks'\nimport { amountFormatter, calculateGasMargin } from '../../utils'\nimport { useTransactionAdder } from '../../contexts/Transactions'\nimport { useTokenDetails } from '../../contexts/Tokens'\nimport { useAddressBalance, useExchangeReserves } from '../../contexts/Balances'\nimport { useAddressAllowance } from '../../contexts/Allowances'\n\nconst INPUT = 0\nconst OUTPUT = 1\n\n// denominated in bips\nconst ALLOWED_SLIPPAGE = ethers.utils.bigNumberify(200)\n\n// denominated in seconds\nconst DEADLINE_FROM_NOW = 60 * 15\n\n// denominated in bips\nconst GAS_MARGIN = ethers.utils.bigNumberify(1000)\n\nconst BlueSpan = styled.span`\n  color: ${({ theme }) => theme.royalBlue};\n`\n\nconst NewExchangeWarning = styled.div`\n  margin-top: 1rem;\n  padding: 1rem;\n  margin-bottom: 2rem;\n  border: 1px solid rgba($pizazz-orange, 0.4);\n  background-color: rgba($pizazz-orange, 0.1);\n  border-radius: 1rem;\n`\n\nconst NewExchangeWarningText = styled.div`\n  font-size: 0.75rem;\n  line-height: 1rem;\n  text-align: center;\n\n  :first-child {\n    padding-bottom: 0.3rem;\n    font-weight: 500;\n  }\n`\n\nconst LastSummaryText = styled.div`\n  margin-top: 1rem;\n`\n\nconst DownArrowBackground = styled.div`\n  ${({ theme }) => theme.flexRowNoWrap}\n  justify-content: center;\n  align-items: center;\n`\n\nconst DownArrow = styled.img`\n  width: 0.625rem;\n  height: 0.625rem;\n  position: relative;\n  padding: 0.875rem;\n`\n\nconst SummaryPanel = styled.div`\n  ${({ theme }) => theme.flexColumnNoWrap}\n  padding: 1rem 0;\n`\n\nconst ExchangeRateWrapper = styled.div`\n  ${({ theme }) => theme.flexRowNoWrap};\n  align-items: center;\n  color: ${({ theme }) => theme.doveGray};\n  font-size: 0.75rem;\n  padding: 0.25rem 1rem 0;\n`\n\nconst ExchangeRate = styled.span`\n  flex: 1 1 auto;\n  width: 0;\n  color: ${({ theme }) => theme.chaliceGray};\n`\n\nconst Flex = styled.div`\n  display: flex;\n  justify-content: center;\n  padding: 2rem;\n\n  button {\n    max-width: 20rem;\n  }\n`\n\nfunction calculateSlippageBounds(value) {\n  if (value) {\n    const offset = value.mul(ALLOWED_SLIPPAGE).div(ethers.utils.bigNumberify(10000))\n    const minimum = value.sub(offset)\n    const maximum = value.add(offset)\n    return {\n      minimum: minimum.lt(ethers.constants.Zero) ? ethers.constants.Zero : minimum,\n      maximum: maximum.gt(ethers.constants.MaxUint256) ? ethers.constants.MaxUint256 : maximum\n    }\n  } else {\n    return {}\n  }\n}\n\nconst initialAddLiquidityState = {\n  inputValue: '',\n  outputValue: '',\n  lastEditedField: INPUT,\n  outputCurrency: ''\n}\n\nfunction addLiquidityStateReducer(state, action) {\n  switch (action.type) {\n    case 'SELECT_CURRENCY': {\n      return {\n        ...state,\n        outputCurrency: action.payload\n      }\n    }\n    case 'UPDATE_VALUE': {\n      const { inputValue, outputValue } = state\n      const { field, value } = action.payload\n      return {\n        ...state,\n        inputValue: field === INPUT ? value : inputValue,\n        outputValue: field === OUTPUT ? value : outputValue,\n        lastEditedField: field\n      }\n    }\n    case 'UPDATE_DEPENDENT_VALUE': {\n      const { inputValue, outputValue } = state\n      const { field, value } = action.payload\n      return {\n        ...state,\n        inputValue: field === INPUT ? value : inputValue,\n        outputValue: field === OUTPUT ? value : outputValue\n      }\n    }\n    default: {\n      return initialAddLiquidityState\n    }\n  }\n}\n\nfunction getExchangeRate(inputValue, inputDecimals, outputValue, outputDecimals, invert = false) {\n  try {\n    if (\n      inputValue &&\n      (inputDecimals || inputDecimals === 0) &&\n      outputValue &&\n      (outputDecimals || outputDecimals === 0)\n    ) {\n      const factor = ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))\n\n      if (invert) {\n        return inputValue\n          .mul(factor)\n          .div(outputValue)\n          .mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(outputDecimals)))\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(inputDecimals)))\n      } else {\n        return outputValue\n          .mul(factor)\n          .div(inputValue)\n          .mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(inputDecimals)))\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(outputDecimals)))\n      }\n    }\n  } catch {}\n}\n\nfunction getMarketRate(reserveETH, reserveToken, decimals, invert = false) {\n  return getExchangeRate(reserveETH, 18, reserveToken, decimals, invert)\n}\n\nexport default function AddLiquidity() {\n  const { t } = useTranslation()\n  const { library, active, account } = useWeb3Context()\n\n  const [addLiquidityState, dispatchAddLiquidityState] = useReducer(addLiquidityStateReducer, initialAddLiquidityState)\n  const { inputValue, outputValue, lastEditedField, outputCurrency } = addLiquidityState\n  const inputCurrency = 'ETH'\n\n  const [inputValueParsed, setInputValueParsed] = useState()\n  const [outputValueParsed, setOutputValueParsed] = useState()\n  const [inputError, setInputError] = useState()\n  const [outputError, setOutputError] = useState()\n\n  const { symbol, decimals, exchangeAddress } = useTokenDetails(outputCurrency)\n  const exchangeContract = useExchangeContract(exchangeAddress)\n\n  const [totalPoolTokens, setTotalPoolTokens] = useState()\n  const fetchPoolTokens = useCallback(() => {\n    if (exchangeContract) {\n      exchangeContract.totalSupply().then(totalSupply => {\n        setTotalPoolTokens(totalSupply)\n      })\n    }\n  }, [exchangeContract])\n  useEffect(() => {\n    fetchPoolTokens()\n    library.on('block', fetchPoolTokens)\n\n    return () => {\n      library.removeListener('block', fetchPoolTokens)\n    }\n  }, [fetchPoolTokens, library])\n\n  const poolTokenBalance = useAddressBalance(account, exchangeAddress)\n  const exchangeETHBalance = useAddressBalance(exchangeAddress, 'ETH')\n  const exchangeTokenBalance = useAddressBalance(exchangeAddress, outputCurrency)\n\n  const { reserveETH, reserveToken } = useExchangeReserves(outputCurrency)\n  const isNewExchange = !!(reserveETH && reserveToken && reserveETH.isZero() && reserveToken.isZero())\n\n  // 18 decimals\n  const poolTokenPercentage =\n    poolTokenBalance && totalPoolTokens && isNewExchange === false && !totalPoolTokens.isZero()\n      ? poolTokenBalance.mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(totalPoolTokens)\n      : undefined\n  const ethShare =\n    exchangeETHBalance && poolTokenPercentage\n      ? exchangeETHBalance\n          .mul(poolTokenPercentage)\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18)))\n      : undefined\n  const tokenShare =\n    exchangeTokenBalance && poolTokenPercentage\n      ? exchangeTokenBalance\n          .mul(poolTokenPercentage)\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18)))\n      : undefined\n\n  const liquidityMinted = isNewExchange\n    ? inputValueParsed\n    : totalPoolTokens && inputValueParsed && exchangeETHBalance && !exchangeETHBalance.isZero()\n    ? totalPoolTokens.mul(inputValueParsed).div(exchangeETHBalance)\n    : undefined\n\n  // user balances\n  const inputBalance = useAddressBalance(account, inputCurrency)\n  const outputBalance = useAddressBalance(account, outputCurrency)\n\n  const ethPerLiquidityToken =\n    exchangeETHBalance && totalPoolTokens && isNewExchange === false && !totalPoolTokens.isZero()\n      ? exchangeETHBalance.mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(totalPoolTokens)\n      : undefined\n  const tokenPerLiquidityToken =\n    exchangeTokenBalance && totalPoolTokens && isNewExchange === false && !totalPoolTokens.isZero()\n      ? exchangeTokenBalance.mul(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18))).div(totalPoolTokens)\n      : undefined\n\n  const outputValueMax = outputValueParsed && calculateSlippageBounds(outputValueParsed).maximum\n  const liquidityTokensMin = liquidityMinted && calculateSlippageBounds(liquidityMinted).minimum\n\n  const marketRate = useMemo(() => {\n    return getMarketRate(reserveETH, reserveToken, decimals)\n  }, [reserveETH, reserveToken, decimals])\n  const marketRateInverted = useMemo(() => {\n    return getMarketRate(reserveETH, reserveToken, decimals, true)\n  }, [reserveETH, reserveToken, decimals])\n\n  function renderTransactionDetails() {\n    ReactGA.event({\n      category: 'TransactionDetail',\n      action: 'Open'\n    })\n\n    const b = text => <BlueSpan>{text}</BlueSpan>\n\n    if (isNewExchange) {\n      return (\n        <div>\n          <div>\n            {t('youAreAdding')} {b(`${inputValue} ETH`)} {t('and')} {b(`${outputValue} ${symbol}`)} {t('intoPool')}\n          </div>\n          <LastSummaryText>\n            {t('youAreSettingExRate')}{' '}\n            {b(\n              `1 ETH = ${amountFormatter(\n                getMarketRate(inputValueParsed, outputValueParsed, decimals),\n                18,\n                4,\n                false\n              )} ${symbol}`\n            )}\n            .\n          </LastSummaryText>\n          <LastSummaryText>\n            {t('youWillMint')} {b(`${inputValue}`)} {t('liquidityTokens')}\n          </LastSummaryText>\n          <LastSummaryText>{t('totalSupplyIs0')}</LastSummaryText>\n        </div>\n      )\n    } else {\n      return (\n        <>\n          <div>\n            {t('youAreAdding')} {b(`${amountFormatter(inputValueParsed, 18, 4)} ETH`)} {t('and')} {'at most'}{' '}\n            {b(`${amountFormatter(outputValueMax, decimals, 4)} ${symbol}`)} {t('intoPool')}\n          </div>\n          <LastSummaryText>\n            {t('youWillMint')} {b(amountFormatter(liquidityMinted, 18, 4))} {t('liquidityTokens')}\n          </LastSummaryText>\n          <LastSummaryText>\n            {t('totalSupplyIs')} {b(amountFormatter(totalPoolTokens, 18, 4))}\n          </LastSummaryText>\n          <LastSummaryText>\n            {t('tokenWorth')} {b(amountFormatter(ethPerLiquidityToken, 18, 4))} ETH {t('and')}{' '}\n            {b(amountFormatter(tokenPerLiquidityToken, decimals, Math.min(decimals, 4)))} {symbol}\n          </LastSummaryText>\n        </>\n      )\n    }\n  }\n\n  function renderSummary() {\n    let contextualInfo = ''\n    let isError = false\n\n    if (inputError || outputError) {\n      contextualInfo = inputError || outputError\n      isError = true\n    } else if (!inputCurrency || !outputCurrency) {\n      contextualInfo = t('selectTokenCont')\n    } else if (!inputValue) {\n      contextualInfo = t('enterValueCont')\n    } else if (!account) {\n      contextualInfo = t('noWallet')\n      isError = true\n    }\n\n    return (\n      <ContextualInfo\n        openDetailsText={t('transactionDetails')}\n        closeDetailsText={t('hideDetails')}\n        contextualInfo={contextualInfo}\n        isError={isError}\n        renderTransactionDetails={renderTransactionDetails}\n      />\n    )\n  }\n\n  const addTransaction = useTransactionAdder()\n\n  const isActive = active && account\n  const isValid = inputError === null || outputError === null\n\n  async function onAddLiquidity() {\n    ReactGA.event({\n      category: 'Pool',\n      action: 'AddLiquidity'\n    })\n\n    const deadline = Math.ceil(Date.now() / 1000) + DEADLINE_FROM_NOW\n    const estimatedGasLimit = await exchangeContract.estimate.addLiquidity(\n      isNewExchange ? ethers.constants.Zero : liquidityTokensMin,\n      isNewExchange ? outputValueParsed : outputValueMax,\n      deadline,\n      {\n        value: inputValueParsed\n      }\n    )\n\n    exchangeContract\n      .addLiquidity(\n        isNewExchange ? ethers.constants.Zero : liquidityTokensMin,\n        isNewExchange ? outputValueParsed : outputValueMax,\n        deadline,\n        {\n          value: inputValueParsed,\n          gasLimit: calculateGasMargin(estimatedGasLimit, GAS_MARGIN)\n        }\n      )\n      .then(response => {\n        addTransaction(response)\n      })\n  }\n\n  function formatBalance(value) {\n    return `Balance: ${value}`\n  }\n\n  useEffect(() => {\n    if (isNewExchange) {\n      if (inputValue) {\n        const parsedInputValue = ethers.utils.parseUnits(inputValue, 18)\n        setInputValueParsed(parsedInputValue)\n      }\n\n      if (outputValue) {\n        const parsedOutputValue = ethers.utils.parseUnits(outputValue, decimals)\n        setOutputValueParsed(parsedOutputValue)\n      }\n    }\n  }, [decimals, inputValue, isNewExchange, outputValue])\n\n  // parse input value\n  useEffect(() => {\n    if (isNewExchange === false && inputValue && marketRate && lastEditedField === INPUT && decimals) {\n      try {\n        const parsedValue = ethers.utils.parseUnits(inputValue, 18)\n\n        if (parsedValue.lte(ethers.constants.Zero) || parsedValue.gte(ethers.constants.MaxUint256)) {\n          throw Error()\n        }\n\n        setInputValueParsed(parsedValue)\n\n        const currencyAmount = marketRate\n          .mul(parsedValue)\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18)))\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(18 - decimals)))\n\n        setOutputValueParsed(currencyAmount)\n        dispatchAddLiquidityState({\n          type: 'UPDATE_DEPENDENT_VALUE',\n          payload: { field: OUTPUT, value: amountFormatter(currencyAmount, decimals, 4, false) }\n        })\n\n        return () => {\n          setOutputError()\n          setInputValueParsed()\n          setOutputValueParsed()\n          dispatchAddLiquidityState({\n            type: 'UPDATE_DEPENDENT_VALUE',\n            payload: { field: OUTPUT, value: '' }\n          })\n        }\n      } catch {\n        setOutputError(t('inputNotValid'))\n      }\n    }\n  }, [inputValue, isNewExchange, lastEditedField, marketRate, decimals, t])\n\n  // parse output value\n  useEffect(() => {\n    if (isNewExchange === false && outputValue && marketRateInverted && lastEditedField === OUTPUT && decimals) {\n      try {\n        const parsedValue = ethers.utils.parseUnits(outputValue, decimals)\n\n        if (parsedValue.lte(ethers.constants.Zero) || parsedValue.gte(ethers.constants.MaxUint256)) {\n          throw Error()\n        }\n\n        setOutputValueParsed(parsedValue)\n\n        const currencyAmount = marketRateInverted\n          .mul(parsedValue)\n          .div(ethers.utils.bigNumberify(10).pow(ethers.utils.bigNumberify(decimals)))\n\n        setInputValueParsed(currencyAmount)\n        dispatchAddLiquidityState({\n          type: 'UPDATE_DEPENDENT_VALUE',\n          payload: { field: INPUT, value: amountFormatter(currencyAmount, 18, 4, false) }\n        })\n\n        return () => {\n          setInputError()\n          setOutputValueParsed()\n          setInputValueParsed()\n          dispatchAddLiquidityState({\n            type: 'UPDATE_DEPENDENT_VALUE',\n            payload: { field: INPUT, value: '' }\n          })\n        }\n      } catch {\n        setInputError(t('inputNotValid'))\n      }\n    }\n  }, [outputValue, isNewExchange, lastEditedField, marketRateInverted, decimals, t])\n\n  // input validation\n  useEffect(() => {\n    if (inputValueParsed && inputBalance) {\n      if (inputValueParsed.gt(inputBalance)) {\n        setInputError(t('insufficientBalance'))\n      } else {\n        setInputError(null)\n      }\n    }\n\n    if (outputValueMax && outputBalance) {\n      if (outputValueMax.gt(outputBalance)) {\n        setOutputError(t('insufficientBalance'))\n      } else {\n        setOutputError(null)\n      }\n    }\n  }, [inputValueParsed, inputBalance, outputValueMax, outputBalance, t])\n\n  const allowance = useAddressAllowance(account, outputCurrency, exchangeAddress)\n  const [showUnlock, setShowUnlock] = useState(false)\n  useEffect(() => {\n    if (outputValueParsed && allowance) {\n      if (allowance.lt(outputValueParsed)) {\n        setOutputError(t('unlockTokenCont'))\n        setShowUnlock(true)\n      }\n      return () => {\n        setOutputError()\n        setShowUnlock(false)\n      }\n    }\n  }, [outputValueParsed, allowance, t])\n\n  return (\n    <>\n      {isNewExchange ? (\n        <NewExchangeWarning>\n          <NewExchangeWarningText>\n            <span role=\"img\" aria-label=\"first-liquidity\">\n              🚰\n            </span>{' '}\n            {t('firstLiquidity')}\n          </NewExchangeWarningText>\n          <NewExchangeWarningText>{t('initialExchangeRate', { symbol })}</NewExchangeWarningText>\n        </NewExchangeWarning>\n      ) : null}\n\n      <CurrencyInputPanel\n        title={t('deposit')}\n        extraText={inputBalance && formatBalance(amountFormatter(inputBalance, 18, 4))}\n        onValueChange={inputValue => {\n          dispatchAddLiquidityState({ type: 'UPDATE_VALUE', payload: { value: inputValue, field: INPUT } })\n        }}\n        selectedTokenAddress=\"ETH\"\n        value={inputValue}\n        errorMessage={inputError}\n        disableTokenSelect\n      />\n      <OversizedPanel>\n        <DownArrowBackground>\n          <DownArrow src={isActive ? PlusBlue : PlusGrey} alt=\"plus\" />\n        </DownArrowBackground>\n      </OversizedPanel>\n      <CurrencyInputPanel\n        title={t('deposit')}\n        description={isNewExchange ? '' : outputValue ? `(${t('estimated')})` : ''}\n        extraText={outputBalance && formatBalance(amountFormatter(outputBalance, decimals, Math.min(decimals, 4)))}\n        selectedTokenAddress={outputCurrency}\n        onCurrencySelected={outputCurrency => {\n          dispatchAddLiquidityState({ type: 'SELECT_CURRENCY', payload: outputCurrency })\n        }}\n        onValueChange={outputValue => {\n          dispatchAddLiquidityState({ type: 'UPDATE_VALUE', payload: { value: outputValue, field: OUTPUT } })\n        }}\n        value={outputValue}\n        showUnlock={showUnlock}\n        errorMessage={outputError}\n      />\n      <OversizedPanel hideBottom>\n        <SummaryPanel>\n          <ExchangeRateWrapper>\n            <ExchangeRate>{t('exchangeRate')}</ExchangeRate>\n            <span>{marketRate ? `1 ETH = ${amountFormatter(marketRate, 18, 4)} ${symbol}` : ' - '}</span>\n          </ExchangeRateWrapper>\n          <ExchangeRateWrapper>\n            <ExchangeRate>{t('currentPoolSize')}</ExchangeRate>\n            <span>\n              {exchangeETHBalance && exchangeTokenBalance\n                ? `${amountFormatter(exchangeETHBalance, 18, 4)} ETH + ${amountFormatter(\n                    exchangeTokenBalance,\n                    decimals,\n                    Math.min(4, decimals)\n                  )} ${symbol}`\n                : ' - '}\n            </span>\n          </ExchangeRateWrapper>\n          <ExchangeRateWrapper>\n            <ExchangeRate>\n              {t('yourPoolShare')} ({exchangeETHBalance && amountFormatter(poolTokenPercentage, 16, 2)}%)\n            </ExchangeRate>\n            <span>\n              {ethShare && tokenShare\n                ? `${amountFormatter(ethShare, 18, 4)} ETH + ${amountFormatter(\n                    tokenShare,\n                    decimals,\n                    Math.min(4, decimals)\n                  )} ${symbol}`\n                : ' - '}\n            </span>\n          </ExchangeRateWrapper>\n        </SummaryPanel>\n      </OversizedPanel>\n      {renderSummary()}\n      <Flex>\n        <Button disabled={!isValid} onClick={onAddLiquidity}>\n          {t('addLiquidity')}\n        </Button>\n      </Flex>\n    </>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}