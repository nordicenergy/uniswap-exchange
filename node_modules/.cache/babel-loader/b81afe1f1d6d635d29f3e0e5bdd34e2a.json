{"ast":null,"code":"import _defineProperty from\"/workspace/uniswap-exchange/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/workspace/uniswap-exchange/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/workspace/uniswap-exchange/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/workspace/uniswap-exchange/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/workspace/uniswap-exchange/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject30(){var data=_taggedTemplateLiteral([\"\\n  margin: 0 0.25rem 0 0.25rem;\\n  color: \",\";\\n  opacity: 0.6;\\n\"]);_templateObject30=function _templateObject30(){return data;};return data;}function _templateObject29(){var data=_taggedTemplateLiteral([\"\\n  margin: 0 0.25rem 0 0.25rem;\\n\"]);_templateObject29=function _templateObject29(){return data;};return data;}function _templateObject28(){var data=_taggedTemplateLiteral([\"\\n  \",\";\\n  align-items: flex-end;\\n\"]);_templateObject28=function _templateObject28(){return data;};return data;}function _templateObject27(){var data=_taggedTemplateLiteral([\"\\n  font-size: 1rem;\\n  line-height: 1.5rem;\\n  color: \",\";\\n\"]);_templateObject27=function _templateObject27(){return data;};return data;}function _templateObject26(){var data=_taggedTemplateLiteral([\"\\n  font-size: 1rem;\\n  line-height: 20px;\\n\"]);_templateObject26=function _templateObject26(){return data;};return data;}function _templateObject25(){var data=_taggedTemplateLiteral([\"\\n  color: \",\";\\n\"]);_templateObject25=function _templateObject25(){return data;};return data;}function _templateObject24(){var data=_taggedTemplateLiteral([\"\\n  color: \",\";\\n\"]);_templateObject24=function _templateObject24(){return data;};return data;}function _templateObject23(){var data=_taggedTemplateLiteral([\"\\n  \",\";\\n  margin-left: 1rem;\\n\"]);_templateObject23=function _templateObject23(){return data;};return data;}function _templateObject22(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  align-items : center;\\n\"]);_templateObject22=function _templateObject22(){return data;};return data;}function _templateObject21(){var data=_taggedTemplateLiteral([\"\\n    padding: 0.8rem 1rem;\\n    padding-right: 2rem;\\n  \"]);_templateObject21=function _templateObject21(){return data;};return data;}function _templateObject20(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  align-items: center;\\n  justify-content: space-between;\\n  padding: 1rem;\\n  cursor: pointer;\\n  user-select: none;\\n  #symbol {\\n    color: \",\";\\n  }\\n  :hover {\\n    background-color: \",\";\\n  }\\n  \",\"\\n\"]);_templateObject20=function _templateObject20(){return data;};return data;}function _templateObject19(){var data=_taggedTemplateLiteral([\"\\n  flex-grow: 1;\\n  height: 100%;\\n  overflow-y: auto;\\n  -webkit-overflow-scrolling: touch;\\n\"]);_templateObject19=function _templateObject19(){return data;};return data;}function _templateObject18(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  align-items: center;\\n  padding: 1rem 1.5rem;\\n  margin: 0.25rem 0.5rem;\\n  justify-content: center;\\n  user-select: none;\\n\"]);_templateObject18=function _templateObject18(){return data;};return data;}function _templateObject17(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  justify-content: flex-start;\\n  padding: 0.5rem 1.5rem;\\n  background-color: \",\";\\n\"]);_templateObject17=function _templateObject17(){return data;};return data;}function _templateObject16(){var data=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  right: 1rem;\\n  top: 14px;\\n  &:hover {\\n    cursor: pointer;\\n    opacity: 0.6;\\n  }\\n\"]);_templateObject16=function _templateObject16(){return data;};return data;}function _templateObject15(){var data=_taggedTemplateLiteral([\"\\n  path {\\n    stroke: \",\";\\n  }\\n\"]);_templateObject15=function _templateObject15(){return data;};return data;}function _templateObject14(){var data=_taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n  padding: 0px 0px 0px 1rem;\\n  height: 60px;\\n\"]);_templateObject14=function _templateObject14(){return data;};return data;}function _templateObject13(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  width: 100%;\\n\"]);_templateObject13=function _templateObject13(){return data;};return data;}function _templateObject12(){var data=_taggedTemplateLiteral([\"\\n  color: \",\";\\n  :hover {\\n    cursor: pointer;\\n    color: \",\";\\n  }\\n\"]);_templateObject12=function _templateObject12(){return data;};return data;}function _templateObject11(){var data=_taggedTemplateLiteral([\"\\n  flex: 1 1 auto;\\n  width: 0;\\n  overflow: hidden;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n\"]);_templateObject11=function _templateObject11(){return data;};return data;}function _templateObject10(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  align-items: center;\\n  color: \",\";\\n  font-size: 0.75rem;\\n  line-height: 1rem;\\n  padding: 0.75rem 1rem;\\n  span:hover {\\n    cursor: pointer;\\n    color: \",\";\\n  }\\n\"]);_templateObject10=function _templateObject10(){return data;};return data;}function _templateObject9(){var data=_taggedTemplateLiteral([\"\\n  border-radius: 1.25rem;\\n  border: 1px solid \",\";\\n  background-color: \",\";\\n  :focus-within {\\n    border: 1px solid \",\";\\n  }\\n\"]);_templateObject9=function _templateObject9(){return data;};return data;}function _templateObject8(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  box-shadow: 0 4px 8px 0 \",\";\\n  position: relative;\\n  border-radius: 1.25rem;\\n  background-color: \",\";\\n  z-index: 1;\\n\"]);_templateObject8=function _templateObject8(){return data;};return data;}function _templateObject7(){var data=_taggedTemplateLiteral([\"\\n  margin: 0 0.5rem 0 0.5rem;\\n  height: 35%;\\n  path {\\n    stroke: \",\";\\n  }\\n\"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\\n  align-items: center;\\n  font-size: 1rem;\\n  color: \",\";\\n  height: 2rem;\\n  border: 1px solid \",\";\\n  border-radius: 2.5rem;\\n  background-color: \",\";\\n  outline: none;\\n  cursor: pointer;\\n  user-select: none;\\n  :hover {\\n    border: 1px solid\\n      \",\";\\n  }\\n  :focus {\\n    border: 1px solid \",\";\\n  }\\n  :active {\\n    background-color: \",\";\\n  }\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  min-height: 2.5rem;\\n  flex-shrink: 0;\\n  text-align: left;\\n  padding-left: 1.6rem;\\n  background-color: \",\";\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  font-size: 1.5rem;\\n  color: \",\";\\n  background-color: \",\";\\n  -moz-appearance: textfield;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  align-items: center;\\n  padding: 0.25rem 0.85rem 0.75rem;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  \",\"\\n  padding: 4px 50px 4px 15px;\\n  margin-right: -40px;\\n  line-height: 0;\\n  height: 2rem;\\n  align-items: center;\\n  border-radius: 2.5rem;\\n  outline: none;\\n  cursor: pointer;\\n  user-select: none;\\n  background: \",\";\\n  border: 1px solid \",\";\\n  color: \",\";\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useRef,useMemo}from'react';import{Link}from'react-router-dom';import{useTranslation}from'react-i18next';import{ethers}from'ethers';import{BigNumber}from'@uniswap/sdk';import styled from'styled-components';import escapeStringRegex from'escape-string-regexp';import{darken}from'polished';import Tooltip from'@reach/tooltip';import'@reach/tooltip/styles.css';import{isMobile}from'react-device-detect';import{BorderlessInput}from'../../theme';import{useWeb3React,useTokenContract}from'../../hooks';import{isAddress,calculateGasMargin,formatToUsd,formatTokenBalance,formatEthBalance}from'../../utils';import{ReactComponent as DropDown}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../assets/images/dropdown.svg\";import Modal from'../Modal';import TokenLogo from'../TokenLogo';import SearchIcon from\"../../assets/images/magnifying-glass.svg\";import{useTransactionAdder,usePendingApproval}from'../../contexts/Transactions';import{useTokenDetails,useAllTokenDetails,INITIAL_TOKENS_CONTEXT}from'../../contexts/Tokens';import{useAddressBalance}from'../../contexts/Balances';import{ReactComponent as Close}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../assets/images/x.svg\";import{transparentize}from'polished';import{Spinner}from'../../theme';import Circle from\"../../assets/images/circle-grey.svg\";import{useETHPriceInUSD,useAllBalances}from'../../contexts/Balances';var GAS_MARGIN=ethers.utils.bigNumberify(1000);var SubCurrencySelect=styled.button(_templateObject(),function(_ref){var theme=_ref.theme;return theme.flexRowNoWrap;},function(_ref2){var theme=_ref2.theme;return theme.zumthorBlue;},function(_ref3){var theme=_ref3.theme;return theme.royalBlue;},function(_ref4){var theme=_ref4.theme;return theme.royalBlue;});var InputRow=styled.div(_templateObject2(),function(_ref5){var theme=_ref5.theme;return theme.flexRowNoWrap;});var Input=styled(BorderlessInput)(_templateObject3(),function(_ref6){var error=_ref6.error,theme=_ref6.theme;return error&&theme.salmonRed;},function(_ref7){var theme=_ref7.theme;return theme.inputBackground;});var StyledBorderlessInput=styled(BorderlessInput)(_templateObject4(),function(_ref8){var theme=_ref8.theme;return theme.concreteGray;});var CurrencySelect=styled.button(_templateObject5(),function(_ref9){var selected=_ref9.selected,theme=_ref9.theme;return selected?theme.textColor:theme.royalBlue;},function(_ref10){var selected=_ref10.selected,theme=_ref10.theme;return selected?theme.mercuryGray:theme.royalBlue;},function(_ref11){var selected=_ref11.selected,theme=_ref11.theme;return selected?theme.concreteGray:theme.zumthorBlue;},function(_ref12){var selected=_ref12.selected,theme=_ref12.theme;return selected?darken(0.1,theme.mercuryGray):darken(0.1,theme.royalBlue);},function(_ref13){var theme=_ref13.theme;return darken(0.1,theme.royalBlue);},function(_ref14){var theme=_ref14.theme;return theme.zumthorBlue;});var Aligner=styled.span(_templateObject6());var StyledDropDown=styled(DropDown)(_templateObject7(),function(_ref15){var selected=_ref15.selected,theme=_ref15.theme;return selected?theme.textColor:theme.royalBlue;});var InputPanel=styled.div(_templateObject8(),function(_ref16){var theme=_ref16.theme;return theme.flexColumnNoWrap;},function(_ref17){var theme=_ref17.theme;return transparentize(0.95,theme.shadowColor);},function(_ref18){var theme=_ref18.theme;return theme.inputBackground;});var Container=styled.div(_templateObject9(),function(_ref19){var error=_ref19.error,theme=_ref19.theme;return error?theme.salmonRed:theme.mercuryGray;},function(_ref20){var theme=_ref20.theme;return theme.inputBackground;},function(_ref21){var theme=_ref21.theme;return theme.malibuBlue;});var LabelRow=styled.div(_templateObject10(),function(_ref22){var theme=_ref22.theme;return theme.flexRowNoWrap;},function(_ref23){var theme=_ref23.theme;return theme.doveGray;},function(_ref24){var theme=_ref24.theme;return darken(0.2,theme.doveGray);});var LabelContainer=styled.div(_templateObject11());var ErrorSpan=styled.span(_templateObject12(),function(_ref25){var error=_ref25.error,theme=_ref25.theme;return error&&theme.salmonRed;},function(_ref26){var error=_ref26.error,theme=_ref26.theme;return error&&darken(0.1,theme.salmonRed);});var TokenModal=styled.div(_templateObject13(),function(_ref27){var theme=_ref27.theme;return theme.flexColumnNoWrap;});var ModalHeader=styled.div(_templateObject14());var CloseColor=styled(Close)(_templateObject15(),function(_ref28){var theme=_ref28.theme;return theme.textColor;});var CloseIcon=styled.div(_templateObject16());var SearchContainer=styled.div(_templateObject17(),function(_ref29){var theme=_ref29.theme;return theme.flexRowNoWrap;},function(_ref30){var theme=_ref30.theme;return theme.concreteGray;});var TokenModalInfo=styled.div(_templateObject18(),function(_ref31){var theme=_ref31.theme;return theme.flexRowNoWrap;});var TokenList=styled.div(_templateObject19());var TokenModalRow=styled.div(_templateObject20(),function(_ref32){var theme=_ref32.theme;return theme.flexRowNoWrap;},function(_ref33){var theme=_ref33.theme;return theme.doveGrey;},function(_ref34){var theme=_ref34.theme;return theme.tokenRowHover;},function(_ref35){var theme=_ref35.theme;return theme.mediaWidth.upToMedium(_templateObject21());});var TokenRowLeft=styled.div(_templateObject22(),function(_ref36){var theme=_ref36.theme;return theme.flexRowNoWrap;});var TokenSymbolGroup=styled.div(_templateObject23(),function(_ref37){var theme=_ref37.theme;return theme.flexColumnNoWrap;});var TokenFullName=styled.div(_templateObject24(),function(_ref38){var theme=_ref38.theme;return theme.chaliceGray;});var FadedSpan=styled.span(_templateObject25(),function(_ref39){var theme=_ref39.theme;return theme.royalBlue;});var TokenRowBalance=styled.div(_templateObject26());var TokenRowUsd=styled.div(_templateObject27(),function(_ref40){var theme=_ref40.theme;return theme.chaliceGray;});var TokenRowRight=styled.div(_templateObject28(),function(_ref41){var theme=_ref41.theme;return theme.flexColumnNoWrap;});var StyledTokenName=styled.span(_templateObject29());var SpinnerWrapper=styled(Spinner)(_templateObject30(),function(_ref42){var theme=_ref42.theme;return theme.chaliceGray;});export default function CurrencyInputPanel(_ref43){var _ref43$onValueChange=_ref43.onValueChange,onValueChange=_ref43$onValueChange===void 0?function(){}:_ref43$onValueChange,allBalances=_ref43.allBalances,renderInput=_ref43.renderInput,_ref43$onCurrencySele=_ref43.onCurrencySelected,onCurrencySelected=_ref43$onCurrencySele===void 0?function(){}:_ref43$onCurrencySele,title=_ref43.title,description=_ref43.description,extraText=_ref43.extraText,_ref43$extraTextClick=_ref43.extraTextClickHander,extraTextClickHander=_ref43$extraTextClick===void 0?function(){}:_ref43$extraTextClick,errorMessage=_ref43.errorMessage,disableUnlock=_ref43.disableUnlock,disableTokenSelect=_ref43.disableTokenSelect,_ref43$selectedTokenA=_ref43.selectedTokenAddress,selectedTokenAddress=_ref43$selectedTokenA===void 0?'':_ref43$selectedTokenA,showUnlock=_ref43.showUnlock,value=_ref43.value,urlAddedTokens=_ref43.urlAddedTokens;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalIsOpen=_useState2[0],setModalIsOpen=_useState2[1];var tokenContract=useTokenContract(selectedTokenAddress);var _useTokenDetails=useTokenDetails(selectedTokenAddress),selectedTokenExchangeAddress=_useTokenDetails.exchangeAddress;var pendingApproval=usePendingApproval(selectedTokenAddress);var addTransaction=useTransactionAdder();var allTokens=useAllTokenDetails();var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var userTokenBalance=useAddressBalance(account,selectedTokenAddress);function renderUnlockButton(){if(disableUnlock||!showUnlock||selectedTokenAddress==='ETH'||!selectedTokenAddress){return null;}else{if(!pendingApproval){return React.createElement(SubCurrencySelect,{onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var estimatedGas,useUserBalance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:useUserBalance=false;_context.next=3;return tokenContract.estimate.approve(selectedTokenExchangeAddress,ethers.constants.MaxUint256).catch(function(e){console.log('Error setting max token approval.');});case 3:estimatedGas=_context.sent;if(estimatedGas){_context.next=9;break;}_context.next=7;return tokenContract.estimate.approve(selectedTokenExchangeAddress,userTokenBalance);case 7:estimatedGas=_context.sent;useUserBalance=true;case 9:tokenContract.approve(selectedTokenExchangeAddress,useUserBalance?userTokenBalance:ethers.constants.MaxUint256,{gasLimit:calculateGasMargin(estimatedGas,GAS_MARGIN)}).then(function(response){addTransaction(response,{approval:selectedTokenAddress});});case 10:case\"end\":return _context.stop();}}},_callee);}))},t('unlock'));}else{return React.createElement(SubCurrencySelect,null,t('pending'));}}}function _renderInput(){if(typeof renderInput==='function'){return renderInput();}return React.createElement(InputRow,null,React.createElement(Input,{type:\"number\",min:\"0\",step:\"0.000000000000000001\",error:!!errorMessage,placeholder:\"0.0\",onChange:function onChange(e){return onValueChange(e.target.value);},onKeyPress:function onKeyPress(e){var charCode=e.which?e.which:e.keyCode;// Prevent 'minus' character\nif(charCode===45){e.preventDefault();e.stopPropagation();}},value:value}),renderUnlockButton(),React.createElement(CurrencySelect,{selected:!!selectedTokenAddress,onClick:function onClick(){if(!disableTokenSelect){setModalIsOpen(true);}}},React.createElement(Aligner,null,selectedTokenAddress?React.createElement(TokenLogo,{address:selectedTokenAddress}):null,React.createElement(StyledTokenName,null,allTokens[selectedTokenAddress]&&allTokens[selectedTokenAddress].symbol||t('selectToken')),!disableTokenSelect&&React.createElement(StyledDropDown,{selected:!!selectedTokenAddress}))));}return React.createElement(InputPanel,null,React.createElement(Container,{error:!!errorMessage},React.createElement(LabelRow,null,React.createElement(LabelContainer,null,React.createElement(\"span\",null,title),\" \",React.createElement(\"span\",null,description)),React.createElement(ErrorSpan,{\"data-tip\":'Enter max',error:!!errorMessage,onClick:function onClick(){extraTextClickHander();}},React.createElement(Tooltip,{label:\"Enter Max\",style:{background:'hsla(48, 100%, 50%)',color:'white',border:'none',borderRadius:'24px',padding:'0.5em 1em',marginTop:'-64px'}},React.createElement(\"span\",null,extraText)))),_renderInput()),!disableTokenSelect&&React.createElement(CurrencySelectModal,{isOpen:modalIsOpen,onDismiss:function onDismiss(){setModalIsOpen(false);},urlAddedTokens:urlAddedTokens,onTokenSelect:onCurrencySelected,allBalances:allBalances}));}function CurrencySelectModal(_ref45){var isOpen=_ref45.isOpen,onDismiss=_ref45.onDismiss,onTokenSelect=_ref45.onTokenSelect,urlAddedTokens=_ref45.urlAddedTokens;var _useTranslation2=useTranslation(),t=_useTranslation2.t;var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchQuery=_useState4[0],setSearchQuery=_useState4[1];var _useTokenDetails2=useTokenDetails(searchQuery),exchangeAddress=_useTokenDetails2.exchangeAddress;var allTokens=useAllTokenDetails();var _useWeb3React2=useWeb3React(),account=_useWeb3React2.account,chainId=_useWeb3React2.chainId;// BigNumber.js instance\nvar ethPrice=useETHPriceInUSD();// all balances for both account and exchanges\nvar allBalances=useAllBalances();var _usdAmounts=Object.keys(allTokens).map(function(k){if(ethPrice&&allBalances[account]&&allBalances[account][k]&&allBalances[account][k].value){var ethRate=1;// default for ETH\nvar exchangeDetails=allBalances[allTokens[k].exchangeAddress];if(exchangeDetails&&exchangeDetails[k]&&exchangeDetails[k].value&&exchangeDetails['ETH']&&exchangeDetails['ETH'].value){var tokenBalance=new BigNumber(exchangeDetails[k].value.toString());var ethBalance=new BigNumber(exchangeDetails['ETH'].value.toString());ethRate=ethBalance.div(tokenBalance);}var USDRate=ethPrice.times(ethRate).times(new BigNumber(10).pow(allTokens[k].decimals).div(new BigNumber(10).pow(18)));var balanceBigNumber=new BigNumber(allBalances[account][k].value.toString());var usdBalance=balanceBigNumber.times(USDRate).div(new BigNumber(10).pow(allTokens[k].decimals));return usdBalance;}else{return null;}});var usdAmounts=_usdAmounts&&Object.keys(allTokens).reduce(function(accumulator,currentValue,i){return Object.assign(_defineProperty({},currentValue,_usdAmounts[i]),accumulator);},{});var tokenList=useMemo(function(){return Object.keys(allTokens).sort(function(a,b){if(allTokens[a].symbol&&allTokens[b].symbol){var aSymbol=allTokens[a].symbol.toLowerCase();var bSymbol=allTokens[b].symbol.toLowerCase();// pin ETH to top\nif(aSymbol==='ETH'.toLowerCase()||bSymbol==='ETH'.toLowerCase()){return aSymbol===bSymbol?0:aSymbol==='ETH'.toLowerCase()?-1:1;}// then tokens with balance\nif(usdAmounts[a]&&!usdAmounts[b]){return-1;}else if(usdAmounts[b]&&!usdAmounts[a]){return 1;}// sort by balance\nif(usdAmounts[a]&&usdAmounts[b]){var aUSD=usdAmounts[a];var bUSD=usdAmounts[b];return aUSD.gt(bUSD)?-1:aUSD.lt(bUSD)?1:0;}// sort alphabetically\nreturn aSymbol<bSymbol?-1:aSymbol>bSymbol?1:0;}else{return 0;}}).map(function(k){var balance;var usdBalance;// only update if we have data\nif(k==='ETH'&&allBalances[account]&&allBalances[account][k]&&allBalances[account][k].value){balance=formatEthBalance(allBalances[account][k].value);usdBalance=usdAmounts[k];}else if(allBalances[account]&&allBalances[account][k]&&allBalances[account][k].value){balance=formatTokenBalance(allBalances[account][k].value,allTokens[k].decimals);usdBalance=usdAmounts[k];}return{name:allTokens[k].name,symbol:allTokens[k].symbol,address:k,balance:balance,usdBalance:usdBalance};});},[allBalances,allTokens,usdAmounts,account]);var filteredTokenList=useMemo(function(){return tokenList.filter(function(tokenEntry){var inputIsAddress=searchQuery.slice(0,2)==='0x';// check the regex for each field\nvar regexMatches=Object.keys(tokenEntry).map(function(tokenEntryKey){// if address field only search if input starts with 0x\nif(tokenEntryKey==='address'){return inputIsAddress&&typeof tokenEntry[tokenEntryKey]==='string'&&!!tokenEntry[tokenEntryKey].match(new RegExp(escapeStringRegex(searchQuery),'i'));}return typeof tokenEntry[tokenEntryKey]==='string'&&!!tokenEntry[tokenEntryKey].match(new RegExp(escapeStringRegex(searchQuery),'i'));});return regexMatches.some(function(m){return m;});});},[tokenList,searchQuery]);function _onTokenSelect(address){setSearchQuery('');onTokenSelect(address);onDismiss();}function renderTokenList(){if(isAddress(searchQuery)&&exchangeAddress===undefined){return React.createElement(TokenModalInfo,null,\"Searching for Exchange...\");}if(isAddress(searchQuery)&&exchangeAddress===ethers.constants.AddressZero){return React.createElement(React.Fragment,null,React.createElement(TokenModalInfo,null,t('noExchange')),React.createElement(TokenModalInfo,null,React.createElement(Link,{to:\"/create-exchange/\".concat(searchQuery)},t('createExchange'))));}if(!filteredTokenList.length){return React.createElement(TokenModalInfo,null,t('noExchange'));}return filteredTokenList.map(function(_ref46){var address=_ref46.address,symbol=_ref46.symbol,name=_ref46.name,balance=_ref46.balance,usdBalance=_ref46.usdBalance;var urlAdded=urlAddedTokens&&urlAddedTokens.hasOwnProperty(address);var customAdded=address!=='ETH'&&INITIAL_TOKENS_CONTEXT[chainId]&&!INITIAL_TOKENS_CONTEXT[chainId].hasOwnProperty(address)&&!urlAdded;return React.createElement(TokenModalRow,{key:address,onClick:function onClick(){return _onTokenSelect(address);}},React.createElement(TokenRowLeft,null,React.createElement(TokenLogo,{address:address,size:'2rem'}),React.createElement(TokenSymbolGroup,null,React.createElement(\"div\",null,React.createElement(\"span\",{id:\"symbol\"},symbol),React.createElement(FadedSpan,null,urlAdded&&'(Added by URL)',\" \",customAdded&&'(Added by user)')),React.createElement(TokenFullName,null,\" \",name))),React.createElement(TokenRowRight,null,balance?React.createElement(TokenRowBalance,null,balance&&(balance>0||balance==='<0.0001')?balance:'-'):account?React.createElement(SpinnerWrapper,{src:Circle,alt:\"loader\"}):'-',React.createElement(TokenRowUsd,null,usdBalance&&!usdBalance.isNaN()?usdBalance.isZero()?'':usdBalance.lt(0.01)?'<$0.01':'$'+formatToUsd(usdBalance):'')));});}// manage focus on modal show\nvar inputRef=useRef();function onInput(event){var input=event.target.value;var checksummedInput=isAddress(input);setSearchQuery(checksummedInput||input);}function clearInputAndDismiss(){setSearchQuery('');onDismiss();}return React.createElement(Modal,{isOpen:isOpen,onDismiss:clearInputAndDismiss,minHeight:60,maxHeight:50,initialFocusRef:isMobile?undefined:inputRef},React.createElement(TokenModal,null,React.createElement(ModalHeader,null,React.createElement(\"p\",null,\"Select Token\"),React.createElement(CloseIcon,{onClick:clearInputAndDismiss},React.createElement(CloseColor,{alt:'close icon'}))),React.createElement(SearchContainer,null,React.createElement(\"img\",{src:SearchIcon,alt:\"search\"}),React.createElement(StyledBorderlessInput,{ref:inputRef,type:\"text\",placeholder:isMobile?t('searchOrPasteMobile'):t('searchOrPaste'),onChange:onInput})),React.createElement(TokenList,null,renderTokenList())));}","map":{"version":3,"sources":["/workspace/uniswap-exchange/src/components/CurrencyInputPanel/index.js"],"names":["React","useState","useRef","useMemo","Link","useTranslation","ethers","BigNumber","styled","escapeStringRegex","darken","Tooltip","isMobile","BorderlessInput","useWeb3React","useTokenContract","isAddress","calculateGasMargin","formatToUsd","formatTokenBalance","formatEthBalance","Modal","TokenLogo","useTransactionAdder","usePendingApproval","useTokenDetails","useAllTokenDetails","INITIAL_TOKENS_CONTEXT","useAddressBalance","transparentize","Spinner","useETHPriceInUSD","useAllBalances","GAS_MARGIN","utils","bigNumberify","SubCurrencySelect","button","theme","flexRowNoWrap","zumthorBlue","royalBlue","InputRow","div","Input","error","salmonRed","inputBackground","StyledBorderlessInput","concreteGray","CurrencySelect","selected","textColor","mercuryGray","Aligner","span","StyledDropDown","DropDown","InputPanel","flexColumnNoWrap","shadowColor","Container","malibuBlue","LabelRow","doveGray","LabelContainer","ErrorSpan","TokenModal","ModalHeader","CloseColor","Close","CloseIcon","SearchContainer","TokenModalInfo","TokenList","TokenModalRow","doveGrey","tokenRowHover","mediaWidth","upToMedium","TokenRowLeft","TokenSymbolGroup","TokenFullName","chaliceGray","FadedSpan","TokenRowBalance","TokenRowUsd","TokenRowRight","StyledTokenName","SpinnerWrapper","CurrencyInputPanel","onValueChange","allBalances","renderInput","onCurrencySelected","title","description","extraText","extraTextClickHander","errorMessage","disableUnlock","disableTokenSelect","selectedTokenAddress","showUnlock","value","urlAddedTokens","t","modalIsOpen","setModalIsOpen","tokenContract","selectedTokenExchangeAddress","exchangeAddress","pendingApproval","addTransaction","allTokens","account","userTokenBalance","renderUnlockButton","useUserBalance","estimate","approve","constants","MaxUint256","catch","e","console","log","estimatedGas","gasLimit","then","response","approval","_renderInput","target","charCode","which","keyCode","preventDefault","stopPropagation","symbol","background","color","border","borderRadius","padding","marginTop","CurrencySelectModal","isOpen","onDismiss","onTokenSelect","searchQuery","setSearchQuery","chainId","ethPrice","_usdAmounts","Object","keys","map","k","ethRate","exchangeDetails","tokenBalance","toString","ethBalance","USDRate","times","pow","decimals","balanceBigNumber","usdBalance","usdAmounts","reduce","accumulator","currentValue","i","assign","tokenList","sort","a","b","aSymbol","toLowerCase","bSymbol","aUSD","bUSD","gt","lt","balance","name","address","filteredTokenList","filter","tokenEntry","inputIsAddress","slice","regexMatches","tokenEntryKey","match","RegExp","some","m","_onTokenSelect","renderTokenList","undefined","AddressZero","length","urlAdded","hasOwnProperty","customAdded","Circle","isNaN","isZero","inputRef","onInput","event","input","checksummedInput","clearInputAndDismiss","SearchIcon"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useMemo } from 'react'\nimport { Link } from 'react-router-dom'\nimport { useTranslation } from 'react-i18next'\nimport { ethers } from 'ethers'\nimport { BigNumber } from '@uniswap/sdk'\nimport styled from 'styled-components'\nimport escapeStringRegex from 'escape-string-regexp'\nimport { darken } from 'polished'\nimport Tooltip from '@reach/tooltip'\nimport '@reach/tooltip/styles.css'\nimport { isMobile } from 'react-device-detect'\nimport { BorderlessInput } from '../../theme'\nimport { useWeb3React, useTokenContract } from '../../hooks'\nimport { isAddress, calculateGasMargin, formatToUsd, formatTokenBalance, formatEthBalance } from '../../utils'\nimport { ReactComponent as DropDown } from '../../assets/images/dropdown.svg'\nimport Modal from '../Modal'\nimport TokenLogo from '../TokenLogo'\nimport SearchIcon from '../../assets/images/magnifying-glass.svg'\nimport { useTransactionAdder, usePendingApproval } from '../../contexts/Transactions'\nimport { useTokenDetails, useAllTokenDetails, INITIAL_TOKENS_CONTEXT } from '../../contexts/Tokens'\nimport { useAddressBalance } from '../../contexts/Balances'\nimport { ReactComponent as Close } from '../../assets/images/x.svg'\nimport { transparentize } from 'polished'\nimport { Spinner } from '../../theme'\nimport Circle from '../../assets/images/circle-grey.svg'\nimport { useETHPriceInUSD, useAllBalances } from '../../contexts/Balances'\n\nconst GAS_MARGIN = ethers.utils.bigNumberify(1000)\n\nconst SubCurrencySelect = styled.button`\n  ${({ theme }) => theme.flexRowNoWrap}\n  padding: 4px 50px 4px 15px;\n  margin-right: -40px;\n  line-height: 0;\n  height: 2rem;\n  align-items: center;\n  border-radius: 2.5rem;\n  outline: none;\n  cursor: pointer;\n  user-select: none;\n  background: ${({ theme }) => theme.zumthorBlue};\n  border: 1px solid ${({ theme }) => theme.royalBlue};\n  color: ${({ theme }) => theme.royalBlue};\n`\n\nconst InputRow = styled.div`\n  ${({ theme }) => theme.flexRowNoWrap}\n  align-items: center;\n  padding: 0.25rem 0.85rem 0.75rem;\n`\n\nconst Input = styled(BorderlessInput)`\n  font-size: 1.5rem;\n  color: ${({ error, theme }) => error && theme.salmonRed};\n  background-color: ${({ theme }) => theme.inputBackground};\n  -moz-appearance: textfield;\n`\n\nconst StyledBorderlessInput = styled(BorderlessInput)`\n  min-height: 2.5rem;\n  flex-shrink: 0;\n  text-align: left;\n  padding-left: 1.6rem;\n  background-color: ${({ theme }) => theme.concreteGray};\n`\n\nconst CurrencySelect = styled.button`\n  align-items: center;\n  font-size: 1rem;\n  color: ${({ selected, theme }) => (selected ? theme.textColor : theme.royalBlue)};\n  height: 2rem;\n  border: 1px solid ${({ selected, theme }) => (selected ? theme.mercuryGray : theme.royalBlue)};\n  border-radius: 2.5rem;\n  background-color: ${({ selected, theme }) => (selected ? theme.concreteGray : theme.zumthorBlue)};\n  outline: none;\n  cursor: pointer;\n  user-select: none;\n  :hover {\n    border: 1px solid\n      ${({ selected, theme }) => (selected ? darken(0.1, theme.mercuryGray) : darken(0.1, theme.royalBlue))};\n  }\n  :focus {\n    border: 1px solid ${({ theme }) => darken(0.1, theme.royalBlue)};\n  }\n  :active {\n    background-color: ${({ theme }) => theme.zumthorBlue};\n  }\n`\n\nconst Aligner = styled.span`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`\n\nconst StyledDropDown = styled(DropDown)`\n  margin: 0 0.5rem 0 0.5rem;\n  height: 35%;\n  path {\n    stroke: ${({ selected, theme }) => (selected ? theme.textColor : theme.royalBlue)};\n  }\n`\n\nconst InputPanel = styled.div`\n  ${({ theme }) => theme.flexColumnNoWrap}\n  box-shadow: 0 4px 8px 0 ${({ theme }) => transparentize(0.95, theme.shadowColor)};\n  position: relative;\n  border-radius: 1.25rem;\n  background-color: ${({ theme }) => theme.inputBackground};\n  z-index: 1;\n`\n\nconst Container = styled.div`\n  border-radius: 1.25rem;\n  border: 1px solid ${({ error, theme }) => (error ? theme.salmonRed : theme.mercuryGray)};\n  background-color: ${({ theme }) => theme.inputBackground};\n  :focus-within {\n    border: 1px solid ${({ theme }) => theme.malibuBlue};\n  }\n`\n\nconst LabelRow = styled.div`\n  ${({ theme }) => theme.flexRowNoWrap}\n  align-items: center;\n  color: ${({ theme }) => theme.doveGray};\n  font-size: 0.75rem;\n  line-height: 1rem;\n  padding: 0.75rem 1rem;\n  span:hover {\n    cursor: pointer;\n    color: ${({ theme }) => darken(0.2, theme.doveGray)};\n  }\n`\n\nconst LabelContainer = styled.div`\n  flex: 1 1 auto;\n  width: 0;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n`\n\nconst ErrorSpan = styled.span`\n  color: ${({ error, theme }) => error && theme.salmonRed};\n  :hover {\n    cursor: pointer;\n    color: ${({ error, theme }) => error && darken(0.1, theme.salmonRed)};\n  }\n`\n\nconst TokenModal = styled.div`\n  ${({ theme }) => theme.flexColumnNoWrap}\n  width: 100%;\n`\n\nconst ModalHeader = styled.div`\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px 0px 0px 1rem;\n  height: 60px;\n`\n\nconst CloseColor = styled(Close)`\n  path {\n    stroke: ${({ theme }) => theme.textColor};\n  }\n`\n\nconst CloseIcon = styled.div`\n  position: absolute;\n  right: 1rem;\n  top: 14px;\n  &:hover {\n    cursor: pointer;\n    opacity: 0.6;\n  }\n`\n\nconst SearchContainer = styled.div`\n  ${({ theme }) => theme.flexRowNoWrap}\n  justify-content: flex-start;\n  padding: 0.5rem 1.5rem;\n  background-color: ${({ theme }) => theme.concreteGray};\n`\n\nconst TokenModalInfo = styled.div`\n  ${({ theme }) => theme.flexRowNoWrap}\n  align-items: center;\n  padding: 1rem 1.5rem;\n  margin: 0.25rem 0.5rem;\n  justify-content: center;\n  user-select: none;\n`\n\nconst TokenList = styled.div`\n  flex-grow: 1;\n  height: 100%;\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n`\n\nconst TokenModalRow = styled.div`\n  ${({ theme }) => theme.flexRowNoWrap}\n  align-items: center;\n  justify-content: space-between;\n  padding: 1rem;\n  cursor: pointer;\n  user-select: none;\n  #symbol {\n    color: ${({ theme }) => theme.doveGrey};\n  }\n  :hover {\n    background-color: ${({ theme }) => theme.tokenRowHover};\n  }\n  ${({ theme }) => theme.mediaWidth.upToMedium`\n    padding: 0.8rem 1rem;\n    padding-right: 2rem;\n  `}\n`\n\nconst TokenRowLeft = styled.div`\n  ${({ theme }) => theme.flexRowNoWrap}\n  align-items : center;\n`\n\nconst TokenSymbolGroup = styled.div`\n  ${({ theme }) => theme.flexColumnNoWrap};\n  margin-left: 1rem;\n`\n\nconst TokenFullName = styled.div`\n  color: ${({ theme }) => theme.chaliceGray};\n`\n\nconst FadedSpan = styled.span`\n  color: ${({ theme }) => theme.royalBlue};\n`\n\nconst TokenRowBalance = styled.div`\n  font-size: 1rem;\n  line-height: 20px;\n`\n\nconst TokenRowUsd = styled.div`\n  font-size: 1rem;\n  line-height: 1.5rem;\n  color: ${({ theme }) => theme.chaliceGray};\n`\n\nconst TokenRowRight = styled.div`\n  ${({ theme }) => theme.flexColumnNoWrap};\n  align-items: flex-end;\n`\n\nconst StyledTokenName = styled.span`\n  margin: 0 0.25rem 0 0.25rem;\n`\n\nconst SpinnerWrapper = styled(Spinner)`\n  margin: 0 0.25rem 0 0.25rem;\n  color: ${({ theme }) => theme.chaliceGray};\n  opacity: 0.6;\n`\n\nexport default function CurrencyInputPanel({\n  onValueChange = () => {},\n  allBalances,\n  renderInput,\n  onCurrencySelected = () => {},\n  title,\n  description,\n  extraText,\n  extraTextClickHander = () => {},\n  errorMessage,\n  disableUnlock,\n  disableTokenSelect,\n  selectedTokenAddress = '',\n  showUnlock,\n  value,\n  urlAddedTokens\n}) {\n  const { t } = useTranslation()\n\n  const [modalIsOpen, setModalIsOpen] = useState(false)\n\n  const tokenContract = useTokenContract(selectedTokenAddress)\n  const { exchangeAddress: selectedTokenExchangeAddress } = useTokenDetails(selectedTokenAddress)\n\n  const pendingApproval = usePendingApproval(selectedTokenAddress)\n\n  const addTransaction = useTransactionAdder()\n\n  const allTokens = useAllTokenDetails()\n\n  const { account } = useWeb3React()\n\n  const userTokenBalance = useAddressBalance(account, selectedTokenAddress)\n\n  function renderUnlockButton() {\n    if (disableUnlock || !showUnlock || selectedTokenAddress === 'ETH' || !selectedTokenAddress) {\n      return null\n    } else {\n      if (!pendingApproval) {\n        return (\n          <SubCurrencySelect\n            onClick={async () => {\n              let estimatedGas\n              let useUserBalance = false\n              estimatedGas = await tokenContract.estimate\n                .approve(selectedTokenExchangeAddress, ethers.constants.MaxUint256)\n                .catch(e => {\n                  console.log('Error setting max token approval.')\n                })\n              if (!estimatedGas) {\n                // general fallback for tokens who restrict approval amounts\n                estimatedGas = await tokenContract.estimate.approve(selectedTokenExchangeAddress, userTokenBalance)\n                useUserBalance = true\n              }\n              tokenContract\n                .approve(\n                  selectedTokenExchangeAddress,\n                  useUserBalance ? userTokenBalance : ethers.constants.MaxUint256,\n                  {\n                    gasLimit: calculateGasMargin(estimatedGas, GAS_MARGIN)\n                  }\n                )\n                .then(response => {\n                  addTransaction(response, { approval: selectedTokenAddress })\n                })\n            }}\n          >\n            {t('unlock')}\n          </SubCurrencySelect>\n        )\n      } else {\n        return <SubCurrencySelect>{t('pending')}</SubCurrencySelect>\n      }\n    }\n  }\n\n  function _renderInput() {\n    if (typeof renderInput === 'function') {\n      return renderInput()\n    }\n\n    return (\n      <InputRow>\n        <Input\n          type=\"number\"\n          min=\"0\"\n          step=\"0.000000000000000001\"\n          error={!!errorMessage}\n          placeholder=\"0.0\"\n          onChange={e => onValueChange(e.target.value)}\n          onKeyPress={e => {\n            const charCode = e.which ? e.which : e.keyCode\n\n            // Prevent 'minus' character\n            if (charCode === 45) {\n              e.preventDefault()\n              e.stopPropagation()\n            }\n          }}\n          value={value}\n        />\n        {renderUnlockButton()}\n        <CurrencySelect\n          selected={!!selectedTokenAddress}\n          onClick={() => {\n            if (!disableTokenSelect) {\n              setModalIsOpen(true)\n            }\n          }}\n        >\n          <Aligner>\n            {selectedTokenAddress ? <TokenLogo address={selectedTokenAddress} /> : null}\n            {\n              <StyledTokenName>\n                {(allTokens[selectedTokenAddress] && allTokens[selectedTokenAddress].symbol) || t('selectToken')}\n              </StyledTokenName>\n            }\n            {!disableTokenSelect && <StyledDropDown selected={!!selectedTokenAddress} />}\n          </Aligner>\n        </CurrencySelect>\n      </InputRow>\n    )\n  }\n\n  return (\n    <InputPanel>\n      <Container error={!!errorMessage}>\n        <LabelRow>\n          <LabelContainer>\n            <span>{title}</span> <span>{description}</span>\n          </LabelContainer>\n\n          <ErrorSpan\n            data-tip={'Enter max'}\n            error={!!errorMessage}\n            onClick={() => {\n              extraTextClickHander()\n            }}\n          >\n            <Tooltip\n              label=\"Enter Max\"\n              style={{\n                background: 'hsla(48, 100%, 50%)',\n                color: 'white',\n                border: 'none',\n                borderRadius: '24px',\n                padding: '0.5em 1em',\n                marginTop: '-64px'\n              }}\n            >\n              <span>{extraText}</span>\n            </Tooltip>\n          </ErrorSpan>\n        </LabelRow>\n        {_renderInput()}\n      </Container>\n      {!disableTokenSelect && (\n        <CurrencySelectModal\n          isOpen={modalIsOpen}\n          onDismiss={() => {\n            setModalIsOpen(false)\n          }}\n          urlAddedTokens={urlAddedTokens}\n          onTokenSelect={onCurrencySelected}\n          allBalances={allBalances}\n        />\n      )}\n    </InputPanel>\n  )\n}\n\nfunction CurrencySelectModal({ isOpen, onDismiss, onTokenSelect, urlAddedTokens }) {\n  const { t } = useTranslation()\n\n  const [searchQuery, setSearchQuery] = useState('')\n  const { exchangeAddress } = useTokenDetails(searchQuery)\n\n  const allTokens = useAllTokenDetails()\n\n  const { account, chainId } = useWeb3React()\n\n  // BigNumber.js instance\n  const ethPrice = useETHPriceInUSD()\n\n  // all balances for both account and exchanges\n  let allBalances = useAllBalances()\n\n  const _usdAmounts = Object.keys(allTokens).map(k => {\n    if (ethPrice && allBalances[account] && allBalances[account][k] && allBalances[account][k].value) {\n      let ethRate = 1 // default for ETH\n      let exchangeDetails = allBalances[allTokens[k].exchangeAddress]\n      if (\n        exchangeDetails &&\n        exchangeDetails[k] &&\n        exchangeDetails[k].value &&\n        exchangeDetails['ETH'] &&\n        exchangeDetails['ETH'].value\n      ) {\n        const tokenBalance = new BigNumber(exchangeDetails[k].value.toString())\n        const ethBalance = new BigNumber(exchangeDetails['ETH'].value.toString())\n        ethRate = ethBalance.div(tokenBalance)\n      }\n      const USDRate = ethPrice\n        .times(ethRate)\n        .times(new BigNumber(10).pow(allTokens[k].decimals).div(new BigNumber(10).pow(18)))\n      const balanceBigNumber = new BigNumber(allBalances[account][k].value.toString())\n      const usdBalance = balanceBigNumber.times(USDRate).div(new BigNumber(10).pow(allTokens[k].decimals))\n      return usdBalance\n    } else {\n      return null\n    }\n  })\n  const usdAmounts =\n    _usdAmounts &&\n    Object.keys(allTokens).reduce(\n      (accumulator, currentValue, i) => Object.assign({ [currentValue]: _usdAmounts[i] }, accumulator),\n      {}\n    )\n\n  const tokenList = useMemo(() => {\n    return Object.keys(allTokens)\n      .sort((a, b) => {\n        if (allTokens[a].symbol && allTokens[b].symbol) {\n          const aSymbol = allTokens[a].symbol.toLowerCase()\n          const bSymbol = allTokens[b].symbol.toLowerCase()\n\n          // pin ETH to top\n          if (aSymbol === 'ETH'.toLowerCase() || bSymbol === 'ETH'.toLowerCase()) {\n            return aSymbol === bSymbol ? 0 : aSymbol === 'ETH'.toLowerCase() ? -1 : 1\n          }\n\n          // then tokens with balance\n          if (usdAmounts[a] && !usdAmounts[b]) {\n            return -1\n          } else if (usdAmounts[b] && !usdAmounts[a]) {\n            return 1\n          }\n\n          // sort by balance\n          if (usdAmounts[a] && usdAmounts[b]) {\n            const aUSD = usdAmounts[a]\n            const bUSD = usdAmounts[b]\n\n            return aUSD.gt(bUSD) ? -1 : aUSD.lt(bUSD) ? 1 : 0\n          }\n\n          // sort alphabetically\n          return aSymbol < bSymbol ? -1 : aSymbol > bSymbol ? 1 : 0\n        } else {\n          return 0\n        }\n      })\n      .map(k => {\n        let balance\n        let usdBalance\n        // only update if we have data\n        if (k === 'ETH' && allBalances[account] && allBalances[account][k] && allBalances[account][k].value) {\n          balance = formatEthBalance(allBalances[account][k].value)\n          usdBalance = usdAmounts[k]\n        } else if (allBalances[account] && allBalances[account][k] && allBalances[account][k].value) {\n          balance = formatTokenBalance(allBalances[account][k].value, allTokens[k].decimals)\n          usdBalance = usdAmounts[k]\n        }\n        return {\n          name: allTokens[k].name,\n          symbol: allTokens[k].symbol,\n          address: k,\n          balance: balance,\n          usdBalance: usdBalance\n        }\n      })\n  }, [allBalances, allTokens, usdAmounts, account])\n\n  const filteredTokenList = useMemo(() => {\n    return tokenList.filter(tokenEntry => {\n      const inputIsAddress = searchQuery.slice(0, 2) === '0x'\n\n      // check the regex for each field\n      const regexMatches = Object.keys(tokenEntry).map(tokenEntryKey => {\n        // if address field only search if input starts with 0x\n        if (tokenEntryKey === 'address') {\n          return (\n            inputIsAddress &&\n            typeof tokenEntry[tokenEntryKey] === 'string' &&\n            !!tokenEntry[tokenEntryKey].match(new RegExp(escapeStringRegex(searchQuery), 'i'))\n          )\n        }\n        return (\n          typeof tokenEntry[tokenEntryKey] === 'string' &&\n          !!tokenEntry[tokenEntryKey].match(new RegExp(escapeStringRegex(searchQuery), 'i'))\n        )\n      })\n      return regexMatches.some(m => m)\n    })\n  }, [tokenList, searchQuery])\n\n  function _onTokenSelect(address) {\n    setSearchQuery('')\n    onTokenSelect(address)\n    onDismiss()\n  }\n\n  function renderTokenList() {\n    if (isAddress(searchQuery) && exchangeAddress === undefined) {\n      return <TokenModalInfo>Searching for Exchange...</TokenModalInfo>\n    }\n    if (isAddress(searchQuery) && exchangeAddress === ethers.constants.AddressZero) {\n      return (\n        <>\n          <TokenModalInfo>{t('noExchange')}</TokenModalInfo>\n          <TokenModalInfo>\n            <Link to={`/create-exchange/${searchQuery}`}>{t('createExchange')}</Link>\n          </TokenModalInfo>\n        </>\n      )\n    }\n    if (!filteredTokenList.length) {\n      return <TokenModalInfo>{t('noExchange')}</TokenModalInfo>\n    }\n\n    return filteredTokenList.map(({ address, symbol, name, balance, usdBalance }) => {\n      const urlAdded = urlAddedTokens && urlAddedTokens.hasOwnProperty(address)\n      const customAdded =\n        address !== 'ETH' &&\n        INITIAL_TOKENS_CONTEXT[chainId] &&\n        !INITIAL_TOKENS_CONTEXT[chainId].hasOwnProperty(address) &&\n        !urlAdded\n\n      return (\n        <TokenModalRow key={address} onClick={() => _onTokenSelect(address)}>\n          <TokenRowLeft>\n            <TokenLogo address={address} size={'2rem'} />\n            <TokenSymbolGroup>\n              <div>\n                <span id=\"symbol\">{symbol}</span>\n                <FadedSpan>\n                  {urlAdded && '(Added by URL)'} {customAdded && '(Added by user)'}\n                </FadedSpan>\n              </div>\n              <TokenFullName> {name}</TokenFullName>\n            </TokenSymbolGroup>\n          </TokenRowLeft>\n          <TokenRowRight>\n            {balance ? (\n              <TokenRowBalance>{balance && (balance > 0 || balance === '<0.0001') ? balance : '-'}</TokenRowBalance>\n            ) : account ? (\n              <SpinnerWrapper src={Circle} alt=\"loader\" />\n            ) : (\n              '-'\n            )}\n            <TokenRowUsd>\n              {usdBalance && !usdBalance.isNaN()\n                ? usdBalance.isZero()\n                  ? ''\n                  : usdBalance.lt(0.01)\n                  ? '<$0.01'\n                  : '$' + formatToUsd(usdBalance)\n                : ''}\n            </TokenRowUsd>\n          </TokenRowRight>\n        </TokenModalRow>\n      )\n    })\n  }\n\n  // manage focus on modal show\n  const inputRef = useRef()\n\n  function onInput(event) {\n    const input = event.target.value\n    const checksummedInput = isAddress(input)\n    setSearchQuery(checksummedInput || input)\n  }\n\n  function clearInputAndDismiss() {\n    setSearchQuery('')\n    onDismiss()\n  }\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onDismiss={clearInputAndDismiss}\n      minHeight={60}\n      maxHeight={50}\n      initialFocusRef={isMobile ? undefined : inputRef}\n    >\n      <TokenModal>\n        <ModalHeader>\n          <p>Select Token</p>\n          <CloseIcon onClick={clearInputAndDismiss}>\n            <CloseColor alt={'close icon'} />\n          </CloseIcon>\n        </ModalHeader>\n        <SearchContainer>\n          <img src={SearchIcon} alt=\"search\" />\n          <StyledBorderlessInput\n            ref={inputRef}\n            type=\"text\"\n            placeholder={isMobile ? t('searchOrPasteMobile') : t('searchOrPaste')}\n            onChange={onInput}\n          />\n        </SearchContainer>\n        <TokenList>{renderTokenList()}</TokenList>\n      </TokenModal>\n    </Modal>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}